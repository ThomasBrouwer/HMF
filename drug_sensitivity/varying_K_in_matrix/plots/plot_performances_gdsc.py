'''
Plot the performances of HMF D-MF and D-MTF, with varying values for Kt, on
the GDSC dataset.
'''

import matplotlib.pyplot as plt

MSE_max, MSE_min = 0.1, 0.075
fraction_min, fraction_max = 0.25, 0.95

values_K = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 25, 30]

perf_hmf_mf_gdsc = {'R^2': [0.5378895897404576, 0.5588179784583696, 0.5775754357991849, 0.5873917418246475, 0.5967456327721383, 0.6095091882778506, 0.6074754829120068, 0.6050982525383638, 0.6098315847434679, 0.611131820078387, 0.6082729251853476, 0.6140249635786372, 0.6069252831431039, 0.6083592162220847, 0.6019826370374308, 0.5917142836519045, 0.5739435402252778], 'MSE': [0.092136703486547483, 0.087905642199881034, 0.084164693137332741, 0.082259050400168274, 0.080401058765981775, 0.077825310883253979, 0.078174668859023189, 0.078696435988965113, 0.077705288040566881, 0.077498733288756283, 0.07804560567351479, 0.076928521167593494, 0.078374012701426674, 0.0780458543346009, 0.079341708581703488, 0.081416782601892793, 0.084949076252284456], 'Rp': [0.73356781208514232, 0.74800716339225581, 0.76044620352630921, 0.76679009228605166, 0.77298798892714338, 0.78126235797111454, 0.78032086351937813, 0.77899753778874326, 0.78209406846316987, 0.78295799672380328, 0.78134473535901727, 0.78535239371595467, 0.78142139740958672, 0.78250240626119072, 0.779086954732916, 0.77393268283739303, 0.76480257894949644]}
perf_hmf_mtf_gdsc = {'R^2': [], 'MSE': [], 'Rp': []}


''' Plot '''
fig = plt.figure(figsize=(3.8,3.0))
fig.subplots_adjust(left=0.16, right=0.965, bottom=0.12, top=0.97)
plt.xlabel("Kt", fontsize=12, labelpad=1) #fontsize=8
plt.ylabel("MSE", fontsize=12, labelpad=3) #fontsize=8, labelpad=-1
plt.yticks(fontsize=8) #fontsize=6
plt.xticks(fontsize=8) #fontsize=6

plt.plot(values_K, perf_hmf_mf_gdsc['MSE'], linestyle='-', linewidth=1.2, marker='o', label='HMF D-MF', c='red', markersize=5)
#plt.plot(x=values_K, y=perf_hmf_mtf_gdsc, linestyle='-', linewidth=1.2, marker='o', label='HMF D-MTF', c='blue', markersize=5)
 
plt.xlim(0,values_K[-1]+1)
plt.ylim(MSE_min,MSE_max)
plt.legend(loc='upper left',fontsize=10)
    
plt.savefig("./varying_K_gdsc.png", dpi=600)