'''
Plot the performances of HMF D-MF and D-MTF, with varying values for Kt, on
the GDSC dataset.
'''

import matplotlib.pyplot as plt

MSE_max, MSE_min = 0.14, 0.08
fraction_min, fraction_max = 0.25, 0.95

values_K = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 25, 30]

perf_hmf_mf_ctrp_ARD = {'R^2': [0.39601265774478034, 0.3994055427150653, 0.41697298985793835, 0.4199332641133404, 0.4239125135383608, 0.43345064722477183, 0.43064198375497487, 0.42885498067133854, 0.4209372112517296, 0.42530373766106067, 0.41837792304243965, 0.40854229150490384, 0.40295856898275983, 0.40917061887450784, 0.39386098442445266, 0.3948215300394192, 0.3748921724032922], 'MSE': [0.096003862679150481, 0.095432948334725182, 0.092692831976889628, 0.092210195716046509, 0.091545077328923988, 0.090122527387984, 0.090565933834273485, 0.090824809084094599, 0.091922310874882493, 0.091358687126241706, 0.092413073259747916, 0.094040671687050173, 0.094853731005173275, 0.093920726863974333, 0.096309353785351298, 0.09622223088188489, 0.099335159256396355], 'Rp': [0.62973458340270771, 0.63221332140062014, 0.64634352844001275, 0.64881982892103818, 0.65196915239762465, 0.65889801585245733, 0.65732073920634593, 0.6568800547670961, 0.65164347852607407, 0.65456382799755986, 0.65069182017929816, 0.64505029140092218, 0.64262544342424077, 0.64705869778389791, 0.63863724277750444, 0.6398273837756413, 0.62573156714127065]}
perf_hmf_mf_ctrp_no_ARD = {'R^2': [0.39519524220683777, 0.39975935588854966, 0.41954901926677024, 0.4200360248336009, 0.42346973228792206, 0.42852469091146067, 0.42717250397375894, 0.4225504777654788, 0.42185958975385274, 0.4188647972091217, 0.4013077609463429, 0.3872096404685029, 0.37896465756221676, 0.3662610477161173, 0.34659705036824856, 0.3123029983444898, -0.3272151956947882], 'MSE': [0.09607861854985103, 0.0954607528570839, 0.092285654019985744, 0.09218295454305922, 0.091557980558380103, 0.090871365673018734, 0.091070137395245526, 0.091773144342158317, 0.091920670506241184, 0.092321846395180138, 0.09514635612283473, 0.097350534198393596, 0.098694094036081273, 0.10075839859420281, 0.10388108085119696, 0.10934726251021235, 0.20935767639111971], 'Rp': [0.62925599931186016, 0.63254740988796576, 0.64881317182175435, 0.6489573334669132, 0.65258519734135689, 0.65615117936071066, 0.65569105604982192, 0.65362462300786961, 0.65360948373394367, 0.65256488241685962, 0.64217316385020506, 0.63484626259660693, 0.63315719166367157, 0.6263268267271811, 0.61676067416257796, 0.60355093674515425, 0.48936096160857384]}

perf_hmf_mtf_ctrp_ARD = {'R^2': [0.3114859267983666, 0.3996953050043409, 0.41421115646920786, 0.4210598859457206, 0.42466197565851516, 0.4257553930600973, 0.4314929401225439, 0.43233038499026766, 0.4396501443499569, 0.43687247130072493, 0.4259789764685179, 0.4319039970198606, 0.4154414540287063, 0.40434344892359275, 0.40006041213895305, 0.37444980124988164, 0.3612508071486233], 'MSE': [0.10945597652504177, 0.095392146845027337, 0.093093061239668845, 0.092055421894656111, 0.091459107314937116, 0.091241628111785211, 0.090339478793706393, 0.090252066324524954, 0.089099913007402123, 0.089561589635702141, 0.091268907779504388, 0.090289168857795601, 0.092943876108323512, 0.094658672695154739, 0.095376042382170095, 0.09943687402463354, 0.10154029147326064], 'Rp': [0.5584430276023955, 0.63253696195457998, 0.64436187091805108, 0.64932835755369234, 0.65241418160972109, 0.65325890023775246, 0.6581403457688888, 0.65831424165300523, 0.66399831011984722, 0.66197464052423616, 0.65504600109450717, 0.6604818034585962, 0.64962044273299757, 0.64422909747388779, 0.64170833633469948, 0.62921389264167549, 0.62373844398837408]}
perf_hmf_mtf_ctrp_no_ARD = {'R^2': [0.3110618798108806, 0.3988439003093299, 0.4136861051167612, 0.4135156673635027, 0.4217855415326481, 0.42310536538001353, 0.42591893083966426, 0.4227012761803909, 0.4186881962791363, 0.4140807750917661, 0.4159988246087997, 0.40229888452364443, 0.3946053894965488, 0.37008092487402183, 0.35195130089799964, 0.28571352875139333, 0.23319814636216182], 'MSE': [0.10948175534122757, 0.095531884754890162, 0.09314601732413294, 0.093255979053441365, 0.09194713848420713, 0.091724835147022066, 0.091242598430674809, 0.091814172059005814, 0.092362436763050768, 0.093189529609858199, 0.0928069539482866, 0.095026569405836175, 0.096256020756904939, 0.10016597577624213, 0.10300286077055469, 0.11356702749724021, 0.12196301892382377], 'Rp': [0.55829227471886234, 0.63224408610563754, 0.64402999233148572, 0.64340013723489464, 0.64970353796495406, 0.65113700287025522, 0.65314075481630884, 0.6508821021607073, 0.64869881692449938, 0.64524559808156379, 0.64823018488791417, 0.64006146967609612, 0.63736253021099798, 0.62394984464560355, 0.61526217721265353, 0.58572432883200576, 0.56868048632834411]}

''' Plot '''
fig = plt.figure(figsize=(3.8,3.0))
fig.subplots_adjust(left=0.16, right=0.965, bottom=0.12, top=0.97)
plt.xlabel("Kt", fontsize=12, labelpad=1) #fontsize=8
plt.ylabel("MSE", fontsize=12, labelpad=3) #fontsize=8, labelpad=-1
plt.yticks(fontsize=8) #fontsize=6
plt.xticks(fontsize=8) #fontsize=6

plt.plot(values_K, perf_hmf_mf_ctrp_ARD['MSE'], linestyle='-', linewidth=1.2, marker='o', label='HMF D-MF (ARD)', c='red', markersize=5)
plt.plot(values_K, perf_hmf_mf_ctrp_no_ARD['MSE'], linestyle='-', linewidth=1.2, marker='x', label='HMF D-MF (no ARD)', c='red', markersize=5)

plt.plot(values_K, perf_hmf_mtf_ctrp_ARD['MSE'], linestyle='-', linewidth=1.2, marker='o', label='HMF D-MTF (ARD)', c='blue', markersize=5)
plt.plot(values_K, perf_hmf_mtf_ctrp_no_ARD['MSE'], linestyle='-', linewidth=1.2, marker='x', label='HMF D-MTF (no ARD)', c='blue', markersize=5)

plt.xlim(0,values_K[-1]+1)
plt.ylim(MSE_min,MSE_max)
plt.legend(loc='upper left',fontsize=10)
    
plt.savefig("./varying_K_ctrp.png", dpi=600)