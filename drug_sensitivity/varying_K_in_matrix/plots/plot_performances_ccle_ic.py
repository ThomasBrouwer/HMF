'''
Plot the performances of HMF D-MF and D-MTF, with varying values for Kt, on
the GDSC dataset.
'''

import matplotlib.pyplot as plt

MSE_max, MSE_min = 0.08, 0.05
fraction_min, fraction_max = 0.25, 0.95

values_K = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 25, 30]

perf_hmf_mf_ccle_ic = {'R^2': [0.5910596762538354, 0.6482092261928717, 0.6729746497487253, 0.6761953926023595, 0.6832032684832328, 0.6797353490775165, 0.6798475794132288, 0.6623523526231179, 0.6527230394118199, 0.6488381698621195, 0.6440831642109967, 0.6100031324247766, 0.5574270228611433, 0.5886920770687489, 0.6037723654050842, 0.6279946479936348, 0.6279748769302551], 'MSE': [0.071261501142979827, 0.061077392861343283, 0.056929517308278534, 0.056119362021935702, 0.054832336980159158, 0.055909493281085743, 0.055702177903720208, 0.058655869517737894, 0.060413140287238355, 0.061015754332745288, 0.061858816134391939, 0.06779348296259595, 0.076790538003711495, 0.071796673658623786, 0.069052059817427416, 0.064318323895999313, 0.064662831090247702], 'Rp': [0.7698555515717691, 0.80592579119239338, 0.8210572104359839, 0.82415295333459471, 0.82881818546864527, 0.8263769017542032, 0.82667305694262416, 0.81766472743052376, 0.81379788416810983, 0.81091223240186427, 0.80944510683418436, 0.79158747664306595, 0.76647234618440652, 0.77930330730194497, 0.78626311698549078, 0.79919817579399299, 0.79846974037669427]}
perf_hmf_mtf_ccle_ic = {'R^2': [], 'MSE': [], 'Rp': []}


''' Plot '''
fig = plt.figure(figsize=(3.8,3.0))
fig.subplots_adjust(left=0.15, right=0.965, bottom=0.12, top=0.97)
plt.xlabel("Kt", fontsize=12, labelpad=1) #fontsize=8
plt.ylabel("MSE", fontsize=12, labelpad=2) #fontsize=8, labelpad=-1
plt.yticks(fontsize=8) #fontsize=6
plt.xticks(fontsize=8) #fontsize=6

plt.plot(values_K, perf_hmf_mf_ccle_ic['MSE'], linestyle='-', linewidth=1.2, marker='o', label='HMF D-MF', c='red', markersize=5)
#plt.plot(x=values_K, y=perf_hmf_mtf_ccle_ic, linestyle='-', linewidth=1.2, marker='o', label='HMF D-MTF', c='blue', markersize=5)
 
plt.xlim(0,values_K[-1])
plt.ylim(MSE_min,MSE_max)

plt.legend(loc='upper left',fontsize=10)
    
plt.savefig("./varying_K_ccle_ic.png", dpi=600)