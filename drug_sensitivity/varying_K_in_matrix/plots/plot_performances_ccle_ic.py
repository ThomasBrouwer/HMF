'''
Plot the performances of HMF D-MF and D-MTF, with varying values for Kt, on
the GDSC dataset.
'''

import matplotlib.pyplot as plt

MSE_max, MSE_min = 0.09, 0.045
fraction_min, fraction_max = 0.25, 0.95

values_K = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 25, 30]

perf_hmf_mf_ccle_ic = {'R^2': [0.5910596762538354, 0.6482092261928717, 0.6729746497487253, 0.6761953926023595, 0.6832032684832328, 0.6797353490775165, 0.6798475794132288, 0.6623523526231179, 0.6527230394118199, 0.6488381698621195, 0.6440831642109967, 0.6100031324247766, 0.5574270228611433, 0.5886920770687489, 0.6037723654050842, 0.6279946479936348, 0.6279748769302551], 'MSE': [0.071261501142979827, 0.061077392861343283, 0.056929517308278534, 0.056119362021935702, 0.054832336980159158, 0.055909493281085743, 0.055702177903720208, 0.058655869517737894, 0.060413140287238355, 0.061015754332745288, 0.061858816134391939, 0.06779348296259595, 0.076790538003711495, 0.071796673658623786, 0.069052059817427416, 0.064318323895999313, 0.064662831090247702], 'Rp': [0.7698555515717691, 0.80592579119239338, 0.8210572104359839, 0.82415295333459471, 0.82881818546864527, 0.8263769017542032, 0.82667305694262416, 0.81766472743052376, 0.81379788416810983, 0.81091223240186427, 0.80944510683418436, 0.79158747664306595, 0.76647234618440652, 0.77930330730194497, 0.78626311698549078, 0.79919817579399299, 0.79846974037669427]}
perf_hmf_mtf_ccle_ic = {'R^2': [0.5637778089516734, 0.6229008287739488, 0.6459166259801155, 0.671001063028316, 0.6775223245124332, 0.6769281050910366, 0.685745034895577, 0.6910036735319031, 0.6694839518093924, 0.6769815503342866, 0.6756972749942373, 0.6681651933732523, 0.6507771956109533, 0.6214759646358363, 0.6086625531827311, 0.609331026295461, 0.5998979402312878], 'MSE': [0.075668159556016051, 0.065716273156219904, 0.061614113283628501, 0.057161702436326935, 0.056240449874023976, 0.055908668389967095, 0.054612399141030388, 0.05384105995762134, 0.057502333576918127, 0.056176597222810487, 0.056452199749285573, 0.057859381544366317, 0.06065747412056921, 0.065580171633972964, 0.06823222059373478, 0.067825831293541208, 0.069657805031371894], 'Rp': [0.75283516182071364, 0.79003622116100714, 0.80570880614354878, 0.82028510435435842, 0.8246625884728791, 0.82443035932769904, 0.82998817926748958, 0.83341589076298761, 0.82184402570861192, 0.82499482242939481, 0.82544429431384159, 0.82196315078744164, 0.81386472665021348, 0.79826751638699256, 0.79158984845298297, 0.79112916167406067, 0.78583155390421155]}


''' Plot '''
fig = plt.figure(figsize=(3.8,3.0))
fig.subplots_adjust(left=0.15, right=0.965, bottom=0.12, top=0.97)
plt.xlabel("Kt", fontsize=12, labelpad=1) #fontsize=8
plt.ylabel("MSE", fontsize=12, labelpad=2) #fontsize=8, labelpad=-1
plt.yticks(fontsize=8) #fontsize=6
plt.xticks(fontsize=8) #fontsize=6

plt.plot(values_K, perf_hmf_mf_ccle_ic['MSE'], linestyle='-', linewidth=1.2, marker='o', label='HMF D-MF', c='red', markersize=5)
plt.plot(values_K, perf_hmf_mtf_ccle_ic['MSE'], linestyle='-', linewidth=1.2, marker='o', label='HMF D-MTF', c='blue', markersize=5)
 
plt.xlim(0,values_K[-1])
plt.ylim(MSE_min,MSE_max)

plt.legend(loc='upper left',fontsize=10)
    
plt.savefig("./varying_K_ccle_ic.png", dpi=600)