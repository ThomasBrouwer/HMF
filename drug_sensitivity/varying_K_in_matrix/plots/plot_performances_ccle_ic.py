'''
Plot the performances of HMF D-MF and D-MTF, with varying values for Kt, on
the GDSC dataset.
'''

import matplotlib.pyplot as plt

MSE_max, MSE_min = 0.11, 0.04
fraction_min, fraction_max = 0.25, 0.95

values_K = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 25, 30]

perf_hmf_mf_ccle_ic_ARD = {'R^2': [0.5910922382221295, 0.6531908838142564, 0.6629382033090828, 0.6797758870849914, 0.6817821366180813, 0.6843181437032306, 0.6762967198598966, 0.6661954618598349, 0.6773871404090466, 0.6512353353949608, 0.6504416024816939, 0.6394313984979657, 0.5865500355709877, 0.584331170403394, 0.5516416926137764, 0.6343167857989174, 0.6317481418362226], 'MSE': [0.071035912401119519, 0.060296826294145754, 0.058798734466451563, 0.055765316137568063, 0.055397070568064088, 0.054833788673537845, 0.056087323930680166, 0.058004186083619014, 0.055993851091518686, 0.060733798706769392, 0.06060710501145411, 0.062501913340019158, 0.071943528884849797, 0.072254370174732283, 0.078114498077536051, 0.063622753521215963, 0.064012712501347227], 'Rp': [0.77071051660718881, 0.80881157457886688, 0.81542469131322337, 0.82576887459029957, 0.8270272573255959, 0.82959606579522338, 0.82469378030229712, 0.81957530654148203, 0.8261845040836816, 0.81238094284337414, 0.81260144670517231, 0.80648610575371349, 0.78074642009213968, 0.77814678578549568, 0.76313668279044755, 0.80223619792802514, 0.80042254096762799]}
perf_hmf_mf_ccle_ic_no_ARD = {'R^2': [0.5918603429896213, 0.6530251694597508, 0.6531941799605078, 0.675733229733389, 0.6840381447618619, 0.6839886405866593, 0.6806215115260226, 0.6745988359141192, 0.6633073685548363, 0.6637351303385091, 0.673653494439065, 0.651861728470893, 0.6391279706220506, 0.6463859342301752, 0.6383641072487218, 0.5785437210469763, 0.5675628364959946], 'MSE': [0.07095956654633287, 0.060417544928583568, 0.060511519428802764, 0.056432659637867442, 0.054872522084523992, 0.054883332399356867, 0.055583435963792907, 0.056703127415110965, 0.05850708302254122, 0.058687850499123728, 0.056610334326547683, 0.060291121255975702, 0.06263250506739873, 0.061481660633877756, 0.063059457049180576, 0.073350890085052356, 0.075069711955655843], 'Rp': [0.7715131559709103, 0.80868261200269509, 0.80962777739240754, 0.82365390152977225, 0.82883050981581774, 0.82952956785649568, 0.8271245645798585, 0.82414274865365567, 0.81804523363338255, 0.81944640838011595, 0.82421757506261173, 0.81287332778952592, 0.80739760668110294, 0.81077506101767849, 0.80710936901109065, 0.7776903673704807, 0.77406066850604682]}

perf_hmf_mtf_ccle_ic_ARD = {'R^2': [0.5637778089516734, 0.6229008287739488, 0.6459166259801155, 0.671001063028316, 0.6775223245124332, 0.6769281050910366, 0.685745034895577, 0.6910036735319031, 0.6694839518093924, 0.6769815503342866, 0.6756972749942373, 0.6681651933732523, 0.6507771956109533, 0.6214759646358363, 0.6086625531827311, 0.609331026295461, 0.5998979402312878], 'MSE': [0.075668159556016051, 0.065716273156219904, 0.061614113283628501, 0.057161702436326935, 0.056240449874023976, 0.055908668389967095, 0.054612399141030388, 0.05384105995762134, 0.057502333576918127, 0.056176597222810487, 0.056452199749285573, 0.057859381544366317, 0.06065747412056921, 0.065580171633972964, 0.06823222059373478, 0.067825831293541208, 0.069657805031371894], 'Rp': [0.75283516182071364, 0.79003622116100714, 0.80570880614354878, 0.82028510435435842, 0.8246625884728791, 0.82443035932769904, 0.82998817926748958, 0.83341589076298761, 0.82184402570861192, 0.82499482242939481, 0.82544429431384159, 0.82196315078744164, 0.81386472665021348, 0.79826751638699256, 0.79158984845298297, 0.79112916167406067, 0.78583155390421155]}
perf_hmf_mtf_ccle_ic_no_ARD = {'R^2': [0.5649123845153683, 0.6220918014405556, 0.6465493397052937, 0.6644637807262898, 0.6683309891889193, 0.6690493753950661, 0.6692245659238865, 0.674504714587984, 0.6674779453573751, 0.6641336463160181, 0.6567276890559317, 0.6341744192965353, 0.5926801430461524, 0.5802284419552813, 0.5674486510313731, 0.5174154287879993, 0.45935385138470225], 'MSE': [0.075526044520224322, 0.065592212450125101, 0.061289893938475018, 0.058524973461807225, 0.057726800228028022, 0.057695903459691701, 0.057245871259827316, 0.056670345042860795, 0.057626590084049426, 0.058285005123450674, 0.059763100478976802, 0.063676679241231895, 0.071011090049675291, 0.072801236873157815, 0.075278841815490494, 0.084076492874460479, 0.094114844928637781], 'Rp': [0.75345440489284243, 0.7903485977118323, 0.80523204817908778, 0.81673814324704819, 0.81891625774327148, 0.81992583671359243, 0.81995362231816737, 0.8238621132261349, 0.8198394718925085, 0.81923222304939358, 0.81605875138132533, 0.80466614767932731, 0.78686207637379846, 0.78507283894636093, 0.77807883650100784, 0.75473405331883514, 0.73534458094347988]}


''' Plot '''
fig = plt.figure(figsize=(3.8,3.0))
fig.subplots_adjust(left=0.15, right=0.965, bottom=0.12, top=0.97)
plt.xlabel("Kt", fontsize=12, labelpad=1) #fontsize=8
plt.ylabel("MSE", fontsize=12, labelpad=2) #fontsize=8, labelpad=-1
plt.yticks(fontsize=8) #fontsize=6
plt.xticks(fontsize=8) #fontsize=6

plt.plot(values_K, perf_hmf_mf_ccle_ic_ARD['MSE'], linestyle='-', linewidth=1.2, marker='o', label='HMF D-MF (ARD)', c='red', markersize=5)
plt.plot(values_K, perf_hmf_mf_ccle_ic_no_ARD['MSE'], linestyle='-', linewidth=1.2, marker='x', label='HMF D-MF (no ARD)', c='red', markersize=5)

plt.plot(values_K, perf_hmf_mtf_ccle_ic_ARD['MSE'], linestyle='-', linewidth=1.2, marker='o', label='HMF D-MTF (ARD)', c='blue', markersize=5)
plt.plot(values_K, perf_hmf_mtf_ccle_ic_no_ARD['MSE'], linestyle='-', linewidth=1.2, marker='x', label='HMF D-MTF (no ARD)', c='blue', markersize=5)
 
plt.xlim(0,values_K[-1])
plt.ylim(MSE_min,MSE_max)

plt.legend(loc='upper left',fontsize=10)
    
plt.savefig("./varying_K_ccle_ic.png", dpi=600)