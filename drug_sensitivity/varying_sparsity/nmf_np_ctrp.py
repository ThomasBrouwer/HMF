"""
Test the performance of NP-NMF for recovering the CTRP dataset, where we vary 
the fraction of entries that are missing.
We repeat this 10 times per fraction and average that.
"""

project_location = "/home/tab43/Documents/Projects/libraries/"
import sys
sys.path.append(project_location)

from HMF.code.models.nmf_np import nmf_np
from HMF.code.generate_mask.mask import try_generate_M_from_M
from HMF.drug_sensitivity.load_dataset import load_data_without_empty

import numpy, matplotlib.pyplot as plt, random

''' Settings '''
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]
repeats = 20
iterations = 1000

init_UV = 'random'
expo_prior = 1.
K = 2

metrics = ['MSE', 'R^2', 'Rp']

''' Load data '''
location = project_location+"DI_MMTF/data/datasets_drug_sensitivity/overlap/"
location_data = location+"data_row_01/"
R, M_original, _, _ = load_data_without_empty(location_data+"ctrp_ec50_row_01.txt")

#''' Seed all of the methods the same '''
#numpy.random.seed(0)
#random.seed(0)

''' Generate matrices M - one list of (M_train,M_test)'s for each fraction '''
M_attempts = 10000
all_Ms_train_test = [ 
    [try_generate_M_from_M(M=M_original,fraction=fraction,attempts=M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]

''' Make sure each M has no empty rows or columns '''
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms_train_test,fraction in zip(all_Ms_train_test,fractions_unknown):
    for (M_train,M_test) in Ms_train_test:
        check_empty_rows_columns(M_train,fraction)

''' Run the method on each of the M's for each fraction '''
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms_train_test) in zip(fractions_unknown,all_Ms_train_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for repeat,(M_train,M_test) in zip(range(0,repeats),Ms_train_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
    
        NMF = nmf_np(R,M_train,K)
        NMF.initialise(init_UV,expo_prior=expo_prior)
        NMF.run(iterations)
    
        # Measure the performances
        performances = NMF.predict(M_test)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
 
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)

'''
1000 iterations
repeats=10 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.40910052374279404, 0.35518063968665603, 0.4686793129653376, 0.4393414112764209, 0.38251912379572095, 0.4598033960502821, 0.44334112553808325, 0.31575325349258365, 0.32376810471832984, 0.43495486108472525], [0.3543986105405853, 0.3790020142559063, 0.39477881499777434, 0.42013413772960784, 0.41594077100518934, 0.41429581470583476, 0.4307775761629682, 0.3942632521993852, 0.45409466900520434, 0.44720119683374127], [0.4127250290274379, 0.40416075951674113, 0.36980350140923257, 0.40049902579448826, 0.4139963786758305, 0.430496597388229, 0.3783455276958, 0.3951636892354451, 0.3689790975945141, 0.4214692372214668], [0.3922440460418496, 0.2910067731504383, 0.42036534455078756, 0.342078473010053, 0.3553777520235559, 0.38739044522662214, 0.377930565920481, 0.41148792922342303, 0.38310793989083847, 0.34740889364530414], [0.38156797354241945, 0.3859727331384495, 0.3540849801708852, 0.3326402921775321, 0.35501629679290636, 0.3996594843554212, 0.3809525615952577, 0.40292705623126845, 0.3713826801813629, 0.3662942143617859], [0.35788577881575157, 0.3545117352972038, 0.37872829305603184, 0.3233766334681665, 0.3994647868841774, 0.3711742350027697, 0.3361289100149071, 0.39335924295796676, 0.3845512803236364, 0.3231809018230447], [0.3411178703759222, 0.3679640435865563, 0.3460910071553812, 0.3809415381774579, 0.3672832644471624, 0.35642220987503026, 0.37484305485535274, 0.33973651406297367, 0.36471836896248666, 0.3741289497832446], [0.3243558432441491, 0.35132027419486844, 0.37060655752463634, 0.33074616044773775, 0.3456986049306341, 0.3682473157854794, 0.36709578066616944, 0.2963518466226287, 0.2932360711246065, 0.3339675558181716], [0.3062507405122401, 0.32686849144449803, 0.3581712994191586, 0.3403530560198933, 0.3215314863610258, 0.29879521526713104, 0.33837997118664065, 0.3352161842397512, 0.269319898719509, 0.002574276080036464], [0.3140431109650058, 0.26661478686635653, 0.2893194871187945, 0.3093693406958036, 0.2868972418659754, 0.2864919540951312, 0.22983027464898498, 0.2558340991651171, -0.017238883421321516, 0.31517798565910593], [0.2743512861790267, 0.2748610069566235, 0.29816601649212615, 0.26251032993988554, 0.2656682955727244, 0.18300628875101188, 0.2514031239925377, 0.2987174684972195, -2697.349999039004, 0.2898668661945413], [0.0731089617928723, 0.022467711904366694, 0.24849441309296338, 0.24584119838315477, 0.20812196742214206, 0.05129985435007356, -0.03226266773959785, 0.09518929337875504, 0.18395438621287352, -0.969831389604261], [0.15380714667583661, -0.30559832735200887, 0.1727670112689873, 0.14192184345260528, -0.1259421105544436, 0.13733866379422255, -0.19509322639278093, -0.024060381991551028, -1466.130621886647, -0.04513455518465137], [-0.07965462377587462, -2498066.7334870696, 0.003999599219638217, -0.05145894423688824, 0.009417515796176668, -0.04748687554091546, -0.265332076734492, -13.894119744741673, -0.6529570288538076, -0.08694700631141772], [-698904.8520928668, -0.7110508601313961, -0.15558957578799726, -38953.14735768874, -478.2151869399507, -65.9903594485196, -0.14636794967929911, -6.730612076835128, -3.941768592681374, -0.8184798637957209], [-0.22998983119788075, -0.7571614793980153, -186643.10126030404, -0.28224478488368265, -0.3892265446608527, -0.2838681864105672, -0.4728708379566795, -1151948.0057564627, -0.33186243626972645, -8817631757.968481]], 'MSE': [[0.098017710744928974, 0.092345027554348161, 0.083232012431290664, 0.092116359850211355, 0.10638752970907939, 0.089106669395730739, 0.087789846479379499, 0.11633482618846425, 0.10849975293197209, 0.087555476530501108], [0.10018407959498569, 0.098884337728418759, 0.096302729127199199, 0.095131995012870244, 0.094547185846937457, 0.094034442318661121, 0.086428288041403914, 0.09830057939416896, 0.090169103905696907, 0.089021001753756657], [0.094983038022998068, 0.096426716221168329, 0.10005117714243565, 0.094073044056297919, 0.09225520105262934, 0.089689543514174908, 0.10080933101253246, 0.093800737753290384, 0.09975700374412369, 0.093334882152564455], [0.097724719305224389, 0.11307898504513893, 0.091542541367763464, 0.10377429018079039, 0.10195783937586965, 0.097377213438622462, 0.10057698034728417, 0.093549672648884433, 0.095760049004172759, 0.10440480889445553], [0.097849056749478622, 0.097695079755491854, 0.10320831824670154, 0.10496952878701674, 0.1022746443397613, 0.095500802688186753, 0.10021289404314414, 0.094323407722221878, 0.09818116265724508, 0.10000016207628146], [0.10152641155071428, 0.10147846509911268, 0.099499221052200368, 0.10658365456584874, 0.095547959553426251, 0.10153761638471381, 0.10550581712682987, 0.097005455626160725, 0.10048170786621879, 0.10829779753624837], [0.10596237890047705, 0.1009647477404471, 0.10418280220675828, 0.098866294380587139, 0.10180789571186298, 0.10153091109311914, 0.098031663691755436, 0.10648703901068381, 0.10107801330190748, 0.10019167991576432], [0.10793465490860323, 0.10373256933434381, 0.10103676028320273, 0.10564309439767618, 0.10418668645346743, 0.10020017134230867, 0.10063719146230431, 0.11154392313960693, 0.11169367202381499, 0.10611801502795919], [0.11046187013246961, 0.10704457289719461, 0.10302368697688294, 0.10568504680868146, 0.10667698858842097, 0.11172737045869383, 0.1049590935029989, 0.10741165619480954, 0.11478275199399068, 0.15863946081674832], [0.10956864982581006, 0.11611631561694859, 0.11123265359824214, 0.11014867495329451, 0.11283115061388455, 0.1147277143756915, 0.12163204132610868, 0.11754207192371509, 0.16228290186720717, 0.10908511278830418], [0.11529215782120664, 0.11391387088079276, 0.11325284316131055, 0.11705064200343415, 0.1159219011473079, 0.1288501046358978, 0.11965384290992349, 0.11089457879646569, 432.22400436019888, 0.1126776155631697], [0.14834739446144268, 0.15414415407294207, 0.12048642565789962, 0.1198210865178535, 0.12536642497358869, 0.15011463668056549, 0.16437710486262899, 0.14393751037094113, 0.12931219406247899, 0.3145067151190718], [0.1347707228155908, 0.20642966318965869, 0.13167350099144218, 0.13609389523697496, 0.18035236011964662, 0.13798168183268639, 0.18928240496585633, 0.16269362758217129, 233.99782853966042, 0.167305069542349], [0.17231207918330238, 399015.50408017577, 0.1577660253808737, 0.16665004896925661, 0.15730485226089055, 0.16649363680831666, 0.20144037378712829, 2.3617147136576895, 0.2628587728526367, 0.17311259263973325], [110903.82706433718, 0.27374709984512419, 0.18299922147479461, 6197.5497715480897, 76.572060431505051, 10.604222267279175, 0.18133554387585388, 1.2336250630001209, 0.78553557138902597, 0.28897029572583066], [0.19559742127090676, 0.28034672648162501, 29627.864493198209, 0.20404574083751892, 0.22050330101781138, 0.2039965612351731, 0.23480724713080361, 183385.74484788184, 0.21173187862633547, 1398963761.7755308]], 'Rp': [[0.6460887411923949, 0.60350183189859452, 0.68525578884937566, 0.66576644394297269, 0.63157466431652187, 0.68135467442537589, 0.67142202759439262, 0.57597492568757291, 0.58428759878490999, 0.67072331385434059], [0.60625945296754946, 0.62029920745417066, 0.63286730300959027, 0.65052685251951636, 0.64823603545801178, 0.64951147470308845, 0.66112207292451353, 0.63326734483477976, 0.67479464929232025, 0.6692521143981599], [0.64835655098554978, 0.64084219456878877, 0.61722642991190657, 0.63637881669478324, 0.647354295081632, 0.65857398055693828, 0.62611872636874955, 0.63429765611035915, 0.61888848481548686, 0.65382069642111584], [0.63392587184053117, 0.56565379323957432, 0.65300603090099441, 0.5973774697481764, 0.60782468917040833, 0.62867034716835146, 0.62315211819213268, 0.64542305220818708, 0.62537388666763949, 0.60346223995414805], [0.62774747400020314, 0.62663721055455956, 0.60592200073113189, 0.59386940910612229, 0.610048172052849, 0.63801691428894025, 0.62341278678844914, 0.64083516692140019, 0.61788961007185239, 0.61431087074889568], [0.61176142774660747, 0.60687399990872093, 0.62470812686998478, 0.59067833640275202, 0.63869361746544584, 0.61809176362458307, 0.59772015188830996, 0.63337977692969816, 0.62726593907220152, 0.58586215245484519], [0.60203296644595461, 0.61805855637360951, 0.60053887560031183, 0.62585750333300383, 0.61675411407144709, 0.61056944614062436, 0.62400651709737054, 0.59787973286131002, 0.6170938885910987, 0.62214449115125259], [0.59216736210849219, 0.60867910057355212, 0.61849907913216962, 0.59850305525716962, 0.6024479149588452, 0.61687589663418518, 0.61663832778536032, 0.57807025228348996, 0.56925804484656617, 0.59457482907833814], [0.58353622960904428, 0.58821622238450233, 0.60989193722292534, 0.59935893778640037, 0.58900791354284121, 0.57668789517605878, 0.59977724855112791, 0.59733044264939972, 0.56671302221766617, 0.13818216862378688], [0.58743819523414564, 0.55871727454596087, 0.57382910742330351, 0.58681029999712664, 0.57065927199320177, 0.57206236245769593, 0.54952792958711516, 0.55498024292985204, 0.4578659236961955, 0.58586427287141518], [0.56349614379922308, 0.57758519910653128, 0.57835426367067355, 0.55967679931389047, 0.5607016635401838, 0.53266066987121108, 0.55082283261538956, 0.57822440167241518, -0.0071375911594636727, 0.58077865403558271], [0.49231915464041975, 0.47713065075967731, 0.55041365696450462, 0.55456824572011398, 0.53105327984738304, 0.48029728198511129, 0.47446658018923155, 0.48716878825832072, 0.52035919815600895, 0.33124092879600292], [0.51128731965464247, 0.39726578069516194, 0.51432628172778183, 0.51031800344010692, 0.4276479500132781, 0.51866739202007794, 0.42816715673001621, 0.11994638897281641, -0.0039379711931879771, 0.10580092118146546], [0.45158500896285225, 0.016471274210462464, 0.46720376037304934, 0.10678946444282525, 0.47581122848108459, 0.11420532880436292, 0.42217449787587674, 0.12365207726699656, 0.35771941800121937, 0.086475302964942574], [0.0070173182614290831, 0.34722420734205772, 0.072291531393121805, 0.0051712913090783174, 0.030187609652587537, 0.045751631535116251, 0.084528063748147045, 0.16251656914508655, 0.21123847214064501, 0.34444858544873325], [0.080301299221851377, 0.053994446978643529, -0.0090309934356583455, 0.066760539111871187, 0.050090809159141922, 0.061909028370914998, 0.055096358615357839, 0.015556015643312941, 0.061288584098040506, 0.0037076502877853067]]} 
average_performances = {'R^2': [0.40324417523509337, 0.41048868574361974, 0.3995638843559185, 0.37083981626833534, 0.37304982725472885, 0.36223617976436556, 0.36132468212815677, 0.3381626010359081, 0.2897460619249884, 0.2536339397658954, -269.49514483564286, 0.012638372919334251, -146.62206158229307, -249808.17980262544, -73841.47088658628, -881897035.1822722], 'MSE': [0.096138521181590636, 0.094300374272409893, 0.09551806746722151, 0.099974709960820626, 0.099421505706552935, 0.10174641063614738, 0.10191034259533627, 0.10527267383732875, 0.1130412498370891, 0.11851672868892067, 43.327151191711835, 0.1570413646779413, 23.54444114659368, 39901.93237332713, 11719.149933137936, 139917677.69359007], 'Rp': [0.64159500105464518, 0.64461365075616994, 0.63818578315153096, 0.61838694990901433, 0.61986896152644033, 0.61350352923631479, 0.61349360916659834, 0.59957138626581685, 0.54487020177637535, 0.55977548807360122, 0.50751630364656364, 0.48990177653167744, 0.35294892232421593, 0.2622087361383672, 0.13103752799760024, 0.043967373805126123]}

repeats=20 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.45775822380279796, 0.30090102915424055, 0.4446809445124402, 0.4128628226689852, 0.5129659097493511, 0.38480865864349934, 0.48295101923938677, 0.2859834653434228, 0.54196454803461, 0.4873451274180005, 0.39687647060405196, 0.4855957075199955, 0.3583350459118203, 0.3982416422860774, 0.5117263695257643, 0.30986711733918315, 0.42607333650973034, 0.3397441342205646, 0.39446912113782284, 0.3780448748159997], [0.4449334045621287, 0.36274218375151923, 0.41696475589448834, 0.3683109727509014, 0.39320573299676087, 0.35760193165569376, 0.4281819156929896, 0.39932017059542346, 0.3848840794513071, 0.41121726779543655, 0.3610365952550989, 0.3809351628868496, 0.4339418058140203, 0.38366689739309046, 0.4254984893586077, 0.387667027789397, 0.388202039086863, 0.38313375007496575, 0.4097870398196727, 0.36433652853418563], [0.4045003821323745, 0.4182679015430475, 0.3880003171714824, 0.35490257018099536, 0.4337423589051532, 0.4170899770315628, 0.40240686850652363, 0.40463793007949245, 0.3938334595372529, 0.35809780404919445, 0.3651349545701611, 0.4080355606507625, 0.4128741182410064, 0.42718118614442135, 0.38116257622679417, 0.40880968994878275, 0.41939549672645937, 0.4134083655067271, 0.40610364026474266, 0.4185766477086851], [0.3730825068945519, 0.4006855034596444, 0.3991380084457088, 0.3988513524911982, 0.42093260180274483, 0.37287669679200364, 0.3587478722602726, 0.36629944259985525, 0.3873607619923227, 0.38892134949818324, 0.39169914067369205, 0.3714506766820145, 0.3514930914354678, 0.43438994384549534, 0.3669485636435559, 0.4206347154491068, 0.4163318611586716, 0.39413606626136866, 0.3942545226024077, 0.38053249649952625], [0.3523286800240405, 0.33144485316827565, 0.38618357179377094, 0.39895357899111816, 0.35001554599246865, 0.4028449960088819, 0.3624791333300833, 0.39199079569554096, 0.35866018843958436, 0.3785650365998452, 0.34958715632412274, 0.37468598960311417, 0.38789801752768194, 0.39587225885382027, 0.36959491462341965, 0.37714234158041904, 0.30208393678389034, 0.4091281307148469, 0.3991600904075523, 0.3869291081199121], [0.39656663677867054, 0.3760988992211174, 0.3974381144316276, 0.33505795770679103, 0.3402992368013039, 0.35807596014210563, 0.3982174992865919, 0.3652962516084687, 0.3856236122819524, 0.3909635813615614, 0.38760894545284497, 0.37602009955411886, 0.3692891438747822, 0.3853565105076435, 0.38992169692869627, 0.3542472371151114, 0.3762262715077155, 0.3423614578420009, 0.336195985309225, 0.3895120784256597], [0.3138967926158479, 0.32954415395542547, 0.3575433157065462, 0.3543568719603275, 0.3909875843806563, 0.3950916940248408, 0.3668155718603785, 0.3813537982037397, 0.3780365772311203, 0.32519638674268336, 0.37136426232297326, 0.37639298622971884, 0.3772932213520296, 0.35965206209090317, 0.37716976771844213, 0.374896776554562, 0.2973057112550753, 0.3586721871548585, 0.3950644883275095, 0.37495574938202736], [0.3612508188181549, 0.37028462763702696, 0.3225769621299346, 0.3312725572288082, 0.3498840010916554, 0.32181319312631107, 0.3455616720496365, 0.35116388032504253, 0.3614671404863875, 0.3801728449714977, 0.36705656196726966, 0.3560264101642364, 0.36067178823533563, 0.3591411112817662, 0.36303538861144513, 0.316756187107871, 0.33504937648965016, 0.2789940841270656, 0.35847887658211, 0.2641831758697507], [0.3464800738510385, 0.3255173399068464, 0.3523192210811682, 0.2988976902383724, 0.2661411716102875, 0.32717551745832363, 0.3574094821915581, 0.3445140616831278, 0.2704650858477161, 0.33918981656172276, 0.2947189263927138, 0.32039972801684713, 0.3386888759889558, 0.32746956521747206, 0.3189435947016128, 0.31244308722881287, 0.3327000875299284, 0.32383964120112474, 0.32538394131607606, -0.08266767490583815], [0.31889582518072324, 0.28249193367843806, 0.3130060872846179, 0.33316998529706854, 0.2565742754617729, 0.3032457238146279, 0.3388659452888996, 0.3325116247866645, 0.34498179152628894, 0.2833925728196144, 0.28635437723569857, 0.3011383676834133, 0.3303711012572752, 0.3089341988915417, 0.3174055811881197, 0.3111103613041081, 0.2953965159117907, 0.3232428576432933, 0.2993692529621962, 0.29205608366573443], [0.2841334084443109, 0.1924511643809128, 0.28040175928340005, 0.2779027181515754, 0.23724973281858952, 0.2686063496428235, 0.1543806264607408, 0.26785862680796924, 0.2585474882506482, 0.30169960957006003, -0.010023360329362907, 0.2971522633312105, 0.09956629896109237, 0.26228094275976055, -931373.8937167512, 0.2813658392627889, 0.27528031160132693, 0.2669078484404571, 0.2716796407254334, 0.25807013496007913], [0.19183822744480994, -0.012243721760868631, 0.26629617415277684, 0.1753567724650178, 0.21030469990060163, -7.1977794556279395, 0.22027235600609674, 0.2386850094568974, -0.2295549936290322, 0.18211597260338208, 0.23873374428313288, 0.22506213884962856, 0.15805448102536546, 0.12124270899112388, 0.22729810712616805, 0.24940956483821775, 0.24326512176595605, -12.137941957977551, 0.16932614992130002, 0.23689178044636872], [-0.03476182970824082, -0.17173231504940167, 0.19588847611123628, -0.0405304226174108, -5.283549655427644, -0.051674780651941976, 0.05920141023588832, -0.6929410510306953, -0.03791273993582811, -0.023646929330710442, 0.21286834307927827, 0.19114071270375899, -0.05193216580815818, 0.13268185803763677, 0.13078117685336765, -0.06866340314954922, 0.10123345457363608, 0.202369329769719, 0.07462369506993893, 0.016997351992003917], [0.04900537864996468, 0.002066442285350023, -0.07761142901508578, -3.4736205653927685, -116.438617289252, -0.02242754542725134, 0.042446803409649125, 0.040471771295092385, -0.22094162295113984, -0.05463274308983457, -0.11629943076649596, -0.1369947002638674, -0.05975466585642186, -0.7855260845567982, -0.5555424974431677, 0.06723235271233907, -0.6921683330111372, -92203.45148697069, 0.013927482053554208, -12.93245969147345], [-0.13565137273864147, -0.20813004498029963, -0.12814454122823116, -3.2065059732237238, -1727.1154754936133, -0.10574718313269327, -3.5601457953890705, -1.0713634860541559, -5.859428197172707, -1083792.7975816736, -9784.606494372445, -15.188346249029994, -31243.482378786655, -0.26429716043011875, -2685.778960280318, -0.09370496951454954, -119.79395496415903, -0.09482171777350068, -0.11079543064642383, -0.10507794460021591], [-0.9184896020408593, -0.4159561294154388, -0.2419382400040413, -396.0883234908957, -0.5170480482409376, -0.36840397354298493, -0.5286292866563023, -0.2608960241097973, -0.32537524238389737, -0.6109716874008502, -1316875.3535138958, -380.4687378013322, -0.5031078009813237, -135397.81265977275, -0.23435126711901044, -3476871.7077802746, -878511.2917352711, -0.278234098191545, -0.4024466906033879, -0.3400342769010536]], 'MSE': [[0.085777401267275746, 0.10760966551424365, 0.08878448949556271, 0.10192837246492835, 0.075229946651555468, 0.095186163388359821, 0.081839151511632124, 0.10943170528781931, 0.080362675336331235, 0.068768298521734023, 0.098192463467820901, 0.079680836646767228, 0.099730844001250707, 0.098518313958222969, 0.078398716941283142, 0.11875484850482942, 0.093258627279456482, 0.1068861182009765, 0.093237693091168194, 0.090678824147298248], [0.087192818538262967, 0.098872927141382988, 0.096029499817312486, 0.1011681088463286, 0.095410262814055791, 0.099115648371276927, 0.089719535881683438, 0.093287345693166268, 0.096832691435064913, 0.095755654262531145, 0.10032081658052833, 0.099989692620601311, 0.093717577572464419, 0.098010477721309719, 0.089699347631731596, 0.096828608375646122, 0.099999505891171722, 0.10016735904274167, 0.093038008016603654, 0.10449947700425705], [0.093263161535109343, 0.091361898572684716, 0.095220545391791298, 0.10315436313359001, 0.088921675874744685, 0.094105885864463112, 0.093977857270141588, 0.095633626428688168, 0.098168017553673215, 0.10518876973499763, 0.10414951861202271, 0.092980786890463588, 0.091224252994993787, 0.093861209363001949, 0.096745563677344965, 0.093213555895260314, 0.091618034417666458, 0.091446206406986127, 0.096241544737278681, 0.09421317609038958], [0.1007383484201938, 0.09441982792913331, 0.094193639676774563, 0.096238587085482774, 0.092294536681871653, 0.0990381133812748, 0.10138707497211637, 0.097931690883838463, 0.098621319148456274, 0.097526979241980352, 0.10130515085089736, 0.098538638421740793, 0.10181941545383226, 0.090812321780306252, 0.10120755961402188, 0.094633369842863413, 0.092750570593263193, 0.09583643807962941, 0.095961291315275671, 0.099060808470410197], [0.10558984538582687, 0.10509179021418935, 0.096443843905603385, 0.097268069230122697, 0.10347957510623794, 0.095230143849791241, 0.099196633295932632, 0.096641219132089895, 0.10104763727626925, 0.10018076647835841, 0.10191899418624242, 0.10218617968854007, 0.095557919576590322, 0.095387414723080197, 0.10152304903246455, 0.097683302685326628, 0.11180936577407394, 0.09411380507235971, 0.09429491097355315, 0.09711969982640202], [0.096405262200056588, 0.10025400590451181, 0.095784334250708536, 0.10537709079409588, 0.1058328930568125, 0.10227525109940408, 0.094527291479190173, 0.10242863740622947, 0.096249926682950529, 0.096971268877483308, 0.096888365539201313, 0.097481121073190055, 0.10074604643005999, 0.098532838594217673, 0.096498991362015549, 0.10271720190275274, 0.10055108138093237, 0.10479965090237248, 0.10820312339083608, 0.097863797033677397], [0.10910590273095871, 0.1076605188761839, 0.10242983088426857, 0.10368171944493862, 0.095404930619459635, 0.097802403472680779, 0.10284597826646957, 0.098693901866123021, 0.099859539976746195, 0.1061413396599111, 0.10051504256140005, 0.099766793531848239, 0.10044646170831285, 0.10150124798465973, 0.098932239214235579, 0.10117666653586847, 0.11307407969967942, 0.10316556163589254, 0.095325314307130954, 0.097911532781536373], [0.10200180487578768, 0.099838029015983751, 0.10710207843466438, 0.10584698173527893, 0.10294991023580659, 0.10764820991449645, 0.10419613025447544, 0.10418337318244617, 0.10285189729340879, 0.09870582686364085, 0.101718634432736, 0.10296048095621457, 0.10135606830619148, 0.10173233034036942, 0.10104979045329412, 0.11033573316027305, 0.106250995773052, 0.11426696527456269, 0.10417185737765103, 0.11557875850060509], [0.10448734289249234, 0.10686727825759619, 0.10299625226465506, 0.11212820417588547, 0.11728707993197429, 0.10720883856276993, 0.10262028502942371, 0.10572542156130896, 0.1158330976320875, 0.10616881048587513, 0.11257806841715269, 0.10841423998986902, 0.10467463816591056, 0.1060241857320588, 0.10986480839984619, 0.1086083425065046, 0.10542580459509444, 0.10800017147522475, 0.1069222050819526, 0.17006049812602797], [0.10801036876568576, 0.11274114797783381, 0.10902768115815624, 0.10519804364238985, 0.1178334641585313, 0.11206346141064366, 0.10566673614115354, 0.10619527267679077, 0.10371728696379363, 0.11267534907355672, 0.1130321184825904, 0.11315445073854877, 0.10632675010071896, 0.10852482061674656, 0.10656238085556977, 0.11002498135496663, 0.11232073691570349, 0.1079893220844874, 0.11136436077118347, 0.1114692791293152], [0.11448539727265947, 0.12787337133367438, 0.11487599528632561, 0.11481029799553051, 0.12083889308961955, 0.11732410792707049, 0.13449407448394279, 0.11584010086707364, 0.11792276898740317, 0.11162992025133059, 0.16044417252888091, 0.11065199299482828, 0.14322105535947069, 0.117630453042981, 147563.01732340996, 0.11531999459815225, 0.11527240030163732, 0.11804328205595617, 0.11553699866385964, 0.1189767574302425], [0.12883090275930678, 0.16219733555805543, 0.11687590954817252, 0.1316916282274993, 0.12651538341911794, 1.3087955561491273, 0.12441822018626493, 0.12070703427012522, 0.19777439220809725, 0.13001977538092288, 0.12107520560994089, 0.12352637223323024, 0.13330244477236575, 0.14007003811353022, 0.12313090232331883, 0.11983635222717066, 0.12063823109327322, 2.1057951717004335, 0.13180962749690139, 0.12066273253485106], [0.16522085170764714, 0.18662428360913497, 0.12815345335027886, 0.16555036315703553, 0.99687287767570099, 0.16748693936988873, 0.14879739268054015, 0.2683858918053787, 0.1659110188636006, 0.16304389985696138, 0.12483291196923114, 0.12935240936355177, 0.16666470137526576, 0.13862338727801424, 0.13830713125056598, 0.1709769802362032, 0.14221845544658329, 0.12730301907981861, 0.14758534138682036, 0.15610573273535344], [0.15035730960802551, 0.15834590686974978, 0.17177385143928375, 0.71206432983679213, 18.772035906913548, 0.162182550134638, 0.15224902684762925, 0.15200147032815164, 0.19332526699791974, 0.16776991148768411, 0.17788211597875786, 0.17993304940146751, 0.16822577328330784, 0.28405542253565053, 0.24801361766062013, 0.14785055515348736, 0.26912122369251562, 14674.543208619829, 0.1550964929087788, 2.2203129960773702], [0.18098414694824083, 0.19275108639404059, 0.17940915255630371, 0.66461713116724608, 275.52508926818206, 0.17568619391276441, 0.72330860817175757, 0.32977799594079865, 1.090780858866472, 172725.11393685383, 1555.9534121600798, 2.5731824165857193, 4970.8851448523892, 0.20026180480796049, 426.24667804220365, 0.17366798679938944, 19.139954319386369, 0.17380368186667264, 0.17693593639027111, 0.17598348240074901], [0.3046764217273904, 0.22501017900518067, 0.19701532852673717, 63.062845435625029, 0.24029126759408892, 0.21771159229666701, 0.24351260378095765, 0.20078443674667007, 0.21035813707131953, 0.2550400286920938, 209797.74782379679, 60.652691203607148, 0.2392016964829409, 21509.430783347758, 0.19711484792305395, 549052.49134799791, 139601.14672665208, 0.20299276855637696, 0.2233631239295904, 0.21281851171208607]], 'Rp': [[0.67729878205294181, 0.5654367428703897, 0.66695237299736509, 0.65161274323291452, 0.71819140971793938, 0.62776829927466837, 0.69940596777640818, 0.55727043054287362, 0.74163579295353865, 0.70383037974954354, 0.63119646814446173, 0.69863520829420689, 0.60496709498477785, 0.63763928230790412, 0.7158359887299901, 0.57600988764275118, 0.65576043308332865, 0.59428699935543006, 0.64377950813156237, 0.62149276341564241], [0.67280472389386914, 0.61115142128111988, 0.64857793286959242, 0.61521430372389041, 0.63403085688817418, 0.60546000332442917, 0.65859727322132922, 0.63853081942778644, 0.62405854034239783, 0.64242713582960576, 0.61464522489667872, 0.623102683702354, 0.6619180706493023, 0.62707314595382491, 0.65502154999842199, 0.62746853631522992, 0.62436759567152811, 0.62597178771088147, 0.64417662439044732, 0.61410686655803626], [0.64140101895574242, 0.65210571364595149, 0.63067333680718352, 0.60403960740009255, 0.6618909907914835, 0.64761761920008309, 0.64028474901688415, 0.64059695982969134, 0.63532811732505212, 0.60798368743188358, 0.61336231853920642, 0.6419625123855035, 0.64746525437664071, 0.65661666814722863, 0.62507023588843458, 0.64295986944557548, 0.65009200822519098, 0.64578323311076102, 0.64188902947692184, 0.64878702796879795], [0.62109134498791951, 0.63767381691985425, 0.63696985030385211, 0.63660309941099102, 0.65251255998095903, 0.62036424407301227, 0.61217491406740687, 0.61951351359755125, 0.63040086349071611, 0.63045981501042192, 0.63270009605589805, 0.62115103112200998, 0.60341381376100101, 0.66113859830812105, 0.61678119468032067, 0.6523356635681764, 0.64855901116659187, 0.63501801024931659, 0.63264816232410814, 0.62215002121873919], [0.60513463602434425, 0.59327649026010798, 0.6304802871297509, 0.63680942291596121, 0.60486357635991639, 0.6406759864655841, 0.61181508999697354, 0.63259084417418476, 0.61128835448655683, 0.62604471472586554, 0.6047840517631089, 0.62082741927581808, 0.6307616679338518, 0.63378995066928823, 0.61983940827467143, 0.6220074264176273, 0.57097951766578325, 0.64339467286683261, 0.63838436904370777, 0.62788611538886663], [0.6345677008401972, 0.62487510271741908, 0.63761749155707037, 0.59187618210635118, 0.59862998281020785, 0.61071578842952789, 0.63613940035538352, 0.6149941226514487, 0.62824205871935346, 0.63436314738391875, 0.63199330816871635, 0.62323478692402567, 0.61660137523966618, 0.63125072592740461, 0.63184605464848087, 0.60713572183941389, 0.62264407202627647, 0.60079013137023862, 0.59836423447806319, 0.63008682509798408], [0.58339489781621923, 0.5935373511798272, 0.61013636451682585, 0.60803264474942009, 0.63304299002952891, 0.63632279336969355, 0.61270623482104436, 0.62769213534837631, 0.62381181950672848, 0.59401841981540449, 0.62135803472173523, 0.62040829528126984, 0.62289151143332555, 0.61150306638441931, 0.62256310503296386, 0.62258106204687758, 0.5754536610263401, 0.61093502150689816, 0.63472633226931496, 0.62256739564189756], [0.61259091757616047, 0.6220120333284308, 0.59153617866562291, 0.59717781665001901, 0.6051560890230635, 0.58894077759497976, 0.60271291193870458, 0.60825484309967903, 0.61558644037761501, 0.62675855032439576, 0.61620366268850624, 0.61218424498456137, 0.61319359595277223, 0.61426270742120692, 0.61272576299324299, 0.5841546588276455, 0.59527546708027501, 0.56423214195626481, 0.60928187431762815, 0.55815657063154434], [0.60630025292839373, 0.59249505296797744, 0.60812128167800117, 0.5752190415437427, 0.55850379994910404, 0.59274108390763436, 0.61041647298753776, 0.603998738905688, 0.55857707259889833, 0.59911657855506806, 0.57349088757209254, 0.58978708426815518, 0.60339610931090581, 0.59622949540224557, 0.58614440551561298, 0.5836586979048648, 0.59702683271472634, 0.59026651832948773, 0.59111624073287961, 0.45647321569404392], [0.59170042246239651, 0.56867094966202791, 0.59260698113952615, 0.59819729173884928, 0.55489465336518962, 0.57702457622255099, 0.59940602266107335, 0.60013032207244865, 0.60649782741937019, 0.56608451324507647, 0.57225438844711063, 0.57533598882036185, 0.59585815776034767, 0.5796415217957519, 0.58896155880263801, 0.5851280657884691, 0.57873812418883019, 0.58978039910243463, 0.576688080630959, 0.57117330252237342], [0.56553975007805568, 0.53242573970765816, 0.56773743801205001, 0.56618817752305806, 0.55098557168850038, 0.56441476449626515, 0.51014787868869327, 0.57005921803539006, 0.56172047702586547, 0.57774345107827918, 0.46362060464378307, 0.58181732019315602, 0.50169755071704691, 0.56182243342654326, 0.012850882844973327, 0.5643744930163006, 0.57216083416425945, 0.55870398268512433, 0.56760981617839767, 0.56116264011934736], [0.53320491920765567, 0.13311584092994247, 0.56347836942443208, 0.52270434542466848, 0.53846641372413939, 0.15705293778128798, 0.53932600685047805, 0.54056379980331892, 0.41476580426072751, 0.52331195203428449, 0.54652672925391632, 0.53820609892808902, 0.50937775208881986, 0.50674653969592831, 0.54347505000013152, 0.5589744361608463, 0.55360471005762024, 0.12744183715411364, 0.52754390566319664, 0.54480482100435002], [0.10686486515963035, 0.42922164628602294, 0.52992002073585887, 0.11089322776113636, 0.17236960238492924, 0.099159819963283227, 0.47542943997552645, 0.35338290826430507, 0.11670822124312724, 0.4759318257500128, 0.54358927206070173, 0.53435827049158513, 0.097254810604061145, 0.50733497717622222, 0.51309460643346483, 0.44579152421383311, 0.499637921436343, 0.52910459637536211, 0.47904120920462978, 0.48474707270163875], [0.48408744918001501, 0.46462871130802536, 0.096730665581216652, 0.20875446009987444, 0.035253126695947989, 0.45952609643426789, 0.46898788626186699, 0.47314126061210671, 0.4437162498039165, 0.11548507000383186, 0.42999042130160459, 0.083030168905728327, 0.44208285154709187, 0.34418762986067686, 0.38115355223112185, 0.48664855478833752, 0.35139716687844541, 0.0099628649405276142, 0.46253858437358025, 0.13616328712942793], [0.086347888436231118, 0.075066951072131086, 0.072486804793728876, 0.23855688171991776, 0.0032925598535250389, 0.10520124486313992, 0.23749279651513661, 0.31950955349349547, 0.18720175286801233, 0.0018144932635787803, 0.014279230226413883, 0.12770733562992262, 0.037815393885712062, 0.42763429701705175, 0.045021272987990621, 0.092404501881804629, 0.052531521746620097, 0.081195079632091979, 0.084446311090731724, 0.092316744249364757], [0.041077821519023214, 0.042134701662387045, 0.087728508286572179, 0.042023737309419128, 0.050440943786073826, 0.05388324827681102, 0.059723033516114687, 0.087253747004552143, 0.072186930993968917, 0.036058844029162901, 0.018359026288833954, 0.027837859079472102, 0.057137809440923559, 0.0023541310218869048, 0.067638673684196959, 0.00060485348849415065, 0.0082321913237205398, 0.058970529810406923, 0.070162129630223086, 0.052600890546065711]]} 
average_performances = {'R^2': [0.4155597784218873, 0.39427838755797007, 0.40180809025628106, 0.3894383587243896, 0.37327741622911953, 0.3725188588068995, 0.36277949795348324, 0.3427420329150478, 0.30200146165589326, 0.3086257231440944, -46568.46841026739, -0.8111683559859275, -0.25697797421415575, -4616.940146666939, -56469.18535028185, -290421.9334316437], 'MSE': [0.092612757783925831, 0.09648276816290606, 0.095234482522264588, 0.097215784092168148, 0.099588208270652748, 0.10001940896803492, 0.10177205028791522, 0.10473729281904691, 0.11109477866418549, 0.10969490065091832, 7378.2661257722211, 0.28938366079058525, 0.19990085210987879, 734.95929026984925, 8998.9937682989421, 46004.385105468893], 'Rp': [0.64945032776293199, 0.63343525483244467, 0.63879549789841539, 0.6311829812148485, 0.62028170009194006, 0.62029841066455726, 0.61438415682490555, 0.6025198622716158, 0.58365394317335306, 0.5834386573923892, 0.52563915121613725, 0.47113461347239738, 0.37519179191108376, 0.31887330289688054, 0.11911613076133006, 0.046820480534915443]}
'''