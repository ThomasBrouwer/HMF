"""
Test the performance of NP-NMTF for recovering the CTRP dataset, where we 
vary the fraction of entries that are missing.
We repeat this 10 times per fraction and average that.
"""

import sys, os
project_location = os.path.dirname(__file__)+"/../../../"
sys.path.append(project_location)

from HMF.code.models.nmtf_np import nmtf_np
from HMF.code.generate_mask.mask import try_generate_M_from_M
from HMF.drug_sensitivity.load_dataset import load_data_without_empty

import numpy, matplotlib.pyplot as plt, random

''' Settings '''
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]
repeats = 20
iterations = 1000

init_FG = 'kmeans'
init_S = 'random'
expo_prior = 1.
K, L = 2, 4

metrics = ['MSE', 'R^2', 'Rp']

''' Load data '''
location = project_location+"DI_MMTF/data/datasets_drug_sensitivity/overlap/"
location_data = location+"data_row_01/"
R, M_original, _, _ = load_data_without_empty(location_data+"ctrp_ec50_row_01.txt")

#''' Seed all of the methods the same '''
#numpy.random.seed(0)
#random.seed(0)

''' Generate matrices M - one list of (M_train,M_test)'s for each fraction '''
M_attempts = 10000
all_Ms_train_test = [ 
    [try_generate_M_from_M(M=M_original,fraction=fraction,attempts=M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]

''' Make sure each M has no empty rows or columns '''
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms_train_test,fraction in zip(all_Ms_train_test,fractions_unknown):
    for (M_train,M_test) in Ms_train_test:
        check_empty_rows_columns(M_train,fraction)

''' Run the method on each of the M's for each fraction '''
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms_train_test) in zip(fractions_unknown,all_Ms_train_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for repeat,(M_train,M_test) in zip(range(0,repeats),Ms_train_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
    
        NMTF = nmtf_np(R,M_train,K,L)
        NMTF.initialise(init_S,init_FG,expo_prior=expo_prior)
        NMTF.run(iterations)
    
        # Measure the performances
        performances = NMTF.predict(M_test)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
 
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)

'''
1000 iterations
repeats=10 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.409102042727287, 0.35524471904624544, 0.4686013687222099, 0.4393369917901906, 0.3820908666623054, 0.4590424858299418, 0.443256434097969, 0.31587870796576134, 0.3243142425805057, 0.4350164087809526], [0.3545312839337411, 0.37903462135464483, 0.3948336713190106, 0.4202634407007363, 0.4159716904530002, 0.41432095931532475, 0.4311983669550433, 0.4093199214934139, 0.4540337906837829, 0.4469645348407638], [0.41184787143095736, 0.40433642620123733, 0.3636821241434829, 0.4002559217833104, 0.41923909835671425, 0.43021287288464993, 0.3783231970687043, 0.3953699094340759, 0.3682666529319244, 0.4278018282863837], [0.39692124574654397, 0.3321584347986458, 0.4203296589692439, 0.3734796445050286, 0.38135912119881876, 0.3873928924890828, 0.37508958395697645, 0.4114564246180116, 0.3833925504133927, 0.35565290848581177], [0.4034402568548797, 0.38653545136872447, 0.3786309095218259, 0.33869984741578973, 0.35529679334046504, 0.3993183686632421, 0.38130013161978393, 0.4029355360092136, 0.3719764196033494, 0.36607134529602225], [0.372765483990646, 0.35724870121630126, 0.37606528681183027, 0.36746287162235336, 0.39946701486226843, 0.37114102882879907, 0.3883444134268046, 0.38907902609238365, 0.38456088492684526, 0.3875107821647187], [0.36671312432723024, 0.38834088563608915, 0.3472759753633603, 0.38394129408682653, 0.3806223061393148, 0.3580029936817106, 0.34145742075694796, 0.3888884265598259, 0.3644398598616203, 0.37398403004338454], [0.3420583357827879, 0.35547879089180356, 0.34723873743330835, 0.31910423335058247, 0.3834798701199733, 0.35033565080395934, 0.3645101178041742, 0.3470611963761455, 0.31621997027788673, 0.33554220984545224], [0.3063086773187026, 0.3206233188116362, 0.3582104801997782, 0.35643657252671535, 0.3595556486472795, 0.34569322212894926, 0.37032209267487814, 0.33308845309969703, 0.31715821628782115, -0.009222925028883111], [0.2746228273836754, 0.2766541850819967, 0.26333176589625007, 0.2905281739347392, 0.30211411650915254, 0.3112180881636605, 0.32623038477734, 0.3052215242427334, -0.004398284459765867, 0.30128360562063283], [0.25596332855473225, 0.2902557003912557, 0.2982998490683465, 0.2983108095900525, 0.29222066064633145, 0.1971836204965436, 0.28265975606568006, 0.29814733984556463, 0.11688029036943204, 0.25966160083395196], [0.24554518739460773, -9.028210141113982, 0.20148863418923635, 0.18057329326410965, 0.18493469575039578, 0.19730349418453996, 0.13573893716203078, 0.28773764716303085, 0.11009253259800467, 0.25202497507958543], [0.12888309181847435, 0.17106642364257085, 0.14354407406915182, 0.21948972549172985, -2.866085001683973, -0.02711949273391312, 0.1165881558040609, -0.04548225265333716, -0.2978239275967818, -0.05692985164069331], [-0.029325053052584815, -0.03014305933929351, -0.09202319692929417, -0.07735421568907008, -0.031192135514548358, -0.05831166817793898, -23.280991294906233, -0.20375738479214722, -0.8924120726325806, -0.09055079384910258], [-112198.06659312532, -1.6426854499663617, -0.13769121968524334, -231.09764170933107, -41389.41294991291, -451.0318363592854, -0.3411953930905989, -1.483810411252437, -277075.13510746026, -8.663594340910661], [-0.2317213795239481, -0.3822814408184816, -112517.5427750996, -0.21150733824361811, -0.37397816175571763, -0.2484553000552978, -0.3605895972093711, -5232334.253380354, -0.32064953424051956, -1990273830.8017478]], 'MSE': [[0.098017458777566263, 0.092335850704844014, 0.08324422248892864, 0.092117085973010743, 0.10646131534400373, 0.089232183282615535, 0.087803203040941413, 0.11631349656664845, 0.10841212644832598, 0.087545939526284269], [0.10016349140853337, 0.098879145551571124, 0.096294000395330842, 0.09511078174544943, 0.094542180623779698, 0.094030405367261274, 0.086364396974819624, 0.095857142834106387, 0.090179159392203792, 0.0890591130658131], [0.095124905286982961, 0.096398287476660516, 0.10102301846897548, 0.094111191674630154, 0.091429833869522886, 0.089734226515352941, 0.10081295221318154, 0.093768756196583342, 0.099869632889374699, 0.092313239607705252], [0.096972644355898252, 0.1065156104515934, 0.091548177243386125, 0.098821367759107479, 0.097848449305247359, 0.097376824434570672, 0.10103631393845025, 0.093554680609926402, 0.095715868961424158, 0.10308588991813954], [0.094388397858087267, 0.097605548222686203, 0.099286217025424534, 0.1040164166189264, 0.10223016618551112, 0.095555066596025251, 0.10015662856835246, 0.094322068117805261, 0.098088428930495589, 0.1000353313033948], [0.099173741228986326, 0.10104818136556337, 0.099925712463274877, 0.099639063806858857, 0.095547605071697503, 0.10154297824477412, 0.097207460055301537, 0.09768988769308809, 0.10048013976329981, 0.098004375888515544], [0.10184611306884822, 0.09770964382364998, 0.10399400940870218, 0.09838722048192429, 0.099661564361382321, 0.10128152644592311, 0.10326690786442244, 0.09855983762065991, 0.10112232616289181, 0.10021487918689934], [0.10510666860238768, 0.1030675668617331, 0.10478800501753427, 0.10748079652295417, 0.098170644213973673, 0.10304108036417667, 0.10104833400259813, 0.10350536042297573, 0.1080614038944273, 0.10586712761070122], [0.11045264517416686, 0.10803770994197288, 0.10301739784011731, 0.10310823324138789, 0.10069837197651819, 0.10425481593466718, 0.09989181021355388, 0.10775544182898464, 0.10726781661853632, 0.16051579263593438], [0.1158652951643141, 0.11452678543426262, 0.1153001398176626, 0.11315365239723854, 0.11042345066439951, 0.11075190378278965, 0.10640768000285683, 0.10974125726116808, 0.16023440598766928, 0.11129834481338612], [0.11821366415347426, 0.11149548056254217, 0.11323124700022301, 0.11136857037964942, 0.11173033401118579, 0.12661416248148763, 0.11465786140927965, 0.11098473386784552, 0.1414588683313438, 0.11747031867229739], [0.12074925862417867, 1.5813185793372866, 0.12802270800103563, 0.13019088037206802, 0.12903732533297249, 0.12701220178763503, 0.13762459478060074, 0.11330687076099967, 0.14101648875764278, 0.11942299697340379], [0.1387403059613555, 0.13106364751639865, 0.13632501574336003, 0.12379138510845432, 0.61926590003239568, 0.16428657353985615, 0.13991738447839955, 0.16609694432877189, 0.20699450775141942, 0.16919325980843589], [0.16427951693167864, 0.16454439829106829, 0.1729759940540847, 0.1707542969565238, 0.16375367939206509, 0.16821419210682889, 3.8655243570453224, 0.1908761025196809, 0.30093771735170122, 0.17368654978791884], [17803.980093974977, 0.42279717955060941, 0.18016483693108748, 36.926406658175715, 6613.6242925097949, 71.554266973651224, 0.2121538691987257, 0.39635810781959019, 44043.575903622899, 1.5356187165243818], [0.19587277833386305, 0.2205364057619365, 17861.18133818459, 0.19278917354648037, 0.21808301990621867, 0.19836973200429694, 0.21690720568461544, 832967.16516099439, 0.20994931554260854, 315767435.38522333]], 'Rp': [[0.64608224534363212, 0.60355688562079934, 0.68519884734141923, 0.66576346839022094, 0.6312749415851151, 0.68083770124973175, 0.6713498960498645, 0.57605995479855399, 0.58464051564635611, 0.6707184320407753], [0.60635065040574099, 0.62031574478691953, 0.63290503465039105, 0.65061230827285821, 0.64825810383137694, 0.64950007002063914, 0.66142715886619818, 0.64272121887865985, 0.67474982143399143, 0.6690822949797689], [0.64777485238255372, 0.64094315193799234, 0.61361754438092031, 0.63621693868791174, 0.65080847618686266, 0.65838610364805372, 0.62610118994766317, 0.63443556031417303, 0.61846975605895604, 0.65777001953308611], [0.63672056645388919, 0.58943115845919725, 0.65297570102199354, 0.61886099072949108, 0.62461921237197615, 0.62867149300430381, 0.62141790740317315, 0.64540157321232294, 0.62556038259837166, 0.60830564734227965], [0.64179776348192397, 0.62698838417287606, 0.62203320814699792, 0.59886558877184171, 0.61020625063837175, 0.63778891117066538, 0.62364165816137307, 0.6408420531249408, 0.61826609052739212, 0.61416322981108418], [0.62181586076263984, 0.60770343383644898, 0.62326995427478393, 0.61909785357370384, 0.63869515516917652, 0.61806571665247012, 0.6319263767917821, 0.6304438631352578, 0.62727206574651939, 0.62958094532219477], [0.61967194796830505, 0.63102476473946156, 0.60360882067116306, 0.62773406983859281, 0.62665628197613155, 0.6116175214329157, 0.60396287393701187, 0.63049717797594051, 0.61692076045651367, 0.62204997703142917], [0.60241528438517122, 0.6131825874947473, 0.60354694503052098, 0.58969720478345666, 0.62817515156940107, 0.60382473028791073, 0.61510615660233137, 0.60684989558403624, 0.5838566745308158, 0.59730361427919343], [0.58356795038601161, 0.58473304376596746, 0.60992031117255807, 0.61043442282943572, 0.6123095030587935, 0.60354399816711635, 0.61974577458779012, 0.59609824713979243, 0.59064302829742998, 0.13347131640168688], [0.56526589815907335, 0.56915854137453525, 0.56190659288384615, 0.57537328013518974, 0.57646319839515558, 0.58733336366667999, 0.5972760197820518, 0.58485588074776684, 0.46243963112666608, 0.57940382029425908], [0.55830037054055071, 0.5840098178566977, 0.57847363672295926, 0.58062234992696982, 0.57621060605514918, 0.5399144751235484, 0.57163565291063956, 0.57998553017398724, 0.49703368770337769, 0.56887584946674818], [0.55582759288270067, 0.12834294639791219, 0.53144529688278042, 0.52839106048478923, 0.52298499218409034, 0.53455454508848554, 0.51709809990783118, 0.57483700253629011, 0.49642513296395013, 0.55367812072330913], [0.50080079089924545, 0.52687198517931699, 0.50936739824174748, 0.53993797785231401, 0.2372911739525172, 0.46354905689743781, 0.50376095818990485, 0.11522559283118851, 0.40644107347621744, 0.1068094927286298], [0.45133520878339428, 0.46958503658157136, 0.46584399004528187, 0.098923311569375214, 0.46009888940171001, 0.11708356172645859, 0.10398919443245709, 0.41927167679254351, 0.35566018169566543, 0.09001691289146195], [0.0059640943244579575, 0.29295700254299367, 0.082217252062042251, 0.035421659682794399, 0.027849054708801935, 0.039703968141947182, 0.059980216616062135, 0.30584099438789447, -0.014305471611951471, 0.17160769417376182], [0.082571247249587157, 0.065148389668763587, 0.017580194658985734, 0.076373247153259605, 0.061428444393879393, 0.077598777556341286, 0.054988874641809224, 0.034903108311462427, 0.054196944729325625, 0.024764304190341771]]} 
average_performances = {'R^2': [0.40318842682033684, 0.41204722810494615, 0.39993359025214403, 0.3817232465181557, 0.37842050596932963, 0.3793645493942951, 0.36936663164563105, 0.34610291126860737, 0.3058173756666574, 0.2646806387150415, 0.25895829558618905, -0.7232770744328442, -0.25138690554827103, -2.47860608748828, -43135.7013105382, -199561868.4727086], 'MSE': [0.096148288215316902, 0.094047981735886868, 0.095458604419896967, 0.098247582697774366, 0.0985684269426709, 0.099025914558136002, 0.10060440284253036, 0.10401369875134621, 0.11050000354058395, 0.11677029153257475, 0.11772252408693287, 0.27277019047278245, 0.19956749242688471, 0.55355468044368727, 6857.2408056449522, 31661826.518423013], 'Rp': [0.64154828880664683, 0.64559224061265452, 0.6384523593078173, 0.62519646325969991, 0.62345931380074671, 0.6247871225264976, 0.61937441960274653, 0.60439582445475837, 0.55444675958065825, 0.56594762265652232, 0.56350619764806287, 0.4943584790052139, 0.39100555002485199, 0.30318079639199197, 0.10072364650288043, 0.05495535325537558]}

repeats=20 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.2173858005628313, 0.3385017869224818, 0.29261892313464954, 0.4482096442008018, 0.2833742621542661, 0.3145252791338077, 0.3563011657506101, 0.4933291556927373, 0.266269701617033, 0.3410322200254279, 0.2733322652327942, 0.4539715737749638, 0.43927512558320814, 0.3727382795424796, 0.3504793930174901, 0.420181932011066, 0.42882232960711164, 0.4960403305491523, 0.5330722787650497, 0.5258813501152226], [0.44247711606268336, 0.4282191178724519, 0.34899564140285244, 0.4063266854633545, 0.4138533702228442, 0.40014420011696405, 0.4364765485993113, 0.42388357119387954, 0.4182188615839598, 0.3409685743031574, 0.38426220513960163, 0.43778015799442294, 0.42470198810428705, 0.41508872496683724, 0.36481136376280165, 0.41233219916831265, 0.3615216655548035, 0.38480426602481843, 0.37588573187885344, 0.40160904123257457], [0.40991691114804163, 0.3880986191572383, 0.4017907340978665, 0.37628519234747293, 0.40067166207820026, 0.3993619953411781, 0.4079655713893522, 0.4025166955585614, 0.41477638412254747, 0.4159794687569227, 0.38985854110677565, 0.3899507703225328, 0.3991046460812241, 0.35803941004669426, 0.40526690430527246, 0.37240159126269545, 0.39275003527828767, 0.39169231744475597, 0.4126942309849666, 0.398331900116651], [0.37333745977462784, 0.40282301639871876, 0.4010870235462869, 0.3943320715865415, 0.40367447058365014, 0.39413651375900927, 0.4165107384671175, 0.3926948512706445, 0.40951427303210153, 0.38722164391044556, 0.37927644649926795, 0.4021384350321714, 0.378090880335451, 0.4225024371916397, 0.39354962741597976, 0.39757050977460895, 0.3829999731687723, 0.4076646724731158, 0.36204001844869216, 0.3955169349411479], [0.38625524431332625, 0.40111000198380975, 0.3749461541871668, 0.3845759945543804, 0.40090352850895106, 0.4285004642057687, 0.35708433519862415, 0.41383731185190764, 0.41517470175569227, 0.4019496416167849, 0.4036351272159844, 0.37584466242412384, 0.38040956665147707, 0.3878855860627973, 0.3737442453207277, 0.3875508428974258, 0.40268354846190013, 0.38910357755776603, 0.3895908224028244, 0.3837331210659708], [0.40012566312789366, 0.37667330284494915, 0.3706190876242993, 0.38042077362206606, 0.3857279351712898, 0.3323662675330221, 0.3960096310669523, 0.32457831736868614, 0.38665843663708765, 0.3840935908209413, 0.38652703309384373, 0.3706802768424211, 0.3835357735086067, 0.3334929430938858, 0.3571458058472945, 0.38104754507493244, 0.36414810819144483, 0.3870897000246396, 0.35234103486232793, 0.38177281810956953], [0.3843387340693549, 0.36532636364371285, 0.358242926626282, 0.38589157677970765, 0.3715817666034872, 0.3953478976062724, 0.3661675865030519, 0.34307844436013046, 0.37145537339510293, 0.3690963483140258, 0.3219521855484976, 0.3784073379873707, 0.3733029681236527, 0.35076455785328564, 0.3816713188415103, 0.3702707257546929, 0.3291710910985709, 0.3574423239096406, 0.34252860578512534, 0.3690803382444633], [0.36096137542571305, 0.34646321775800315, -0.00017610183944349878, 0.32814627742612634, 0.33785719231168965, 0.34035750327449243, 0.3449297127583395, 0.34049285526269557, 0.376207585364152, 0.36133324679956735, 0.3555922140067789, 0.3513282906672265, 0.37019038475934174, 0.369224203666091, 0.31981448451114713, 0.3592910752074727, 0.3724507300224795, 0.3541780577725797, 0.3405513684822856, 0.33626762590198866], [0.3453314934759413, 0.3133577121471254, 0.29131029156263466, 0.34010874235213284, 0.3308024987806817, 0.2991664774916263, 0.3313551456516691, 0.2221152181910182, 0.33329798910879627, 0.3105914752376181, 0.3463171700502895, 0.3143978719692937, 0.3526348399242315, 0.33477087450382925, 0.3273169813180066, 0.3097048357779818, 0.3141398257933907, 0.3236027861674188, 0.30682224643661204, 0.3469111254596716], [0.33323955495161683, 0.24038242711995328, 0.3233578172546663, 0.3073716104435389, 0.30844035388056723, 0.31073157305928256, 0.24528839381822953, 0.28467351888836556, 0.3463478371765397, 0.296410279477601, 0.2922688429094681, 0.27770343315112334, 0.3566559583675516, 0.25988729176561376, 0.2819572044278388, 0.27854759616030056, 0.3058983360699197, 0.28077236967031927, 0.3168957307017177, 0.2389608162217718], [0.3061135763138445, 0.30280019803839353, 0.29198285749834463, 0.29151397046180383, 0.23031351705534397, 0.22961124482232387, 0.09029928898587347, 0.24293546210912753, 0.3092601973669732, -0.0689153821326125, 0.3135764262738796, 0.21638571263248985, 0.3059820138694903, 0.26668068108732823, 0.24613607837090545, 0.20679380523043833, 0.2688715557285508, 0.23371332075638984, 0.2502058298863292, 0.2902295469857573], [0.21077357757514703, 0.21466340406188356, 0.2149553185319215, 0.22112267514252093, 0.1304690012148627, 0.2553243828289873, 0.21754106609357682, 0.20627128294869768, 0.2128179989973401, 0.2207334083595146, 0.1904288993931843, 0.2354779885259639, -0.631620550606655, 0.1514287802065022, -0.028270462590930245, 0.23673101957996023, 0.15840050583309695, 0.26066218006683306, 0.26488232770587805, 0.030829108439455077], [0.07282826817615307, -0.15401086429576805, 0.1473116310838134, 0.1871817285632441, 0.17128380060579962, 0.0556520739216535, 0.15696335143947981, -0.06761890971581863, -416989.10851443454, -0.032789493893465194, -0.2733320532144623, -6673.32523850513, 0.16987958082629728, 0.15212861666242383, 0.2168196089337655, 0.10679924723727574, 0.13446008122994413, -0.27960984649297527, 0.07568584676490697, 0.23303017901744716], [-3850.7478686587588, -0.6177772699872404, -0.07450279361374013, 0.023820451708033263, 0.08098084379199699, -10.122147549690327, 0.010394231459646686, 0.07347185454100791, 0.049804463914716046, -0.0735529411594007, -0.4793890382988224, 0.08096194328611295, -0.10969419200683439, 0.006499558886680523, -0.1179274526630194, -0.00645894707570438, -21502.985500646824, -59371.454628441235, 0.05739715442189941, -20.414861875753125], [-37199.540377280944, -0.43659814393845076, -0.13145952404767192, -1.1119883423062835, -1.423846457524626, -36795.91494800891, -39258.20883589117, -0.13680853793815673, -5.308481223686062, -0.10414381340416101, -2.601186458515844, -3.4844452602581013, -9703.202679971286, -0.22418766502395404, -5698.248922103835, -20783.79610606716, -1.5011940197954683, -0.1322011765981843, -1.1107305732480026, -0.1327306323624362], [-0.21895121589281885, -0.29794614333105085, -0.22297207172932687, -0.34600366579078745, -0.24377882479827107, -0.2788444759691189, -0.3737390277057293, -2605.8441708402515, -0.6329363003323878, -0.29338481939027994, -1111628.3652054253, -0.30494874781834325, -0.23399413562934934, -0.30712528037210274, -0.2417175178694293, -0.5050072962193084, -41849.04196195807, -154.24521493955132, -0.22731198799786867, -0.31103168157046013]], 'MSE': [[0.11785682679198438, 0.097959254377796318, 0.11907977630516346, 0.084548785973499713, 0.1176035948731675, 0.11624978940217633, 0.11326859338613728, 0.077683483199181461, 0.12045969755087189, 0.094377155775430391, 0.098500449813189839, 0.091763276080583156, 0.093863231002629, 0.10796901344224197, 0.094037836101398042, 0.096477637119253487, 0.098397976529325443, 0.082917880329156771, 0.080598334807985283, 0.073755640921495974], [0.093255969902218142, 0.089474324468261299, 0.10597878932473444, 0.095123000862636059, 0.095923298869914825, 0.095298320450646928, 0.087796513311589511, 0.087256855992773677, 0.09173305696884454, 0.09977789519525633, 0.10310464717429252, 0.09297394877361391, 0.092417319064448528, 0.096093047706459073, 0.10144004988003048, 0.094606948430363658, 0.1012258176787134, 0.095940809911102806, 0.10035244894423494, 0.096674470613622124], [0.094518446934594547, 0.098961269488850284, 0.097884534572720575, 0.10227797591957957, 0.095211758231810467, 0.093719498714863431, 0.093414526067432738, 0.094399682031626048, 0.09195636151109321, 0.092805393363003849, 0.099621872007135598, 0.094283577954682285, 0.093347191726479289, 0.10159689940216753, 0.091318195493648543, 0.1006865890993045, 0.096669807648187667, 0.09653430435927314, 0.094956368824405668, 0.096007004182627809], [0.099171088786818878, 0.096281326808195455, 0.097043622563408941, 0.095329662538804275, 0.09414548598966832, 0.095440503342411026, 0.092115753727361624, 0.09472201381759511, 0.0944106726846832, 0.099578179894955668, 0.10003074062778307, 0.09540332466165867, 0.097424340994500133, 0.092258465654473362, 0.096894213957828393, 0.096961455068413957, 0.099085997051979027, 0.095480385518894581, 0.098983040796525437, 0.096917553711118112], [0.097801688168377837, 0.098473801905553771, 0.099432987041595061, 0.096616586235761512, 0.094870522173029034, 0.091747668050526379, 0.10210571173592337, 0.093398068582896634, 0.097535377778933952, 0.092214776657150541, 0.094071277709611281, 0.098071400806268652, 0.09837656813395472, 0.096519891690496101, 0.10019782032014453, 0.099972613994199808, 0.0955080630313941, 0.097606246425264095, 0.096577088638650957, 0.09575379968877519], [0.095550235468601877, 0.098193451056371908, 0.099491123690322744, 0.10039607039447443, 0.095648601062690658, 0.10421031710847121, 0.094853449606176879, 0.10813911256309169, 0.096734569523247341, 0.096827180061336893, 0.097625184737550483, 0.09956189189741986, 0.098576761383334266, 0.10409615831186987, 0.10053183589124065, 0.098728332326953439, 0.10126791127983673, 0.098947272742374928, 0.1041408561732137, 0.099072130096979405], [0.097746018621977154, 0.10109921332329531, 0.10051826421692413, 0.098313182368775606, 0.10050687841149451, 0.096521872438882078, 0.10095351700861671, 0.10523046648402841, 0.098644716743305577, 0.099356072693552233, 0.10488061957472734, 0.098990162406152951, 0.099533444795071188, 0.10261419765632508, 0.098265061800911477, 0.10074011892757412, 0.10540247496381906, 0.10274970767701243, 0.10314882044127426, 0.099776020255662234], [0.10185371959808429, 0.10388944740806288, 0.15941905519703881, 0.10831290564339185, 0.10599397833304304, 0.10380368229357675, 0.10619243187100846, 0.10369304179488401, 0.099423143439536246, 0.10196650852550199, 0.10315552541005064, 0.10316921868094982, 0.099881628294690536, 0.10145489160804566, 0.10898224474613415, 0.10206936267845042, 0.099102819267733941, 0.10240526958491671, 0.10419643712887221, 0.10468700652362667], [0.10352232536557815, 0.10841551826569738, 0.11302640362513093, 0.10627008900635607, 0.10562831016314263, 0.11171759424959359, 0.105871804639197, 0.12339068440587356, 0.1062019326556478, 0.10892570575000443, 0.10519805236314636, 0.10962599742500702, 0.10316430365895464, 0.10601450852926339, 0.10599215540022112, 0.11152030686718886, 0.10839525962050292, 0.10722197257650207, 0.1105934613786469, 0.10356754557611926], [0.1065629372405222, 0.12119478975991994, 0.10830445480810759, 0.11248159527755271, 0.11043698862019626, 0.10905441799060547, 0.12022510063785397, 0.11317583059591692, 0.10212307348846456, 0.11117288405395906, 0.11062350285599083, 0.11334924855265967, 0.10283136600295689, 0.11722641308941718, 0.11606952113120469, 0.11581399720884529, 0.10955753216623643, 0.11467776721422093, 0.10949256814259314, 0.12004162845822088], [0.11095665029079579, 0.1111124861179317, 0.11275908563699656, 0.11387801111469711, 0.12213061948059885, 0.12211525324303828, 0.14422081680534588, 0.1203189793859792, 0.10950167057056916, 0.17057832184449392, 0.10940559492220539, 0.12300692505899571, 0.10978645626337334, 0.11670616926102095, 0.12049449015714157, 0.12527073832779209, 0.11756867751284593, 0.12248646634660794, 0.1187103724962717, 0.11296890107866686], [0.12579630312840137, 0.12541842300162148, 0.12529568930237328, 0.12226669509192539, 0.13934680561928067, 0.11863673520328802, 0.124760632980737, 0.12539019308510763, 0.12524199592762142, 0.12370425634932776, 0.12897319803685756, 0.12217735243257843, 0.25896585078416895, 0.13628332385373357, 0.16437585767411553, 0.12188072696512983, 0.13373148549914504, 0.11761476155145834, 0.11622110982784009, 0.15503934690164403], [0.14696519412597861, 0.18372963419854843, 0.13495729306228313, 0.1284952943249798, 0.13217601829946557, 0.14995155331611562, 0.1348051356246798, 0.16975100322365236, 66652.345556287139, 0.16512972492868866, 0.20233294552976111, 1063.5142812878648, 0.13270098436894937, 0.13391914818987735, 0.12550185667396774, 0.1415268195561746, 0.13802355941008634, 0.20444447969220753, 0.14671032672046658, 0.12189940251206391], [611.09684193837859, 0.2578561017419651, 0.17010961775491917, 0.15587103407926831, 0.14750187887383107, 1.7646025033984063, 0.15689268065644174, 0.14771802044513238, 0.15099664489693471, 0.17085859633567482, 0.23597986829416412, 0.14597488734499262, 0.17740250236994823, 0.15730482602160406, 0.17850397308671412, 0.16121912715133993, 3444.4658972034122, 9440.6108445565496, 0.15000211641149133, 3.3822333237115378], [5921.9244312098754, 0.22784365482561933, 0.18055032653363426, 0.33481770678714451, 0.38780332566226627, 5871.0162808283721, 6244.1688514807811, 0.18057457134434748, 1.0014402775175495, 0.17586910519486987, 0.57177572400878229, 0.71508888232602408, 1535.4071551614027, 0.19440530704375117, 906.72476310125535, 3324.2015555140592, 0.39918286817844573, 0.18060708451784924, 0.33454405844713192, 0.18015806449315233], [0.19385358124783264, 0.20671185282821944, 0.1942235235461004, 0.213548278043624, 0.19781724882821569, 0.20257496072406783, 0.21797620911417923, 414.22251643705073, 0.25955428021839638, 0.20601990773309359, 177393.64827152583, 0.20773776814403011, 0.19623420396899011, 0.20760628986697455, 0.19822104313341818, 0.23910502557817642, 6665.8443173739406, 24.776914255072985, 0.19517970844752139, 0.20882385612559376]], 'Rp': [[0.49659235290839027, 0.59166817365809821, 0.57799847785275749, 0.67196947930073159, 0.542699225146276, 0.57400850362718825, 0.60636380633377884, 0.70265236773033335, 0.54159886730129025, 0.59056375793887805, 0.5588334713200046, 0.67629896396075828, 0.67202448767561829, 0.61358972661056743, 0.61236575584097841, 0.65006286793622259, 0.65795419592472981, 0.70473028961856721, 0.73011912526833034, 0.72587747518313739], [0.66850550010224286, 0.65649431329597208, 0.60244380204381487, 0.64005649688659538, 0.64887668863582915, 0.63512844440020111, 0.66154616940105049, 0.65753178826977965, 0.65042380959804424, 0.60168927783783244, 0.62388652188763116, 0.66349438710107378, 0.6543665689199889, 0.6469665107652337, 0.61151215339608334, 0.64786348100233382, 0.61568262252193007, 0.62674137424337606, 0.61796090906775902, 0.6371820742417732], [0.6450003329067111, 0.6284720481430649, 0.64010485652539328, 0.62137587453879273, 0.6386251658112051, 0.63951569449664636, 0.6439836005824654, 0.63864791475730531, 0.64653391083837985, 0.65044536989232293, 0.63054785926539447, 0.63109156015260492, 0.63625401404373505, 0.60606160295925238, 0.64224190232442335, 0.61647086087247027, 0.63164066729337598, 0.63162770765912879, 0.64608634060252268, 0.63686089917620314], [0.62014924171613184, 0.63918099822677787, 0.63933897514917237, 0.6336937603665086, 0.643452752456525, 0.63349989709856147, 0.64819715034248082, 0.63255874208350993, 0.6431836248470163, 0.63078265835461111, 0.62415389271964505, 0.63965205382956825, 0.62269133535241017, 0.65307649394758427, 0.63235760311218137, 0.63630604221718823, 0.62569064879906933, 0.64375377976683035, 0.61389414526783492, 0.63456125042418809], [0.62884217928654829, 0.63861772692044194, 0.62222338969928059, 0.62676689253002338, 0.63982621680089047, 0.6570626933296293, 0.60742178639093958, 0.64781280641260575, 0.64831528570505847, 0.64023876318078254, 0.64133737194003537, 0.62262990805701135, 0.62406037710350026, 0.63220017827201591, 0.62025386687446993, 0.62871198006462459, 0.63942757673462203, 0.63203609475798406, 0.63260971715607672, 0.62900235012778305], [0.64035692791838739, 0.62418152512613923, 0.61925782301836518, 0.6254950812274106, 0.62803570075592574, 0.59487410714518008, 0.63426935203586765, 0.58841819562048736, 0.62919151265272122, 0.63061121529857278, 0.63106434879378925, 0.62085650058286068, 0.62646628807238025, 0.60084795290422988, 0.61076624874597607, 0.62625021889270482, 0.61478129949107818, 0.62762940146079393, 0.60843742974223225, 0.62581475220693905], [0.62870709394623248, 0.61673257042968377, 0.61280976809044929, 0.63015627254788387, 0.62050771236507152, 0.63530132029857833, 0.6174555925212879, 0.6043215808681438, 0.62229498495484026, 0.61819220974730693, 0.59501420306056618, 0.62544946400431822, 0.62235459954446415, 0.607089330277374, 0.62724545050863956, 0.6177633385330078, 0.59561517947813625, 0.61235258474739107, 0.60457207714246686, 0.61969362176759013], [0.61464123059265363, 0.60427177507867735, 0.14297666677277324, 0.59439792699256899, 0.60003830218379917, 0.60300552854556388, 0.60354145332002096, 0.60319094114462624, 0.62189785954923338, 0.61435972794060711, 0.60808880053230741, 0.60821297618408521, 0.61976629600766575, 0.6170315922184515, 0.59039849992803373, 0.61234316188440185, 0.6204725978386143, 0.60935088979064334, 0.59989372906846383, 0.60321042947791359], [0.60558213105685466, 0.58910457206471101, 0.57866295879534158, 0.6015122320518147, 0.59242327569488573, 0.5868054829832321, 0.59704677568716069, 0.54109287263535788, 0.5984539534147888, 0.58576705866543222, 0.60560882368854563, 0.58630531451849199, 0.60646747016147196, 0.5946953734063799, 0.59401869120120154, 0.58635283538975214, 0.59149132984450548, 0.58966916000508052, 0.58257419140939792, 0.606530772943501], [0.60012746497687397, 0.55545907191951172, 0.59053918058648447, 0.57770661358288034, 0.58168906452702063, 0.58554975154786348, 0.55209782904301852, 0.57374581898070343, 0.60602933437158868, 0.58411631833774091, 0.57219095880757365, 0.57170938493103496, 0.61329431223911413, 0.55926637256479372, 0.57671308984532876, 0.56597473701148793, 0.58279343406803497, 0.56627880347547399, 0.59251287832233335, 0.55083052916054243], [0.58687505750926328, 0.58256084759454252, 0.57736388280595441, 0.57301331469366246, 0.54797331613136835, 0.55266056839229571, 0.49008383537167638, 0.55473942324335923, 0.58318636755314635, 0.44432381835117585, 0.59078052612392662, 0.54159124418435223, 0.58484294143051885, 0.5593667909528901, 0.55249562849465095, 0.53881147780944283, 0.56577463519413851, 0.55466142825978648, 0.55583182671585984, 0.57652778820091188], [0.53759025265537508, 0.54120465751576186, 0.53512290534673612, 0.54110346752178162, 0.51391339918188361, 0.56531396644940457, 0.53197482434469134, 0.53208243119115428, 0.53069081521193917, 0.54104816289580016, 0.53169423305495001, 0.54277819925497794, 0.35213348886176277, 0.51058338953066207, 0.11855593849387229, 0.54816801622661349, 0.5147046130731473, 0.56943243147656808, 0.56200779591151961, 0.47678832405878757], [0.47846062670526796, 0.43136536203324333, 0.51708176891225277, 0.53490525424887481, 0.51778256789781574, 0.48393564031316522, 0.51976470648705997, 0.10313757990421549, 0.003205296181131126, 0.1194313945379023, 0.39793476028000213, 0.020011397145867332, 0.51129871126819837, 0.52181038311603856, 0.54010995634147907, 0.51247456573427286, 0.50015912774740279, 0.41553101651345153, 0.4869572591022171, 0.55313649878755566], [0.0083159509157752255, 0.35119356927102169, 0.10354388205156559, 0.47708171275024369, 0.48330707124307032, 0.12078832711557237, 0.48563166478845982, 0.48842171598542283, 0.48305192123579827, 0.44119306168360733, 0.38454394173616535, 0.49865899696061233, 0.44731140092759414, 0.46524124484446172, 0.44195292358607763, 0.46142235582610669, 0.021971667671110934, 0.014822133048311986, 0.477266990861689, 0.1034951164880744], [-0.0034347627289571993, 0.053520628030601515, 0.087579898347555571, 0.30373527766946079, 0.29857493365272275, 0.054346228781421237, 0.011851544123755695, 0.083028485769125873, 0.19272003458796824, 0.093343872692937743, 0.26854593631781137, 0.22697075574657821, 0.0096402031434619003, 0.068318971697035796, 0.03644017678452835, 0.010267819388602295, 0.27894856687189901, 0.41641545832375959, 0.31385737199404479, 0.09758636026198815], [0.07707819939832887, 0.054426316513336077, 0.078552114271942211, 0.068604008485331644, 0.047841278121765231, 0.076190146615206317, 0.069315049040904297, 0.033257637424229373, 0.064104231488875674, 0.076542099298556016, 0.014614681406652882, 0.057109228155501353, 0.061808748576804018, 0.078015886058086514, 0.074335338589441066, 0.036226645280482785, -0.0014045711114401914, 0.082971983241749842, 0.081452586663051038, 0.046453821101855544]]} 
average_performances = {'R^2': [0.38226713986965927, 0.4011180515324386, 0.39637267904736184, 0.39483409988049956, 0.3919259239118704, 0.3717527022233077, 0.364255923552397, 0.3332730649769364, 0.3197027800699984, 0.2942895472757992, 0.2412244950670487, 0.14868109561538703, -21183.06805450464, -4237.841048965252, -7472.837593557599, -57812.12681231778], 'MSE': [0.098868411689133393, 0.095822376676187856, 0.096008562876674336, 0.096383891409853872, 0.096842597938425382, 0.099629622268777959, 0.10074954154046911, 0.10618261590137996, 0.10821319657608872, 0.11222078086477225, 0.1206988342957684, 0.13555603716081779, 3385.9276428974381, 675.19423057004576, 1190.4253849126312, 9225.0918603664722], 'Rp': [0.6248985685568319, 0.63841764468092732, 0.63507940914206984, 0.6345087523038897, 0.63296985806721617, 0.62038029408460216, 0.61668144774167177, 0.58455451925255519, 0.59100826378089533, 0.57793124741497015, 0.55567323595064599, 0.5048445656128695, 0.40842469366287071, 0.33796078244953709, 0.14511288807281508, 0.058874771431033035]}
'''