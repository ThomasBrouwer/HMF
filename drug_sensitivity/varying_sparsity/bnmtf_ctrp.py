"""
Test the performance of BNMTF for recovering the CTRP dataset, where we vary 
the fraction of entries that are missing.
We repeat this 10 times per fraction and average that.
"""

project_location = "/home/tab43/Documents/Projects/libraries/"
import sys
sys.path.append(project_location)

from HMF.code.models.bnmtf_gibbs import bnmtf_gibbs
from HMF.code.generate_mask.mask import try_generate_M_from_M
from HMF.drug_sensitivity.load_dataset import load_data_without_empty

import numpy, matplotlib.pyplot as plt, random

''' Settings '''
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]
repeats = 20
iterations, burn_in, thinning = 1000, 900, 2

init_S = 'random'
init_FG = 'kmeans'
K, L = 3,3

alpha, beta = 1., 1.
lambdaF = 1.
lambdaS = 1.
lambdaG = 1.
priors = { 'alpha':alpha, 'beta':beta, 'lambdaF':lambdaF, 'lambdaS':lambdaS, 'lambdaG':lambdaG }

metrics = ['MSE', 'R^2', 'Rp']

''' Load data '''
location = project_location+"DI_MMTF/data/datasets_drug_sensitivity/overlap/"
location_data = location+"data_row_01/"
R, M_original, _, _ = load_data_without_empty(location_data+"ctrp_ec50_row_01.txt")

#''' Seed all of the methods the same '''
#numpy.random.seed(0)
#random.seed(0)

''' Generate matrices M - one list of (M_train,M_test)'s for each fraction '''
M_attempts = 10000
all_Ms_train_test = [ 
    [try_generate_M_from_M(M=M_original,fraction=fraction,attempts=M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]

''' Make sure each M has no empty rows or columns '''
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms_train_test,fraction in zip(all_Ms_train_test,fractions_unknown):
    for (M_train,M_test) in Ms_train_test:
        check_empty_rows_columns(M_train,fraction)

''' Run the method on each of the M's for each fraction '''
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms_train_test) in zip(fractions_unknown,all_Ms_train_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for repeat,(M_train,M_test) in zip(range(0,repeats),Ms_train_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
    
        BNMTF = bnmtf_gibbs(R,M_train,K,L,priors)
        BNMTF.initialise(init_FG=init_FG,init_S=init_S)
        BNMTF.run(iterations)
    
        # Measure the performances
        performances = BNMTF.predict(M_test,burn_in,thinning)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
 
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)

'''
200 iterations
repeats=10 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.4132616525416556, 0.3216617924459404, 0.4933000309890492, 0.45101045317931576, 0.44607795207607026, 0.44983599341873715, 0.4370501212356672, 0.33822371840499355, 0.4011141183566842, 0.46956462385517395], [0.3791466677237436, 0.39093112614218817, 0.3973621919002466, 0.4328470542750549, 0.4282952586666984, 0.44919765308100223, 0.44307559404567487, 0.42369544583766117, 0.4374277159155505, 0.4664704883077748], [0.43979074135439267, 0.4061555276954669, 0.3691695039533892, 0.41581019595470337, 0.4421362622691529, 0.4263277210615384, 0.3855833166841016, 0.39998349881046924, 0.3915433017670217, 0.44735649998654115], [0.4004723576209265, 0.3662106195593351, 0.44422273243047183, 0.38620079172244526, 0.39138062886854863, 0.3962060985556527, 0.4102308649417432, 0.44035769253310064, 0.41112185317946326, 0.37642894475047906], [0.42416587692308816, 0.4008225813931805, 0.3954926927432133, 0.378052044827324, 0.40269991871379685, 0.4282144966085867, 0.40271459835758416, 0.418768395127293, 0.3985681556132066, 0.40572570750558534], [0.40850659653778987, 0.3830004864504323, 0.41612209459001404, 0.3839598104995495, 0.409167709178585, 0.4001765777196048, 0.41270852121278534, 0.41509184446787184, 0.4176835861974648, 0.4078717611494238], [0.38380385119984317, 0.4155310628260017, 0.3890746604215358, 0.41067043967706496, 0.41561909959815113, 0.38112672474668174, 0.4019493969746514, 0.39859216751235005, 0.4019557364560251, 0.4014067402215493], [0.378871734926, 0.3795108667412723, 0.4171727349724911, 0.3873919731630019, 0.4075990596797836, 0.3952306680951354, 0.396568808067701, 0.38521911582243484, 0.3651873820594246, 0.3939730231717953], [0.3746858186484938, 0.3639015476271028, 0.40120550343651384, 0.3707606262629374, 0.38514779197311066, 0.38166623662949273, 0.4002437690097622, 0.36650341372182527, 0.3763040654081199, 0.37710303990942184], [0.36744587995075007, 0.35466018215088047, 0.3584185620628435, 0.3634129391137002, 0.366164342765678, 0.3702843435913663, 0.3648972298368933, 0.3620136409000724, 0.36645581167876473, 0.35028496411183874], [0.3390861685135994, 0.3571367822060898, 0.3439655689222877, 0.37514828815427037, 0.3577207995463437, 0.3416424778812861, 0.3409276845930572, 0.371453992812004, 0.33843745201125364, 0.3676847441222748], [0.3617616030435429, 0.35189094956256617, 0.3388516267660745, 0.34547134973194216, 0.3245763151753883, 0.35246847255794855, 0.36780260824969857, 0.3824871844458817, 0.30761516541233236, 0.32455930101569397], [0.29934167670489065, 0.3223871116810929, 0.33493376217352844, 0.3125144466795968, 0.30543722787241856, 0.3104879800926533, 0.32664035445394657, 0.31753613644669654, 0.31458966109640163, 0.30492399577974594], [0.30983678057250763, 0.29060189483530185, 0.31349809753138225, 0.30544218050574223, 0.26933494498749844, 0.29605698445584716, 0.2907334287091077, 0.27240990233983065, 0.30823001393673555, 0.26728880493910323], [0.25227331070046743, 0.2852793445327588, 0.27721976121133407, 0.20644548770436266, 0.2745194800521803, 0.2257732718732004, 0.25116929498764173, 0.2848511033672638, 0.22332082837684109, 0.19991750320818413], [0.1896083947071433, 0.1402458419660293, 0.20004087920449876, 0.19596398688550998, 0.17088517975386353, 0.2674178988442717, 0.20837775350845256, 0.17384828628899207, 0.19853651866594446, 0.24459664814167326]], 'MSE': [[0.097327467589591224, 0.097145284901661258, 0.079375147907430749, 0.090199133066115447, 0.095436799099386904, 0.090750815331727547, 0.088781991448673436, 0.11251442420145846, 0.096089774300989486, 0.082192587686272661], [0.096343689268789431, 0.096984810909262073, 0.095891662475473621, 0.093046331427389911, 0.092547248198513135, 0.088430973895677986, 0.084561009825728381, 0.093524244298124504, 0.092922043178507746, 0.085917934923151251], [0.090605559482045961, 0.096103896017280782, 0.10015183176667475, 0.091670431805426694, 0.087825107920041945, 0.090346088519864406, 0.099635629706699147, 0.093053259987948958, 0.096189867708630541, 0.089158467042283418], [0.096401639812239953, 0.10108454800207112, 0.087774709516491176, 0.096814854871753772, 0.096263379487223175, 0.095975923254470047, 0.095354626761176911, 0.088960545184587403, 0.091411454034669257, 0.099762035095916593], [0.091109165400093992, 0.095332388083804231, 0.096591936453685773, 0.09782667880496583, 0.094713483571603335, 0.090958336338034906, 0.096690002986772189, 0.0918208507345879, 0.093935174675147406, 0.093777786023144238], [0.093522617516059711, 0.096999693140413623, 0.093510449821793504, 0.097040418649666699, 0.094004179260966894, 0.096854556445124695, 0.093335390403068638, 0.093530283727573535, 0.09507233650299797, 0.094746416434261349], [0.099097557606289799, 0.093366141918195422, 0.097334513690536945, 0.094118461165258002, 0.094030371604020391, 0.097633523797412067, 0.093781083361182738, 0.096994822042228299, 0.095153272300514277, 0.095824953499104831], [0.099225700798841493, 0.09922451631593554, 0.093561474729543431, 0.096701436410453812, 0.094330061786492697, 0.095920432462878277, 0.095950727679990383, 0.097456479297579626, 0.10032282272477841, 0.096557428089564995], [0.099565329905278721, 0.10115540022920938, 0.096116014633824631, 0.10081331123285303, 0.096674467069155515, 0.098523009185588414, 0.095145049403074389, 0.10235645921686649, 0.097976577786177396, 0.099071074189670885], [0.10103856668463888, 0.10217615603315594, 0.10041756393713705, 0.1015292621380038, 0.10028906169567091, 0.10125441244986784, 0.1003010685100585, 0.1007708609377841, 0.10107103750898504, 0.10349293171938985], [0.10500698246224346, 0.10098896665098507, 0.10586230686623656, 0.09917331319708618, 0.10139045547819495, 0.10383119777402294, 0.1053444621818002, 0.099392672125951487, 0.10596965320594756, 0.10033016616858208], [0.10214901140578347, 0.10219838520251766, 0.10599974997969606, 0.1039918036679333, 0.10692991751936767, 0.102460150793572, 0.10067086624877801, 0.098234091001109941, 0.10971666360732829, 0.10784203999204274], [0.11159185321205708, 0.10713815832802474, 0.10586086522027455, 0.1090373716620217, 0.11125441888195241, 0.11028664918393181, 0.10664869509855626, 0.10842380352543213, 0.10931850822923271, 0.11126772016713384], [0.11014953921049504, 0.11331191653906318, 0.1087415993849242, 0.11008332304853237, 0.11602987168031474, 0.11188878400336712, 0.11291496190018112, 0.1153717217670631, 0.11000758426186381, 0.11669523343515072], [0.11865081855180405, 0.11434651721488792, 0.11445951379883142, 0.12625340098524976, 0.11592190675352111, 0.1225560271345333, 0.11845204081494319, 0.11412105456780397, 0.12345966943302621, 0.12713920033208786], [0.12887139730293604, 0.13716967200212207, 0.12698542451107131, 0.12794758527395667, 0.13160024582721622, 0.11640153641942153, 0.12620158922017427, 0.13152009908351558, 0.12741208396007059, 0.11984872397270487]], 'Rp': [[0.64608640909334047, 0.57645475054651063, 0.70428584619486567, 0.67170460522298625, 0.67406814078948851, 0.6721299519031011, 0.66222490554225977, 0.59352143663064438, 0.63412402393588752, 0.68701946248330903], [0.6180930449508375, 0.62653769385334712, 0.63112213059404476, 0.65801320732077828, 0.65523848712997179, 0.67050372431533367, 0.66904374385219989, 0.65106879683386598, 0.66203679341354227, 0.68363577153056154], [0.66352471567057725, 0.6384209624807996, 0.61267188237543124, 0.64515866994761639, 0.665042317460806, 0.65351491052640687, 0.62556655042045961, 0.63421116057589932, 0.62883849937536718, 0.66904396382067222], [0.6343194441436194, 0.60838158807668252, 0.66662946742369689, 0.62383170886824735, 0.62731131220781267, 0.63132796732603336, 0.64149544292562832, 0.66366545622722994, 0.64258061281553447, 0.61749566796179856], [0.65252648775746036, 0.63418326252084278, 0.62996084390864382, 0.61893290560972092, 0.63656647474338846, 0.65454356499619126, 0.63605807498786826, 0.64751617356590485, 0.63323354488125727, 0.63761152589525727], [0.64002554423724811, 0.62099271270732692, 0.64552324231249569, 0.62389248557382104, 0.64165624959795453, 0.63412252504516275, 0.6442597110920889, 0.64498255867372623, 0.64672098074049078, 0.63961326219142867], [0.62213372535652289, 0.64549079834212564, 0.62658536373642759, 0.64175418083950353, 0.64565129156466106, 0.62126762919143619, 0.63559839097043802, 0.63283746116270245, 0.63553119366135213, 0.63505545648660078], [0.61882612356968192, 0.62126439089669827, 0.64595998590327308, 0.62520679888898245, 0.63908439740948852, 0.63009957418223062, 0.63061837652320563, 0.62373299480734556, 0.60805235076821107, 0.62937238139223417], [0.61554623611977732, 0.60634952944560905, 0.63504293179061277, 0.61298209433446893, 0.62255481415893799, 0.6196143477638838, 0.63374332420887081, 0.60981582689054015, 0.61785997984621543, 0.61786451995844283], [0.61187740885523478, 0.60497072446495959, 0.60485988493740495, 0.60732629970514485, 0.60929949557155128, 0.61348640083184292, 0.60914449096783962, 0.60730838404152843, 0.6087585509093083, 0.59753216006382892], [0.59185345169443082, 0.60707111873423503, 0.59388767041924073, 0.61547573912919551, 0.60205325816582145, 0.59412787960050562, 0.59342915091909065, 0.6140829054027932, 0.59098859174072138, 0.61129658342547288], [0.60596489970995637, 0.59973966918402033, 0.59158390508406389, 0.59582979708283534, 0.57990025084729335, 0.59813870718843454, 0.61065668562521824, 0.62028853437618903, 0.57189109356541534, 0.57784104242918222], [0.56353624267517854, 0.58289294868417696, 0.58862744553586788, 0.5723605058186686, 0.56545173570969132, 0.57295212614019964, 0.58345431063639575, 0.57961186552141075, 0.57496775681207579, 0.56633939677360801], [0.57370339562503325, 0.557676534883361, 0.57707914501096569, 0.56978396872855674, 0.55032332450744581, 0.56293425355617754, 0.56243283846962533, 0.55276116482113069, 0.57080015360484593, 0.54000790071994631], [0.5424154174111715, 0.5517444379029055, 0.54883367958592211, 0.52039083477004755, 0.54643869479917184, 0.52734087825506637, 0.53331681504854844, 0.55709807393985766, 0.52552219737836781, 0.51884063466209018], [0.50544418515911538, 0.48607948884633723, 0.51241763955151576, 0.50675612131521064, 0.50749678184212632, 0.5430767594299275, 0.50753807149238661, 0.4961805346824219, 0.51339614517775134, 0.53284934158416131]]} 
average_performances = {'R^2': [0.4221100456503287, 0.4248449195895595, 0.4123856569536777, 0.4022832584162166, 0.40552244678128585, 0.40542889880035216, 0.3999729879633855, 0.390672536669904, 0.3797521812626781, 0.3624037896162788, 0.35332039587624664, 0.34574845759610695, 0.31487923529809714, 0.2923433032813057, 0.24807693860142344, 0.1989521387966379], 'MSE': [0.092981342553330723, 0.092016994840061803, 0.093474013995689664, 0.094980371602059938, 0.094275580307183984, 0.094861634190192667, 0.095733470098474285, 0.096925108029605869, 0.09873966928516989, 0.1012340921614692, 0.10272901761110505, 0.1040192679418129, 0.10908280435086173, 0.11251945352309553, 0.11953601495866888, 0.12739583575731889], 'Rp': [0.65216195323423942, 0.65252933937944824, 0.64359936326540357, 0.63570386679762847, 0.63811328588665361, 0.6381789272171744, 0.63419054913117701, 0.62722173743413512, 0.61913736045173584, 0.60745638003486435, 0.60142663492315074, 0.5951834585092608, 0.57501943343072726, 0.56175026799270866, 0.53719416637531481, 0.51112350690809538]}

1000 iterations
repeats=10 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.4304967903302095, 0.3603251507688122, 0.5014808113318661, 0.468745343250899, 0.4410514991097706, 0.43889683165416127, 0.4465731287378103, 0.3374481724233548, 0.37239539649095643, 0.4948210320271388], [0.38745762679730167, 0.38486348502644663, 0.3984457071149262, 0.4331436135672976, 0.42930579776552646, 0.45758929132907644, 0.44963011309065004, 0.42952525114451623, 0.4543526401665575, 0.47106513915885706], [0.4415999133453842, 0.41754748875671044, 0.36914400219517896, 0.41567850559292097, 0.4512792614511528, 0.43851284434807136, 0.4009647722497184, 0.4042101123407936, 0.3944263731381794, 0.448154027145664], [0.39641460874439327, 0.37322226954452464, 0.45505124876178304, 0.3965115116906017, 0.3890551994221443, 0.4102388241287208, 0.40416419216827715, 0.44345411517463873, 0.4127933428029571, 0.3929185324924772], [0.4220690602746682, 0.4064159279443402, 0.39871338981804494, 0.38105670957514615, 0.4084417309067433, 0.43161284832141633, 0.4162919417421985, 0.4250066770962242, 0.4052532493578853, 0.4046028754057016], [0.41249171566138476, 0.39199379537137236, 0.4110388453458287, 0.39101109877999163, 0.4196641396797579, 0.4077319803756895, 0.4186514992584136, 0.4125817179625052, 0.41732520130222295, 0.4020490432530823], [0.39706335892732636, 0.4288318047314853, 0.39877754926072373, 0.4068808062962045, 0.4267877290922445, 0.39465533762811167, 0.4005168177820171, 0.40884399428127005, 0.4075049708780838, 0.40864153325237984], [0.38648623030066576, 0.38971118236413405, 0.4039725813170546, 0.3894472149239123, 0.40668549820124755, 0.4014038357650115, 0.3898882435944254, 0.3897523871396831, 0.3726297301266974, 0.39583480942506644], [0.3720687053039945, 0.37166662217135205, 0.4067468563223111, 0.3764646774264563, 0.3977973266102137, 0.3876576771756901, 0.4143040164959866, 0.38577091026780597, 0.3687858473054141, 0.3892585125935012], [0.37007189277960495, 0.36991133192703307, 0.3638142640183597, 0.37847438893109386, 0.3631876708000923, 0.38478320790447107, 0.37479655724545546, 0.37426930946600145, 0.34487282669576813, 0.35629231204118805], [0.35438447828250186, 0.3680307160580023, 0.3522361578677786, 0.371343041052825, 0.36040712788396767, 0.3507113564427484, 0.35936837619341266, 0.36309209340684634, 0.35644176034473396, 0.36433196921781164], [0.3676083185038199, 0.3593424561001616, 0.3468073676651062, 0.3559800147233775, 0.33163452071496635, 0.3637806948328496, 0.34949322205140576, 0.361687450530611, 0.31769170658807555, 0.33425752018290666], [0.32666062585770606, 0.3025159764219525, 0.31647756225578716, 0.32789071975952977, 0.32410876685390766, 0.3209701277865088, 0.3075606314955591, 0.31846914665342974, 0.33121587825941945, 0.3231331132542886], [0.2971923311917555, 0.30772044593758785, 0.28777019321285646, 0.30062573228795797, 0.3049698286975179, 0.31583517750040535, 0.30725443659327967, 0.2776571148534668, 0.3097183533713076, 0.2901525867235789], [0.24140603313087294, 0.29788397271084555, 0.27805069563712137, 0.2716476119186608, 0.285310565215392, 0.26954460208059594, 0.24651810433374388, 0.249062465835017, 0.23163379679438534, 0.2454470031795425], [0.24603935000084765, 0.12256242460425659, 0.2032173559894932, 0.1801340455272633, 0.18859565320278693, 0.2704833515541696, 0.14821637946985644, 0.1745960093489023, 0.2035055952009619, 0.24396274770694248]], 'MSE': [[0.094468523186546707, 0.091608278556296177, 0.078093619015734181, 0.08728528576475296, 0.096302820922719592, 0.092555255166586664, 0.087280132042509742, 0.11264628161610547, 0.10069762295275352, 0.078279029811603826], [0.09505399906841179, 0.097950989040395467, 0.095719253652368566, 0.09299767831820327, 0.092383662686566129, 0.087083701599166591, 0.083565799805410956, 0.092578167901901487, 0.090126493901485472, 0.085178026625359435], [0.090312952678582303, 0.094260295727437174, 0.10015588047360004, 0.091691096514474366, 0.086385715402546179, 0.088427086560927751, 0.097141327301342922, 0.092397777735500689, 0.095734087938941809, 0.089029801276866383], [0.09705410955340453, 0.099966243575750791, 0.086064546235376932, 0.095188539875125475, 0.09663118522573233, 0.093745354529893493, 0.096335494160992463, 0.088468338925986365, 0.091151988986233695, 0.097123947876848721], [0.091440926244369364, 0.094442456207963196, 0.096077313448381788, 0.097354072744029116, 0.093803008164272395, 0.09041773428314355, 0.094492069856645669, 0.090835349683531089, 0.09289105728348121, 0.09395497138978838], [0.092892519581965469, 0.095585837559507975, 0.094324553111155493, 0.095929679482943744, 0.092334148103629929, 0.095634572120008893, 0.092390901684807222, 0.093931667845778319, 0.095130848488149705, 0.095678109298051983], [0.096965144358635028, 0.091241411453700308, 0.09578861944557511, 0.094723681887584621, 0.092233272518620707, 0.095499248170201612, 0.094005727944778683, 0.095341411395835421, 0.094270347998402476, 0.09466678191192128], [0.098009279517979761, 0.097593349338630384, 0.095680500239787733, 0.096377012273413123, 0.094475531357606959, 0.094941327072902051, 0.097012994647780473, 0.096737854705224668, 0.099146668778388194, 0.096260792297526113], [0.099982038435671231, 0.099920561156102011, 0.095226539600037297, 0.099899439168839074, 0.094685554931002683, 0.097568355264136278, 0.092914538284436174, 0.099243336325382139, 0.099157616878944949, 0.097137759671777235], [0.10061911076155942, 0.099761453242296169, 0.099573051901617637, 0.099127111700702208, 0.10076004756558395, 0.098923084060184088, 0.098737678830062792, 0.098835060500766667, 0.10451423014650668, 0.10253602289825278], [0.10257636402293462, 0.099277611743724667, 0.10452770675466354, 0.099777262830942862, 0.10096639059562784, 0.10240092244205218, 0.10239694839084325, 0.10071494848507637, 0.10308570774060613, 0.10086215469829689], [0.10121325416039331, 0.10102337933744869, 0.10472423213779976, 0.10232218229054384, 0.10581249544321142, 0.10067019624931162, 0.10358644577048787, 0.10154291780237737, 0.1081199150604558, 0.10629360540577207], [0.10724084208093747, 0.11028000653110884, 0.10879860161530748, 0.10659864637609266, 0.10826362913280686, 0.10861004179779553, 0.10967059813330653, 0.10827557514185829, 0.10666673431426116, 0.10835280586230069], [0.11216758397679776, 0.11057757623049753, 0.11281688811225103, 0.11084670171942683, 0.11037103942078408, 0.10874512333670244, 0.11028482387972058, 0.11453968743327722, 0.10977090353119107, 0.11305383369875392], [0.12037526064744458, 0.1123299316832852, 0.11432792698271464, 0.11587983520499365, 0.11419763830845094, 0.1156272553190844, 0.11918777857447391, 0.11983208492239929, 0.12213825337046806, 0.11990421613847098], [0.11989754316582273, 0.13999097683295625, 0.12648119092899657, 0.13046663011620255, 0.12878917237552856, 0.11591446008396333, 0.13579260443859414, 0.13140106451723152, 0.12662212857042537, 0.11994929561835793]], 'Rp': [[0.65719135633436954, 0.60589089710558086, 0.70919595891510112, 0.68485617812606259, 0.67080586274692555, 0.66589418658429833, 0.6694181624329435, 0.59234354192910965, 0.61381694002614706, 0.70452319950729503], [0.62494170480198419, 0.62204389720082587, 0.63239600627728332, 0.65827488537069234, 0.65586656569260426, 0.67697667942322293, 0.67427848656349576, 0.65556615879868063, 0.67447102390837477, 0.68666131939063935], [0.66475634867540556, 0.64724745300686182, 0.61244440651990606, 0.64504122829038235, 0.67179426619009164, 0.6629185413674934, 0.63627677918181946, 0.63732435854522163, 0.63104615813750364, 0.66964566380472068], [0.63247488225476567, 0.61348773514635246, 0.67464369060586171, 0.63137251342978851, 0.62612003118375636, 0.64133788694496707, 0.63739259620309652, 0.66593521019840263, 0.64384191730603424, 0.62933902982950207], [0.65122780538998393, 0.63819593967699206, 0.6323396696073873, 0.6205559515605179, 0.64047633605240395, 0.65718041735009869, 0.64584443646118783, 0.65225024550665944, 0.63788496455321242, 0.63697597132227268], [0.64335525051835252, 0.62785196727160508, 0.64188070567924216, 0.62891543336012179, 0.64953655166267321, 0.63971970664050204, 0.64812645326330343, 0.64289221910770866, 0.64639473316204721, 0.63533760470932343], [0.63167977018189236, 0.65553329059196863, 0.63238932193494946, 0.63872260382477231, 0.65362107972485062, 0.63076832741079014, 0.63485366122716957, 0.64029981916981127, 0.63975087039168765, 0.64041636312874617], [0.62433696790706483, 0.62792161375823763, 0.63632068713237999, 0.62734954221467654, 0.63845163221535661, 0.63429141025291058, 0.62684469037731871, 0.62871139324460934, 0.61393348066084574, 0.63083201282457646], [0.6145510237340589, 0.61190249516654904, 0.63870541461355956, 0.61724261747339959, 0.6322349421097635, 0.62446020964031068, 0.64470068891080079, 0.62299662854694349, 0.61319599542891234, 0.62619412169890443], [0.61381751850224098, 0.61373994529658893, 0.61034508250905994, 0.61846370851182964, 0.60729726837127795, 0.622879875669201, 0.6173867218008493, 0.61627588185350224, 0.59422633290649252, 0.60252811241435411], [0.60130134630201804, 0.61515767696449919, 0.59938937909955381, 0.61366009301753666, 0.60516576048627746, 0.60081263710065858, 0.60580382961119239, 0.60922752563906934, 0.60200655151911808, 0.60976960236174049], [0.60947328116993915, 0.60562808345190455, 0.59585606449909667, 0.60366440824194667, 0.5850824598994786, 0.607920536564588, 0.59883744787643323, 0.60671840235894337, 0.57801128177625904, 0.58483687259318384], [0.58189439669559928, 0.57026691153010323, 0.5744851765862482, 0.58155038584333063, 0.57822981814522334, 0.57909480053312679, 0.57572017457541902, 0.5795685448853185, 0.5862822340926237, 0.58012541710613708], [0.56752332699523433, 0.5722576803249263, 0.5628593784283773, 0.56747036032759579, 0.57568072302925188, 0.57803585886209607, 0.57440812176571565, 0.55969917202863728, 0.57399681201040154, 0.55455932867527657], [0.53784439040014698, 0.55840867247360926, 0.54708389785566502, 0.55101902598967245, 0.55652571545064367, 0.54944481694435121, 0.53586114462847312, 0.53618468804149655, 0.53689006770858982, 0.54146801624821184], [0.5304649259491494, 0.48288000189572822, 0.5215999082610554, 0.5046261287022491, 0.52239415448479354, 0.54813167396813711, 0.49153754158835156, 0.50082653130589827, 0.51919855183216879, 0.5351305791533616]]} 
average_performances = {'R^2': [0.42922341561249794, 0.4295378665161156, 0.4181517300563774, 0.40738238449305186, 0.40994644104423683, 0.40845390369902496, 0.4078503902129846, 0.39258117131578985, 0.38705211516727256, 0.3680473761809068, 0.3600347076750629, 0.348828327189328, 0.31990025485980883, 0.2998896200369714, 0.26165048508361777, 0.19813129126054804], 'MSE': [0.091921684903560882, 0.091263777259926918, 0.092553602161021972, 0.094172974894534495, 0.093570895930560588, 0.094383283727599881, 0.094473564708525526, 0.096623531022923953, 0.09757357397163291, 0.10033868516075324, 0.10165860177047684, 0.10353086236578017, 0.10827574809857754, 0.11131741613394026, 0.11738001811517855, 0.12753050666480789], 'Rp': [0.65739362837078352, 0.65614767274278019, 0.64784952037194055, 0.63959454931025284, 0.6412931737480716, 0.64040106253748796, 0.63980351075866382, 0.62889934305879769, 0.62461841373232019, 0.61169604478353956, 0.60622944021016634, 0.59760288384317728, 0.5787217859993129, 0.56864907624475125, 0.54507304357408592, 0.51567899971408926]}

repeats=20 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.36286708405634627, 0.38079038658716513, 0.46632061829196947, 0.31181957024272666, 0.49486431898317895, 0.45010822031316156, 0.4211261195139815, 0.3768806809670816, 0.4806327239806949, 0.5908147106605361, 0.44371827501002337, 0.32083012524963894, 0.36679706644579757, 0.4244508212217857, 0.34801666935683495, 0.3476097881602792, 0.3971130607838239, 0.4417839714167753, 0.4571457536552611, 0.4725591119676018], [0.4470268144872026, 0.4444815894390489, 0.3745405484076956, 0.43192185790239845, 0.4067616802756371, 0.42717918175641256, 0.46344722845926545, 0.40978729537544667, 0.43746760560015807, 0.41673785760326454, 0.41902189822846636, 0.4572035054882996, 0.38422881462017333, 0.43571724501698383, 0.41129424781248647, 0.4571635336599872, 0.4059284840309648, 0.474895645329381, 0.3876932851226377, 0.4327490817346441], [0.39785826112596767, 0.44485777886282474, 0.3949099869416949, 0.41257628018519354, 0.4233693106369355, 0.42750366029635445, 0.4345177356459011, 0.40657913883095775, 0.4109887363767739, 0.41878787305204057, 0.3953578703307452, 0.39218372082100694, 0.4184968867044405, 0.43567107120645754, 0.4557960270077597, 0.45218154738298066, 0.42556883454398475, 0.37666240120052497, 0.4323604721005735, 0.3883242520494462], [0.4226461645887214, 0.4272416556608415, 0.40484146568016144, 0.42073964346692394, 0.42123898279510363, 0.43019338291847664, 0.40337123696697985, 0.4167678583083658, 0.4575216655125479, 0.416536763827699, 0.41548645127133144, 0.39947393527373365, 0.43043960271646853, 0.38987885840552694, 0.4138964391135598, 0.4075793751374188, 0.41391743645909373, 0.3940569365502483, 0.391833985966632, 0.4402697306387301], [0.41378063889731176, 0.4239781043074129, 0.4043607017009223, 0.4301541984820716, 0.40020593485437295, 0.4222087902403113, 0.41792924590441605, 0.41125435800118293, 0.41224652542286633, 0.41112831806310624, 0.4004380290177373, 0.4093085846066894, 0.4474042370624969, 0.4216030230013904, 0.4094512637968287, 0.4085503857699341, 0.4284988213389146, 0.43139452524068966, 0.4146471184055629, 0.40886398340938], [0.3955305939535121, 0.40951352917226536, 0.38436379418721456, 0.42672311436709764, 0.4066184715890385, 0.3816422984452713, 0.43033888662337794, 0.3984717507979719, 0.40619284032744485, 0.39145226845115744, 0.4142087836198808, 0.40906931329709906, 0.4012331974108112, 0.4007299782084828, 0.4164415553638602, 0.42725295190397583, 0.39616597682294286, 0.41165665292396114, 0.4233958530750199, 0.40928814865625507], [0.40295605506156384, 0.4058550250652794, 0.4052055137847932, 0.4214574557359122, 0.426897259546823, 0.40672345937424415, 0.41046649138251434, 0.4026154827114281, 0.40341902016152087, 0.3729734211837108, 0.41783239397350314, 0.38452045308485605, 0.40453991401761213, 0.41086418622986276, 0.40248570687125973, 0.4140000422841723, 0.40279290446943294, 0.4169252243017221, 0.42082071168612367, 0.4217077670384891], [0.40301461727860555, 0.3922924605010263, 0.3544659886810797, 0.3837127588413206, 0.38006296488401337, 0.39932934500539985, 0.4162556948056714, 0.4073360273462967, 0.3979848749818845, 0.3820253055497973, 0.40547152481815196, 0.39537822693723423, 0.37627889785840396, 0.40302014595091784, 0.39911153032767166, 0.3829806552472874, 0.38875641047357623, 0.4017492232347384, 0.3814213716661734, 0.38930106668002273], [0.3929484371283496, 0.37766735466186785, 0.3845834462370852, 0.374493287274844, 0.38455650189813817, 0.3790887450926764, 0.3856367080024521, 0.38772612944592155, 0.38444739939038397, 0.3721734113101066, 0.38566432023556463, 0.3945935862074228, 0.39782481538585013, 0.37553399401646104, 0.3959485376613129, 0.3741698942981173, 0.39351452220216065, 0.40085204994333923, 0.3807003776439255, 0.38637306391966153], [0.38526076477906357, 0.37406455683173556, 0.37764179974012624, 0.3694194878903505, 0.37778930700411795, 0.3805043266598135, 0.364777886970549, 0.37180407058654363, 0.35282388139252374, 0.3684804356816973, 0.37700167362121273, 0.3578165056790559, 0.38715160732354514, 0.3812561356032894, 0.3907492788745779, 0.38661394613748556, 0.36498002059566603, 0.3705793976600201, 0.37236328047959033, 0.3893896778798359], [0.35627288960017145, 0.3560964243909345, 0.37825895093713335, 0.3666919808279233, 0.3711518109301237, 0.3459389109955249, 0.3639137669201997, 0.3608564871632245, 0.3661422392056851, 0.3411273459923657, 0.3526795076023871, 0.3633833029839886, 0.3602213289964854, 0.363857182876721, 0.36261514228792513, 0.3589841584333898, 0.3572464741611888, 0.37098301996387884, 0.3394974455522358, 0.36894366826237346], [0.3556984282197596, 0.34270380495193287, 0.3586515549622341, 0.3388233289239797, 0.327300372966996, 0.36127920602270047, 0.34892981768216724, 0.3528452494397828, 0.3537660634527017, 0.36525074869194574, 0.3587980565409792, 0.3367180868232017, 0.338596699933019, 0.3404210758359112, 0.34092544802645564, 0.354081941021711, 0.3693421880989213, 0.344518036431015, 0.3525984566295083, 0.339628314220792], [0.32198297686170474, 0.3351564467790996, 0.32893476877686767, 0.32948787457808404, 0.3275593353615023, 0.3047591858049661, 0.3216339150824813, 0.33959116577251636, 0.28721155869866777, 0.3220374001438602, 0.3180539691469235, 0.33639016558968726, 0.31677408761235715, 0.30985335681345183, 0.31067373878053084, 0.34275136190494093, 0.3324773296917506, 0.3047641851527082, 0.32313052857430735, 0.32349458880706117], [0.32014069599677764, 0.2992676532887625, 0.29808275699496467, 0.30047874479905534, 0.3232842970876425, 0.31581300678822566, 0.3124977284900149, 0.31210236845133876, 0.30783165518442923, 0.33286750517350405, 0.2949189478846672, 0.291148103418702, 0.3204166114367366, 0.2837855788873449, 0.3059167606030113, 0.30854902620359426, 0.2916536202074451, 0.30587563020625974, 0.3099672045479779, 0.32882250862420626], [0.27924870032070015, 0.3108827908259759, 0.24700755567067123, 0.27217956312531844, 0.28575983873225697, 0.2740669042327215, 0.25996278679270546, 0.2475929109238143, 0.26660990877057256, 0.27839205740517814, 0.2899262785010265, 0.2589248997621143, 0.2690476456974996, 0.30383266258822816, 0.2632500439118959, 0.27424176174662784, 0.2668422923303392, 0.2617103441661369, 0.2637083909087842, 0.2727474976351303], [0.09712501278346242, 0.2351958280036418, 0.265186403895063, 0.2079846733949684, 0.1875483216912347, 0.21106160423665077, 0.2265133188883257, 0.21154096810605716, 0.2223643570424194, 0.24499331690669057, 0.20607582050996898, 0.2313463185491954, 0.21614343541085568, 0.2427673686048829, 0.2945216288866851, 0.18969472294525636, 0.1950317337880948, 0.2134551666086295, 0.2501254768009785, 0.21477113372173262]], 'MSE': [[0.084823414590221524, 0.10443491983067799, 0.079030162373218207, 0.091808749596407779, 0.081351066684608037, 0.098212208914677371, 0.087222875486833537, 0.093745690555716576, 0.07801936001287739, 0.071680199288776253, 0.086810498297112987, 0.10933683524168337, 0.09950864371968772, 0.090451175192172245, 0.10101367018536346, 0.10569401665317878, 0.093081513227760426, 0.083703851924882305, 0.087983778517311942, 0.083150911392540869], [0.089655586763628697, 0.088147860449731719, 0.098328409484948157, 0.088864727994704545, 0.092655196365880502, 0.089443779333035725, 0.086108591901601347, 0.096389570227393043, 0.084752683450424554, 0.091202839947597356, 0.092920601237368478, 0.08627018888028723, 0.098929770161195363, 0.086378313309212515, 0.090559658701070814, 0.086406135282232233, 0.094341916788043642, 0.081827167418585006, 0.099711222017985615, 0.087975793782583148], [0.096502906399495283, 0.088230442910783247, 0.095889784340151607, 0.092554847613303612, 0.089143627378730522, 0.088351253988251596, 0.090895168069861379, 0.098185131626654612, 0.094743562556525315, 0.094578241734069868, 0.096411220390326166, 0.096156465348250703, 0.09136507320126816, 0.090508907568806168, 0.088275240520208173, 0.090240733512045465, 0.088854771309890668, 0.096678352090849004, 0.091049880940993783, 0.098489877790202227], [0.091110909821193062, 0.089217832922744919, 0.093551012097186068, 0.093718262020083501, 0.091900848466216642, 0.091680393423286738, 0.094933455997115182, 0.094078556839293573, 0.086122791663821655, 0.090725560539794733, 0.091621420443402157, 0.093793453329590076, 0.090740248255682512, 0.09698415980287875, 0.094886058582645885, 0.09750363728279178, 0.091999462092417328, 0.093924774603274641, 0.098921318155173271, 0.088272036905426413], [0.094373742382904954, 0.091587205053664439, 0.09331834469068527, 0.092706080799773341, 0.095486373874800842, 0.09138715460961952, 0.094363051357441385, 0.096151582694640025, 0.094200384608668433, 0.093446758221554072, 0.095353821171415609, 0.093892808082409684, 0.08770119598150089, 0.093597329975187063, 0.094481708136432307, 0.092583597834472134, 0.090874895553423596, 0.091940019437771026, 0.09454558286116925, 0.093758527537195949], [0.096271345809441355, 0.093463752249229079, 0.098031151539066511, 0.09121874354173086, 0.09386629424519366, 0.098864613205343704, 0.090989344965583405, 0.094591965750830481, 0.095531432780092601, 0.096178519185833186, 0.090505401658837858, 0.094601893068221976, 0.094289910734262142, 0.09622684571265247, 0.094533153600466685, 0.09185332176822765, 0.094458350796471746, 0.092770337395469277, 0.092568085261751379, 0.093281844583932877], [0.094743315982649137, 0.094871984733310002, 0.093753266877868544, 0.092596735961029297, 0.092104256507376456, 0.094001576897301709, 0.093937784633704877, 0.096160313703256811, 0.094243773816724413, 0.10065138763980092, 0.093011501602675989, 0.098693320985825408, 0.095355789736814828, 0.094508516374676152, 0.095914276905721421, 0.092602528067364909, 0.094593491454349407, 0.09294684401912244, 0.092414990841554537, 0.091499810156952563], [0.094041834559372608, 0.096364083130343878, 0.10152009478977658, 0.099082281519308354, 0.098409599148856178, 0.094348368394809035, 0.092192550211281865, 0.093767834948207437, 0.096559206976489828, 0.098569829753141006, 0.093546551512260143, 0.095441239883428716, 0.1007217790090824, 0.094252184655569393, 0.094485725533934903, 0.09896176662173907, 0.095927288646872166, 0.095095283110638557, 0.097305868186340308, 0.097790126480180345], [0.095696826075322636, 0.099601136596388584, 0.097947159497168132, 0.099761301984671549, 0.097783178531577739, 0.099143745359064714, 0.098960465557009755, 0.096938956770968698, 0.098478059655179778, 0.098744215559543075, 0.09740325474298428, 0.095527884063239296, 0.095376466769681381, 0.099519010932570207, 0.097247561716277617, 0.098675245436947445, 0.097086840569704486, 0.094282950771920754, 0.098801058273222317, 0.097094213687311942], [0.096845088603135246, 0.10032489909034782, 0.099269933494553056, 0.1005515977836679, 0.098036132411136789, 0.096874543566753193, 0.10043721485842354, 0.10012089299228538, 0.10243964265824643, 0.1001869754523084, 0.10039275638174035, 0.10083218112257374, 0.097175066395541868, 0.098845913186598217, 0.097074437631741242, 0.097744329504821856, 0.10091242256916334, 0.099594067977796699, 0.099853982412345499, 0.095929424434854457], [0.10332239359209001, 0.10247503108333976, 0.099449075627565386, 0.10178478589106646, 0.10028791416506344, 0.10232421488572824, 0.10069948175795099, 0.10282816817865165, 0.099979592444706319, 0.10416135293150178, 0.10270291646423325, 0.10031544208908681, 0.10126331315338169, 0.10085429327059219, 0.10088924376171114, 0.10303747814155852, 0.10212015658295383, 0.099450737491627958, 0.10460785484158151, 0.10078670016692033], [0.10258045009717871, 0.1037118329267467, 0.10255181216116477, 0.10425582092529803, 0.1067263560814429, 0.10109188823772654, 0.10330101313228578, 0.10292000714961945, 0.10291223200528983, 0.1003941951815962, 0.10221518941785837, 0.1046496154664831, 0.10479362270727274, 0.10600552218107855, 0.1051369803994216, 0.10301849098570462, 0.10073554856136106, 0.10452963644339665, 0.102180772151356, 0.10508568934756611], [0.10769122832499536, 0.10576431840666993, 0.10654772132954476, 0.10557360953414036, 0.10650283596279367, 0.11106409510090769, 0.10609903478372922, 0.10530977182145038, 0.11340404694623576, 0.10795496525807032, 0.10886904836140855, 0.10524599452572828, 0.10857755854515751, 0.10983517271626891, 0.1101811692854143, 0.1040557672388865, 0.10636130788778092, 0.10992826237938683, 0.10743030191019233, 0.10757153403209239], [0.10744898860567144, 0.11104421866811996, 0.11035843225078598, 0.11115603733794355, 0.10724068612538225, 0.10787641744918705, 0.10935380631236943, 0.1102284376381641, 0.10980477914188219, 0.10526752743648395, 0.11212859597305226, 0.11210984145611484, 0.10850252917265361, 0.11282723916963934, 0.10991882455700722, 0.10976028696486045, 0.11199423965256691, 0.11028411854402717, 0.10899692662452147, 0.10699496920032504], [0.11469352524532257, 0.10962191131373637, 0.11952408693749239, 0.11511569490360228, 0.11460385490668754, 0.11571263461750668, 0.11743180925208477, 0.11924097173495211, 0.11689426905614871, 0.11509473882837064, 0.11297512906451988, 0.11735389979728077, 0.11627649240145624, 0.11026883191156037, 0.11650380882099769, 0.11592102464871369, 0.11633406698013762, 0.11777502578625333, 0.11758110046884652, 0.1154782366294881], [0.14421703403625941, 0.12186084446636597, 0.11666582633424008, 0.12551094079002748, 0.1296849731574663, 0.12582992948487856, 0.12289001636434915, 0.12504623669843978, 0.123714900812522, 0.1197287585941918, 0.1265200422151449, 0.12272598593911399, 0.12450049018798488, 0.12025334057740028, 0.11219002896852336, 0.12905381406776495, 0.12774804812025095, 0.12515339525871266, 0.11900816225643823, 0.12493399531829558]], 'Rp': [[0.62438948095955971, 0.61872958229221442, 0.68449211280518174, 0.57580363076445484, 0.70692483197406575, 0.69327195932619068, 0.65014356206195723, 0.62312563375867169, 0.69347330809062546, 0.77137674816637469, 0.66895826073894604, 0.57758704037663777, 0.61341213311266707, 0.65621904142118237, 0.59343196354888561, 0.59301248844815357, 0.63473457189292315, 0.67562552793941977, 0.67776228412537498, 0.69084930270915845], [0.66900830825165747, 0.66684621743473282, 0.61455452038440328, 0.6577246096696443, 0.63922115087530729, 0.65422434595104895, 0.68103965906202046, 0.64016595048091118, 0.66242157415496161, 0.64605790855581935, 0.64807195327244149, 0.6762724379445747, 0.6229676825299153, 0.66183639566532371, 0.64295073434250882, 0.67618533833112116, 0.63869615174233352, 0.6904349361976706, 0.6236670435773416, 0.65904319606301398], [0.6318867032338753, 0.66758943676323279, 0.62995741780534564, 0.64485200017358435, 0.6538872082970254, 0.65528678573253363, 0.65968304654337762, 0.6389707020209352, 0.64228756090890171, 0.64783662295059807, 0.63092550652316548, 0.62876131163893645, 0.64748735409294611, 0.66032156888236282, 0.67546829674719699, 0.67344804929221236, 0.65382496112533872, 0.61936256072777951, 0.65783305845071571, 0.62609825077284254], [0.65027097122736655, 0.6537946879288018, 0.63805459343323656, 0.64946998821745316, 0.64964749369651598, 0.65605519817574931, 0.63657431525968822, 0.6461371222018123, 0.67648081300075824, 0.64673838233404857, 0.64540093005900334, 0.63477573238059681, 0.65686332559000715, 0.62654752684158421, 0.6440461044711232, 0.6395439031318072, 0.6438098591561674, 0.62931676638362011, 0.62856712231630207, 0.66360010332789277], [0.64426021141080492, 0.65124343983455946, 0.63750772662397182, 0.65640122199697637, 0.63424864023292837, 0.65058440818186258, 0.64731490783570589, 0.64199205969387318, 0.6422119751979114, 0.64231139539060245, 0.63492881521743105, 0.64233103625439736, 0.66889239878812456, 0.65035151863942864, 0.64077704857628204, 0.6417403062957675, 0.65481854170423481, 0.6569266553575881, 0.64484749152949916, 0.64080480330975198], [0.63045806626666012, 0.64085957731073617, 0.62257648295771695, 0.65372053514924389, 0.63887390780479614, 0.62067654648331139, 0.65605426819037826, 0.63221632046895193, 0.63851725236757439, 0.62855741059689085, 0.64660031011579144, 0.64045041391040114, 0.63450344441229001, 0.63441884269436666, 0.6456631980489288, 0.65396797477547719, 0.63140666040944049, 0.64280932420305315, 0.65112875310057494, 0.64112125646867013], [0.63738775559635374, 0.63794679720173186, 0.63790382214970021, 0.64961658702945613, 0.65398687661876576, 0.63853696651795955, 0.64145152182437581, 0.63702246089506565, 0.63794082248013728, 0.61374752642389041, 0.64695881785765685, 0.62243124807605699, 0.63865979846509724, 0.64187055550366756, 0.63583007034487693, 0.64429883439250568, 0.63666751246529685, 0.6472957483901548, 0.64908835080610239, 0.64978268629158475], [0.63688084475818962, 0.62840687573174636, 0.60306442749087474, 0.62313649410057759, 0.61865317314893387, 0.63311660643579937, 0.6455554151447882, 0.63914070633865816, 0.63255382144843719, 0.62167895330154377, 0.63787452838380088, 0.63113128153354903, 0.61676655265937541, 0.6365854149087492, 0.6334203847115405, 0.62129463136470686, 0.62535998391076597, 0.63521396438894451, 0.62183399224684144, 0.62724164830131479], [0.62887106866293629, 0.61778820571484294, 0.62377703995834144, 0.6145866012960719, 0.62284902873763182, 0.61983527534404137, 0.62379653350760933, 0.62506439390228008, 0.62272055309858354, 0.6144074964556957, 0.62345740762590673, 0.63150704883544839, 0.63393080556537718, 0.61693839703763875, 0.63042335540946948, 0.61655160511792517, 0.62805482347693764, 0.63466992676920142, 0.62121902861109357, 0.62354675537607729], [0.62347697958450288, 0.61492799160416645, 0.61773433867112704, 0.61106061855241478, 0.6187204293092613, 0.62112588951702374, 0.60992035041027182, 0.61378458292964233, 0.60329577472396667, 0.61091572784323667, 0.6162464441756188, 0.60453452836923038, 0.62437634018132948, 0.62002861936649434, 0.62678759322989386, 0.62454685397401344, 0.60812669614314574, 0.61253954171789227, 0.61438256883826636, 0.62603474851571916], [0.60258200032279507, 0.60126918811695174, 0.61820490221379476, 0.60925807548165378, 0.61384375143197567, 0.59811298905431753, 0.6067225289732967, 0.60481788807523273, 0.60969546137127861, 0.59212637135034552, 0.60020735573998951, 0.60797608598307251, 0.60654902621472018, 0.60794845076583226, 0.60820660794796111, 0.60454173154467439, 0.60343285170608862, 0.61353394159835661, 0.59230518877631944, 0.61191454062576534], [0.60215153413476208, 0.59529078456632711, 0.60257178514681797, 0.59133091354133427, 0.58490665154068311, 0.6060371962501182, 0.59829993236668377, 0.60082882898547485, 0.60117604898986343, 0.61020828819634587, 0.60373081283184027, 0.59245424280114756, 0.59206000234782485, 0.59230727450115184, 0.5936251034703437, 0.60127069847986148, 0.61323775892867427, 0.59334933589037708, 0.60326464601895924, 0.59244050130592874], [0.58286333828952885, 0.58819786028771714, 0.58790140558638759, 0.58575192596725745, 0.58324389140002009, 0.5707248357262612, 0.57884929703187671, 0.59081820921312245, 0.55894952941404152, 0.57913012313650092, 0.57814950853819191, 0.59054409319220325, 0.57706917266467717, 0.57050043772851611, 0.57193459943916947, 0.59252527493135188, 0.58659205067901088, 0.56772336786841826, 0.58035403205206726, 0.58072748666179141], [0.57737611058781124, 0.56641099779102133, 0.56938816310612728, 0.56536166678710431, 0.5800416903961092, 0.58357966626161006, 0.57154752320746327, 0.57201574411424683, 0.57409729457263725, 0.58663003669150471, 0.56199763830847915, 0.55976037276082169, 0.57835807803262629, 0.5610072050961824, 0.57226481479070557, 0.57352480051874399, 0.55962193755362877, 0.56815863007614709, 0.57432824127058923, 0.58195324900960244], [0.54914841490183686, 0.56900318129769567, 0.53957006248501738, 0.55011620015102858, 0.55457720254490994, 0.54958254509517235, 0.54242128398606093, 0.53453555453679658, 0.54629391068573696, 0.54953164148024713, 0.55897394334369821, 0.5474694375617567, 0.55161246518234641, 0.57155922685806959, 0.54244998697225855, 0.54918390188828503, 0.54680485596799111, 0.54589162196205687, 0.54176955390479575, 0.55492997217860973], [0.48416375155483193, 0.52568978689270951, 0.54526791195828295, 0.51918434193653074, 0.51030471698034541, 0.50806506916392957, 0.52445425856344563, 0.52211650900112583, 0.51512466880297736, 0.53211628184858251, 0.50804487724711855, 0.5217552870449701, 0.51020433529839671, 0.53064329726883697, 0.55757487057908728, 0.51435310201072604, 0.51210119346738692, 0.52207113040585984, 0.53840444459837256, 0.52283505474740388]]} 
average_performances = {'R^2': [0.4178124538432333, 0.42626237001752765, 0.4172275922651282, 0.41589657856292817, 0.4163703393761799, 0.40701449795983197, 0.40775292439824123, 0.3919974545534636, 0.3854248290977821, 0.37502340206954, 0.36024310190419295, 0.3490438439437856, 0.32183589699667337, 0.3081710202137331, 0.2722967417023848, 0.2181723305387397], 'MSE': [0.090553177084285424, 0.090543500674875488, 0.092855274464533372, 0.092784309662200942, 0.093287508243236478, 0.094204815392631952, 0.094430273344904003, 0.09641917485358166, 0.097703476627537728, 0.099172075126401749, 0.10166700732606557, 0.10343983377799237, 0.1076983872175427, 0.10966484511403793, 0.11572005566525792, 0.1243618381824185], 'Rp': [0.65116617322563242, 0.65356950572433758, 0.64728842013414545, 0.64578474695667676, 0.64622473010358505, 0.63922902728676279, 0.63992123796652189, 0.62844548501545683, 0.62369976752515544, 0.61612833088286079, 0.60566244686472115, 0.59852711701472594, 0.58012752199040551, 0.57187119304665801, 0.54977124814921852, 0.52122374446854614]}
'''