"""
Test the performance of BNMF for recovering the CTRP dataset, where we vary the
fraction of entries that are missing.
We repeat this 10 times per fraction and average that.
"""

import sys, os
project_location = os.path.dirname(__file__)+"/../../../"
sys.path.append(project_location)

from HMF.code.models.bnmf_gibbs import bnmf_gibbs
from HMF.code.generate_mask.mask import try_generate_M_from_M
from HMF.drug_sensitivity.load_dataset import load_data_without_empty

import numpy, matplotlib.pyplot as plt, random

''' Settings '''
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]
repeats = 20
iterations, burn_in, thinning = 1000, 900, 2

init_UV = 'random'
K = 3

alpha, beta = 1., 1.
lambdaU = 1.
lambdaV = 1.
priors = { 'alpha':alpha, 'beta':beta, 'lambdaU':lambdaU, 'lambdaV':lambdaV }

metrics = ['MSE', 'R^2', 'Rp']

''' Load data '''
location = project_location+"DI_MMTF/data/datasets_drug_sensitivity/overlap/"
location_data = location+"data_row_01/"
R, M_original, _, _ = load_data_without_empty(location_data+"ctrp_ec50_row_01.txt")

#''' Seed all of the methods the same '''
#numpy.random.seed(0)
#random.seed(0)

''' Generate matrices M - one list of (M_train,M_test)'s for each fraction '''
M_attempts = 10000
all_Ms_train_test = [ 
    [try_generate_M_from_M(M=M_original,fraction=fraction,attempts=M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]

''' Make sure each M has no empty rows or columns '''
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms_train_test,fraction in zip(all_Ms_train_test,fractions_unknown):
    for (M_train,M_test) in Ms_train_test:
        check_empty_rows_columns(M_train,fraction)

''' Run the method on each of the M's for each fraction '''
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms_train_test) in zip(fractions_unknown,all_Ms_train_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for repeat,(M_train,M_test) in zip(range(0,repeats),Ms_train_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
    
        BNMF = bnmf_gibbs(R,M_train,K,priors)
        BNMF.initialise(init_UV)
        BNMF.run(iterations)
    
        # Measure the performances
        performances = BNMF.predict(M_test,burn_in,thinning)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
 
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)

'''
200 iterations
repeats=10 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.40782149920348054, 0.3653120142973486, 0.49934841033677646, 0.45435635423440257, 0.4327143347966125, 0.4294260743940749, 0.4491906480122979, 0.3382706775616051, 0.36107141122674447, 0.48157576924943146], [0.38606824760635006, 0.37979288555123036, 0.3944617668173269, 0.422362269764444, 0.4310007472222208, 0.4527801029904158, 0.4475401170771387, 0.4225353893646312, 0.4508746341867641, 0.4637126138280966], [0.42880241254517937, 0.4089208005163698, 0.36535622978169613, 0.4108171428708386, 0.4496412492163069, 0.4324078110644658, 0.3947735047164893, 0.40377987913150515, 0.3853355878043945, 0.4490511759995456], [0.3934087422386793, 0.35573178512470505, 0.44537304274757195, 0.3901054313613992, 0.38444212896291297, 0.40362699750528874, 0.4001597233970928, 0.42769366022269395, 0.41003465146923, 0.3702533305490556], [0.409486584423831, 0.39507337404827214, 0.3927325129140281, 0.37480540755503533, 0.4045812085450067, 0.4265735873001443, 0.4125524077825258, 0.40014689386353297, 0.40012632565239403, 0.3929501509337592], [0.40724033514998337, 0.38567820847495626, 0.40322680534465205, 0.38234413368367504, 0.4084864764660041, 0.39985078590518297, 0.4031811018726136, 0.4047056073811316, 0.41705452414652133, 0.39167783935658607], [0.3926242280031701, 0.41331214983484776, 0.3854637701969227, 0.4020156985736574, 0.4105722299893425, 0.3812537704341662, 0.3887629342306661, 0.3961923554284813, 0.3983225835479377, 0.393620546755613], [0.37121248604994095, 0.3786820926735275, 0.39299005531740816, 0.3793111719157092, 0.39884462692333045, 0.38964987531995876, 0.38315397233753334, 0.3826683958790609, 0.3583518221298553, 0.37797033142638403], [0.36366858569785876, 0.35643553871537625, 0.3955036817084451, 0.3616728333701622, 0.38005122228606725, 0.37605383704388673, 0.3937782493391865, 0.36456938743497624, 0.3579222018488092, 0.37844534849949785], [0.3629894976399378, 0.3431107092410439, 0.34566006396184124, 0.3626405152461266, 0.352678527165486, 0.3654892267916292, 0.34880061199998513, 0.3451325417079405, 0.3357788683343115, 0.33872641033989326], [0.33306418054018494, 0.3463778818635176, 0.33100311092699897, 0.34682399424163424, 0.340737342526633, 0.32049414308167234, 0.33318143473763984, 0.347915402066153, 0.3043032349048279, 0.3388472572855752], [0.3475982934830978, 0.32894970562084347, 0.30295887281899847, 0.3130982441717667, 0.3264327153732155, 0.3269143895719716, 0.3354838072506465, 0.3476816779897943, 0.29401067636856304, 0.3120994337872328], [0.27806604901656373, 0.296385361355452, 0.28341069427180243, 0.3048494197466115, 0.28805162042460153, 0.3077771513238543, 0.28466332417876405, 0.27746783673034714, 0.31100145295781034, 0.29248807529722454], [0.23145412333267057, 0.2536783712489342, 0.2860408706558111, 0.2491683135199364, 0.26273879293376023, 0.28365156099189814, 0.25316814886238737, 0.24393780832803424, 0.24402210275663472, 0.267684994423803], [0.21438355049235558, 0.2604381101939731, 0.22530599455393263, 0.1778543728212385, 0.1881804300696942, 0.22741791872227235, 0.18845396782090706, 0.18996485943048513, 0.1623666495010334, 0.20764109190660263], [0.16993940191500223, -0.03375256413449934, 0.13512571282579822, 0.0714635269107794, 0.10763664486276525, 0.12947784398485074, 0.05337446786201494, 0.13462174147976413, 0.08820476691064993, 0.19282574399745844]], 'MSE': [[0.098229873832505532, 0.090894106373673303, 0.0784276621472417, 0.089649400605376253, 0.097739254584451568, 0.094117478308922975, 0.086867326955217816, 0.11250644026094248, 0.10251452867983481, 0.08033142388493425], [0.095269602190905772, 0.098758403689884283, 0.096353177799186424, 0.094766450738896058, 0.092109285203379965, 0.087855813792976897, 0.083883135823629495, 0.09371250136498209, 0.090700968384094291, 0.086362054460830923], [0.092382759098379466, 0.095656382393708342, 0.10075723432047802, 0.092453936291564245, 0.086643589488223177, 0.089388551665147142, 0.098145321587479128, 0.092464500238298525, 0.097171234478972995, 0.088885063454890959], [0.0975374408291029, 0.1027558417711094, 0.087593039340633089, 0.096198974116494029, 0.097360819827064085, 0.094796335937728834, 0.096982941784739943, 0.090973615325171148, 0.091580220170240742, 0.10075004093023922], [0.093431740660352661, 0.096247118260140735, 0.097032975149927925, 0.098337344912943048, 0.094415168672435698, 0.091219368455659866, 0.095097434643288098, 0.09476260764123122, 0.093691810483226584, 0.095793796854591315], [0.093722829519699985, 0.096578723254716475, 0.0955756834720876, 0.097294924698601862, 0.094112566569898262, 0.096907162629723695, 0.094849537016407914, 0.095191104648596411, 0.095175040801848187, 0.097337605229557506], [0.097679051826792707, 0.093720602749318302, 0.097909811883676465, 0.095500660480001456, 0.094842443019131639, 0.097613481054174708, 0.09584886952438873, 0.097381862804645405, 0.095731333840514701, 0.097071395243344544], [0.10044927148472738, 0.099357048380720112, 0.097443529168665957, 0.097977007499515809, 0.09572406055762149, 0.096805583260446915, 0.098083801454144137, 0.097860825287757719, 0.10140308270647741, 0.099107114516948314], [0.10131954317292358, 0.10234268046352413, 0.097031247462115028, 0.10226930799904062, 0.097475811118901842, 0.099417268125795308, 0.096170736435050364, 0.10266894721923639, 0.10086419013858465, 0.098857581489540339], [0.1017503895421806, 0.10400477517844485, 0.10241446912023983, 0.10165245601069002, 0.10242286369514425, 0.10202543779955488, 0.10284318931993203, 0.10343725477975781, 0.105965014201667, 0.10533409061247227], [0.10596376495851838, 0.10267910881159258, 0.10795401980237575, 0.10366880231559517, 0.10407147090202708, 0.10716655411065791, 0.10658260328690934, 0.10311485539583831, 0.11143730121628503, 0.10490584233536092], [0.10441582593266355, 0.10581592160908174, 0.11175431748451042, 0.10913525710752882, 0.10663602092601954, 0.10650362216936375, 0.10581729952286766, 0.10377095955254062, 0.1118724577169057, 0.1098314041241832], [0.1149803617661618, 0.11124932517744159, 0.11406196796261943, 0.11025306904861364, 0.11403922931397675, 0.11072024310657644, 0.11329714148611843, 0.11478949948100162, 0.10989080417906369, 0.11325846148444084], [0.1226593533153733, 0.11920969832405295, 0.11309081204462373, 0.1190023994806419, 0.11707734298214946, 0.11386057392922518, 0.11889533982063216, 0.11988645405797572, 0.12021814173288027, 0.11663213432500576], [0.12466324411820391, 0.11832080928022928, 0.12268058041381057, 0.13080220694126657, 0.12971771108742275, 0.12229568817110167, 0.12837251875949271, 0.12926268209883834, 0.13314884747399477, 0.12591186328278559], [0.13199923151063192, 0.16493028713922098, 0.13729005101699673, 0.14775955011065534, 0.14163929293701077, 0.1383191266718794, 0.15091244224335029, 0.13776481052621106, 0.14495199531661551, 0.1280624508317843]], 'Rp': [[0.64047248427964398, 0.60862708702244239, 0.70806365491494649, 0.67429787709274003, 0.66287655182560656, 0.65930531986848695, 0.6722514776352827, 0.59297498378995783, 0.60639697628695455, 0.69575851922926635], [0.62397566743231758, 0.61907457587281811, 0.62962658784136361, 0.65044075081856689, 0.65694018896134831, 0.67339133933446327, 0.67324923061697184, 0.65052998405280094, 0.67166241983865871, 0.68112894903287113], [0.65582189477365027, 0.64128780591663692, 0.6103582922556483, 0.64150597453986424, 0.67061024992566032, 0.65847277428854922, 0.63293784562650957, 0.63716621525424977, 0.62531493941214378, 0.67039181914750445], [0.63009234035330131, 0.60135702562663695, 0.66751825663989328, 0.62697249691830281, 0.62330557569417033, 0.63698628108195088, 0.63467370863236106, 0.6542668053043329, 0.6421340171677582, 0.61410170567640299], [0.64166926230280408, 0.62974652802416931, 0.62852654407216568, 0.6171799692853166, 0.63831810725294702, 0.65363071828112462, 0.64299305753137503, 0.63493362458572666, 0.63399882542908892, 0.62917490615996485], [0.63987770741336314, 0.62304507815578825, 0.636917795639666, 0.62382144869327483, 0.64229386979127379, 0.63415949277150707, 0.63693802352841278, 0.63759882276808477, 0.64640359987929186, 0.62812908444049131], [0.62878993404804739, 0.64429943878640306, 0.62432001589029484, 0.63536954599153128, 0.64198765189243112, 0.6212413877158538, 0.62754881764092296, 0.63099093366842818, 0.6335269502116222, 0.62994402337793398], [0.61384688589290937, 0.6205372619368138, 0.6285251060293281, 0.62107434315703902, 0.63346355311329705, 0.62612759194678524, 0.62257717661882817, 0.62358362267019429, 0.60380319350837675, 0.61844392271297655], [0.60960970697617045, 0.60122327780333329, 0.63100575640279322, 0.60771074613117915, 0.62022762659243003, 0.61689382889900535, 0.62970342916815092, 0.60931334941078874, 0.60722481954621266, 0.61879712735566161], [0.60878725417285695, 0.59847273881832264, 0.59836813494209573, 0.60781149312794791, 0.60073252168561031, 0.61095123350844993, 0.60053367273829672, 0.59601211170979751, 0.5893017714937695, 0.59156326878106702], [0.58860285407538859, 0.60238255183975642, 0.58624133224481667, 0.59596187395706057, 0.59242933354329086, 0.58025617789045991, 0.58812429494414464, 0.5997970979589079, 0.56878555133841724, 0.59400492389503334], [0.59665952714312032, 0.58756696831218647, 0.56880916324306141, 0.57457378833949602, 0.58440505734705162, 0.58627160768197084, 0.59104309726545845, 0.596595126473492, 0.56295489782000085, 0.57087978118017912], [0.55100017482390262, 0.56777606401232161, 0.55634068802470638, 0.56786331213053498, 0.55647651946798593, 0.57223228813962501, 0.56212556531780145, 0.55998943505895526, 0.5695432272718185, 0.56359900139496255], [0.53504724979487328, 0.54131421363272281, 0.56440931697537411, 0.54056044083128674, 0.5467651754210503, 0.55908868216546526, 0.54664955515360891, 0.5426831853360693, 0.54852048462625436, 0.54349650719693876], [0.53105809586595232, 0.53823971923504277, 0.52775992376692149, 0.51144194783768715, 0.5079256199353327, 0.54176400202222186, 0.51178883300621592, 0.51592645755208644, 0.50984750976651516, 0.5288570761476038], [0.50281960343983867, 0.43675375804309235, 0.50184768932772394, 0.47091016432299254, 0.50337051654263398, 0.49266395193050039, 0.4645180421671562, 0.48817343214388609, 0.48750907000076238, 0.51209914082676022]]} 
average_performances = {'R^2': [0.4219087193312774, 0.42511287744086185, 0.41288857936467915, 0.398082949357863, 0.400902845301853, 0.4003445817781307, 0.3962140266994805, 0.38128348299727083, 0.3728100885944266, 0.3501006972428195, 0.33427479821748374, 0.323522781643613, 0.29241609853030315, 0.257554508705387, 0.20420069455124948, 0.10489172866145839], 'MSE': [0.093127749563310075, 0.091977139344876613, 0.093394857301714207, 0.095652927003252328, 0.095002936573379729, 0.095674517784113788, 0.096329951242598869, 0.098421132431702529, 0.099841731362471223, 0.10318499402600836, 0.10575443231351604, 0.1075553086145665, 0.11265401030060143, 0.11805322500125606, 0.12651761516271462, 0.14236292383043564], 'Rp': [0.65210249319453273, 0.65300196938021804, 0.64438678111404157, 0.6331408213095111, 0.6350171542924683, 0.63491849230811537, 0.63180186992234699, 0.62119826575865489, 0.61517096682857253, 0.60025342009782146, 0.58965859916872765, 0.58197590148060174, 0.56269462756426136, 0.5468534811133644, 0.52246091851355803, 0.4860665368745346]}

1000 iterations
repeats=10 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.4174630202610329, 0.3666746166768625, 0.5091402523076292, 0.4573576652284276, 0.4386313141448147, 0.4324939240790676, 0.4501422768947291, 0.34374634720978336, 0.38570273558537616, 0.4873517765173391], [0.3854015040454287, 0.3745952205910946, 0.40618821328844323, 0.43373011575132314, 0.42978661853255584, 0.4575492097950761, 0.4516892778498741, 0.4236881276462031, 0.4494130857560533, 0.474090295603798], [0.4390701326764237, 0.41690369587882914, 0.3723053409854573, 0.4156485854878198, 0.4540839752553454, 0.4403859108577671, 0.4017918275436424, 0.4062533748205137, 0.3964261469234257, 0.44721345436276694], [0.3967978462873807, 0.36385230898531595, 0.45443680825713473, 0.3930885985038477, 0.3943567019646541, 0.41221159000717944, 0.3998109918783348, 0.44140217692796613, 0.41206532157289055, 0.38280852507410057], [0.4177149668127036, 0.402998919669738, 0.3984841087486376, 0.3857639732077035, 0.4109639314408441, 0.42904129185257744, 0.40991309726670755, 0.42187549112480194, 0.4012744958478478, 0.4020957198799794], [0.41246457786733615, 0.39153998320290684, 0.40602392730707637, 0.3942906291937873, 0.415168656637925, 0.4074051041975788, 0.4244517015989613, 0.40873924255991334, 0.41765069589271675, 0.4025869108099741], [0.39851847929965634, 0.4194496580436433, 0.3894755290738521, 0.4045116065867127, 0.41717145889917895, 0.390928417610814, 0.4002924109880003, 0.40744132590805016, 0.40610251422038923, 0.4058414909239426], [0.3755063646951242, 0.38455303111366457, 0.40112874132828535, 0.39046233496131455, 0.4043394321232817, 0.39894475483629543, 0.38988951111510317, 0.3859478561503953, 0.367628333728212, 0.3904120854502089], [0.37081099179411003, 0.37196279544359523, 0.402111971600144, 0.3738399489868993, 0.3933904013549695, 0.38474161285183606, 0.4068627757870832, 0.3791114425837655, 0.3646784728393634, 0.3850873101814376], [0.37217639947915104, 0.3616292935427936, 0.3650589372602415, 0.37595478441081787, 0.3528191414019699, 0.3796272828414017, 0.36095675495492974, 0.3607004777125258, 0.3528189332071331, 0.3512988369068131], [0.33952530628726396, 0.3524555835368216, 0.3461324737368955, 0.3604345415189, 0.33594302218602645, 0.3486731002373131, 0.3412371203872846, 0.36226349310548167, 0.34516208288247274, 0.34694251307723745], [0.35494125309822344, 0.3502445586849394, 0.3231395967105877, 0.35416995827180475, 0.32644313236911615, 0.3404258514945806, 0.3503910249883678, 0.3619422413395099, 0.3166579868768633, 0.3185223114473654], [0.31924222248795353, 0.2992882850089541, 0.31035274792195167, 0.3074017036807404, 0.3177684684866674, 0.3228489429689648, 0.29671384470780304, 0.3098531432110465, 0.3254236171107272, 0.31275958680482185], [0.29317403541366316, 0.30507611747542684, 0.2741506233097689, 0.2615647148023601, 0.2909154760928614, 0.31400144077026637, 0.28244857323894157, 0.26258995372448524, 0.2773584507721849, 0.2615423050034986], [0.21385762968655908, 0.27103673101798287, 0.25762355543655213, 0.19731355525350047, 0.22791606677838439, 0.24946782203398732, 0.2435011005785963, 0.2246812435678347, 0.22295419195518806, 0.21472339592397405], [0.21412799861003173, 0.024553319453125777, 0.10880360025605129, 0.15524928174935293, 0.11772573695809296, 0.11282543383869348, 0.11953758113940793, 0.09607103031027897, 0.1158388925978191, 0.17241675807551327]], 'MSE': [[0.096630549649403777, 0.090698967142399792, 0.076893758550918762, 0.089156284386150156, 0.096719801447595857, 0.093611429463673498, 0.086717246973874243, 0.11157547335457757, 0.098562492956666733, 0.079436413851300236], [0.095373067101402212, 0.099586051555281746, 0.094487266912196638, 0.092901457577380039, 0.092305827686000125, 0.087090136664497567, 0.083253145072424053, 0.093525431913805829, 0.090942377479828557, 0.084690864830420667], [0.090722107274549157, 0.094364482945939798, 0.099653980402716294, 0.0916957915449855, 0.08594416619280551, 0.088132102405511156, 0.097007209564552874, 0.092080899392368312, 0.095417947157833374, 0.089181544719904707], [0.096992486493898883, 0.10146068046149713, 0.086161585714962921, 0.095728437677118666, 0.095792663523484575, 0.093431773975175963, 0.097039325141945881, 0.08879451431100209, 0.091264999597287622, 0.098741397735050501], [0.092129836132643944, 0.0949861208201533, 0.096113949403349344, 0.096613663576987738, 0.093403064473763522, 0.090826811632634827, 0.095524692602306921, 0.091330003032202928, 0.093512482486424686, 0.094350606027509359], [0.092896810411784006, 0.095657182252847014, 0.095127712876712775, 0.095413078440100871, 0.093049400469308138, 0.095687353398744276, 0.091469103617875025, 0.094546102456103898, 0.09507770636386155, 0.095592045131224421], [0.09673112979167961, 0.092740164909084724, 0.097270646057621424, 0.095102053253732222, 0.093780587735591059, 0.096087207529168828, 0.094040917462438312, 0.095567633207217492, 0.094493489241240375, 0.095115022719071921], [0.099763321188031842, 0.098418206754302268, 0.096137022916762266, 0.096216773488667404, 0.094849103617586972, 0.095331353639561286, 0.097012793101136863, 0.097340957705231809, 0.099937066117825712, 0.097124787301498178], [0.10018229722440895, 0.09987346227419279, 0.095970512115380352, 0.10031995888855602, 0.095378464779747499, 0.098032990141259574, 0.094095013247905646, 0.10031933191426476, 0.099802845541744081, 0.097801184812856101], [0.10028295558722621, 0.10107274199717428, 0.099378241005514761, 0.09952896339317463, 0.10240061491554804, 0.099752125164027733, 0.10092338329069864, 0.10097827694766176, 0.10324656603709599, 0.10333143219706621], [0.10493721159303046, 0.10172434768261367, 0.1055126399408938, 0.1015086048762301, 0.10482830425845388, 0.1027223808838113, 0.10529500274228094, 0.10084597596299393, 0.10489249609733017, 0.10362135907925596], [0.10324059725783838, 0.10245799967479211, 0.10851880821984364, 0.102609764866284, 0.10663437175596897, 0.10436567773366828, 0.10344347998074545, 0.10150238561765637, 0.10828372032041196, 0.10880591627524309], [0.10842235003193426, 0.11079034055751401, 0.10977350923776077, 0.10984826878689392, 0.10927921222866552, 0.10830952748488069, 0.11138854435205914, 0.10964440932385808, 0.10759056243897556, 0.11001339928103115], [0.11280890101008663, 0.11099995391070955, 0.11497422199416873, 0.11703764289924461, 0.11260287563367137, 0.10903658808368763, 0.11423390766419718, 0.11692884078649435, 0.11491688381885438, 0.11761044962939043], [0.12474669832011241, 0.11662516026094297, 0.11756276989925066, 0.1277062785275293, 0.12336849750182866, 0.11880530421713696, 0.1196650162859506, 0.12372275833304677, 0.12351794936774468, 0.12478643125185385], [0.12497220141339092, 0.15562786172752271, 0.14146842032588544, 0.13442658387892423, 0.14003791401156304, 0.14096506372527051, 0.14036462087985535, 0.14390193191518183, 0.14055887994178137, 0.13130044403674529]], 'Rp': [[0.64752070399107042, 0.61063498232004942, 0.71536820930868428, 0.67644117306560447, 0.66776410142548204, 0.66197162760784545, 0.67245654097203911, 0.59674632310755471, 0.62377348131153254, 0.69913546818262573], [0.62364048394477101, 0.61485797080310711, 0.63809813534587989, 0.65879354857532424, 0.6560274720505862, 0.67684944321061291, 0.67608833970471327, 0.65130912030859445, 0.67072166613141715, 0.68892886211281068], [0.66294480154541968, 0.64672308329586348, 0.61508556914364743, 0.6450841281604508, 0.67387482527301135, 0.66414055068929223, 0.6370493390672044, 0.638680734161855, 0.63273491650232383, 0.66904581076726033], [0.63297791908757017, 0.60761836715694251, 0.67420500585179033, 0.62902654925445467, 0.63023422945856045, 0.64278594712214931, 0.63424032956524257, 0.664415119410806, 0.64332462102597654, 0.62249224781047618], [0.64751297492526105, 0.63563990139193505, 0.63223094083557552, 0.62451626979574981, 0.64271174088575134, 0.65552819033867726, 0.64121162660366116, 0.65014183368711997, 0.63514038231999148, 0.63533556186210427], [0.64321909475724026, 0.62734689883286365, 0.63852316868029746, 0.63139014603161259, 0.64663527825045575, 0.63941078988495992, 0.65248156820498082, 0.6400523208779596, 0.64666106381767618, 0.63588804681724187], [0.63309050205634054, 0.64868207888110585, 0.62667729538458183, 0.63713708667248814, 0.64665475542264339, 0.62825926267349219, 0.63501791980856981, 0.63931508170663409, 0.63890677188054401, 0.63836177230719293], [0.61745526625303737, 0.62431158787854746, 0.63440965258834048, 0.6281106671691461, 0.63696623636231853, 0.63258337724388281, 0.62692637060607048, 0.62516695413873835, 0.61015165509317104, 0.62685771391948142], [0.61373076601209708, 0.6123408996592633, 0.63540674153540433, 0.61561192413676535, 0.62929245647852727, 0.62290956142043763, 0.63923418457136294, 0.61824386489227467, 0.61125667583966015, 0.62332266328528785], [0.61475044085662323, 0.60953722475204886, 0.61114919622791308, 0.6174464051917018, 0.60055456131697094, 0.61970096124802021, 0.60820997052894521, 0.60642199381901363, 0.60033931861396517, 0.59891903843712979], [0.59146660418006913, 0.60539740923790175, 0.59555835447423044, 0.60542101797957271, 0.58860821509890382, 0.59741611330417932, 0.59422455520220852, 0.60963051810768087, 0.59528091557205209, 0.59903495429479325], [0.6013131925257067, 0.60035538581706893, 0.58210538859776317, 0.60272724608277761, 0.58257544502032343, 0.59272163755818175, 0.59968124654154276, 0.60571010285105753, 0.57809648711685213, 0.57483233155512903], [0.5787186266748845, 0.56827154156638193, 0.57110890028661143, 0.56986464340270815, 0.5738339974645591, 0.58125096355367378, 0.56761171266479094, 0.57602579557249278, 0.58160157150945802, 0.57451640903286338], [0.56414494911112945, 0.57056001361099795, 0.55908897337440711, 0.5461207390724373, 0.56709806760274739, 0.57671608059125445, 0.56440627304070756, 0.55233116501789226, 0.55624933314000991, 0.53856374264874662], [0.52724996258527879, 0.54512446497634526, 0.53918514814697516, 0.51968076214185699, 0.52872135907296303, 0.54330635654493931, 0.53785884661040373, 0.52859667382068287, 0.53172876088331245, 0.53024999940837025], [0.52492228962505827, 0.45831784852438795, 0.49637270044801218, 0.5001467164977943, 0.50984092789675328, 0.4841823977626693, 0.49181366100643031, 0.48497844962937986, 0.49305691204830299, 0.51698652581843696]]} 
average_performances = {'R^2': [0.4288703928905061, 0.42861316688598505, 0.4190082444791991, 0.4050830869458804, 0.4080125995851541, 0.4080321429268176, 0.403973289155424, 0.3888812445501886, 0.3832597723423204, 0.36330408417177773, 0.3478769236955697, 0.33968779152813583, 0.3121652562389631, 0.28228216906034576, 0.23230752922325593, 0.12371496329883676], 'MSE': [0.092000241777656061, 0.091415562679323742, 0.092420023160116674, 0.094540786463142429, 0.093879123018797653, 0.094451649541856197, 0.095092885190684609, 0.097213138583060466, 0.098177606094031589, 0.10108953005351884, 0.1035888323116894, 0.10498627217024523, 0.10950601237235731, 0.11411502654305047, 0.12205068639653968, 0.13936239218561208], 'Rp': [0.65718126112924891, 0.65553150421878159, 0.64853637586063284, 0.63813203357439685, 0.63999694226458259, 0.64016083761552889, 0.63721025267935927, 0.62629394812527328, 0.62213497378310811, 0.60870291109923325, 0.59820386574515916, 0.59201184636664039, 0.57428041617284242, 0.55952793372103304, 0.53317023341911285, 0.49606184292572253]}

repeats=20 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.43052734530828185, 0.49077208149155227, 0.5006853140207803, 0.38478203247718523, 0.4112291688948293, 0.36883351838885226, 0.4381837595828618, 0.4276718086361857, 0.4727428994844376, 0.32598273700753266, 0.4210811990023229, 0.42934661001765984, 0.48050188394734916, 0.44480748643286494, 0.4270908525315823, 0.5631891441776753, 0.45435632241161483, 0.4243757793980204, 0.41623649516537287, 0.5297506983110006], [0.4306523256353393, 0.45414847270276015, 0.42517536355691654, 0.43165556193043897, 0.42830043120984085, 0.4206784378823688, 0.411062579569894, 0.40886534661751295, 0.4491196008318846, 0.45870823221119095, 0.4238375755930084, 0.44089777913081796, 0.45933030573275924, 0.38244055488602713, 0.46011636449366666, 0.4096800527926495, 0.4369714784254328, 0.40356424311024186, 0.42206041991587007, 0.33915759342400287], [0.45719341674653347, 0.4499737698560162, 0.4060607105401448, 0.43843220697325236, 0.4365111855141338, 0.3687247120423819, 0.4020516736994565, 0.45037839663936474, 0.41498907384483275, 0.4264617765063913, 0.44382641089026664, 0.4140705788984771, 0.4165206812183786, 0.4156115429521472, 0.42042419189894487, 0.447782529386374, 0.4242315127955094, 0.4411777606056315, 0.40209028254745605, 0.4085166893323333], [0.3920284477531485, 0.41032403608714507, 0.43543116184729513, 0.4362598570514915, 0.4081942183592888, 0.4278183850817101, 0.4144976370563963, 0.4334791289793498, 0.38257394527831856, 0.4140069255316545, 0.4112285130508023, 0.4120391771615104, 0.4132490709803448, 0.40560164201082616, 0.4126782821622067, 0.43390569735372786, 0.44534648730476556, 0.4460563883733061, 0.41895566263832884, 0.40750980945287907], [0.4066936336643491, 0.40832644268962304, 0.42532306861569125, 0.4166717913438879, 0.40161687462219786, 0.4137134062544242, 0.4196177432924395, 0.4142079163823126, 0.4146450916512191, 0.41558348984523996, 0.4175608762815548, 0.38659399401584726, 0.3945367530771521, 0.38994204187855264, 0.40075041074334816, 0.39574984471055286, 0.40439410296948364, 0.4081445251246869, 0.40964331482512417, 0.3968058407118792], [0.4070334541109075, 0.39441289948209857, 0.39670901629257327, 0.4058153014805004, 0.4174898564794165, 0.4076478078989666, 0.40539319335325497, 0.3897909526180594, 0.41476175623022826, 0.4061484699092335, 0.4122369438948136, 0.40252562932839553, 0.4043023142173121, 0.4176726265995009, 0.41336852250865697, 0.399737995510861, 0.4118630419776602, 0.4108419318219494, 0.39494861155804406, 0.4000192027424595], [0.38308112612274803, 0.3917663609580355, 0.4026179151356609, 0.38623880784829523, 0.41580742396823767, 0.37705421973460795, 0.40314463848481974, 0.40723124881524086, 0.36857904196917635, 0.39522464196671847, 0.4040503229238763, 0.400838676057621, 0.37913996696322816, 0.40748273924226985, 0.40977270043694547, 0.40082951537937805, 0.39426246107788476, 0.40990785114219797, 0.39517591072401315, 0.40606178624587774], [0.3977716904117916, 0.38615948712307313, 0.3825310235225491, 0.3970854922054009, 0.38418652682956067, 0.3828070971794857, 0.3866205031642672, 0.3765687542508822, 0.3811617958888288, 0.3939683196917946, 0.3955769301377905, 0.38714257951704667, 0.3911308153983434, 0.391773536227228, 0.3879004246526938, 0.4025923310198475, 0.3779251508610225, 0.39727645826814884, 0.3849035976576237, 0.36485553520471736], [0.38656996119016995, 0.3828408236575179, 0.3758537496168002, 0.39097896365096874, 0.38147533737073225, 0.3619572838336904, 0.38633415752467903, 0.37640974453051257, 0.3751282111362907, 0.3725016080789121, 0.3849868440984957, 0.37275131989018384, 0.37115315049353403, 0.39039748033703314, 0.38117453444260974, 0.38365162810071973, 0.40099453621606007, 0.38674664861327834, 0.39764272032075165, 0.37585549563535325], [0.3887792357870693, 0.36382929633906136, 0.37062866982262044, 0.3621572043811949, 0.3775119276163216, 0.3730390015312336, 0.3671374009437721, 0.3880921035443512, 0.35974464375732174, 0.37467273212287455, 0.37157216310869456, 0.3744137836687128, 0.3765818499975352, 0.3951067622246691, 0.3821471929184832, 0.3657416530679902, 0.3654281583791762, 0.36438947462996707, 0.36438773344348485, 0.35810913726040705], [0.3210540950626293, 0.3438595017601872, 0.36511860659927553, 0.3634545805060143, 0.382725044570392, 0.34167220661009234, 0.34325851128712104, 0.37120202675188463, 0.3701317588232097, 0.343806311933503, 0.34988065366032606, 0.3505790161399357, 0.34103134468702734, 0.37002180403623897, 0.3751259533057557, 0.34209172209993177, 0.34981693717835893, 0.35313231646368215, 0.3522329539992972, 0.36107533581568696], [0.3389455414895399, 0.3505043178282664, 0.33269793561627137, 0.3590702952368031, 0.326253473801265, 0.3450721676530909, 0.3535019971542114, 0.3391857651736847, 0.3470576653466244, 0.3505832195596371, 0.34856029952806955, 0.3539522667929835, 0.3346286035207051, 0.3315598541996059, 0.3364790161658294, 0.3362000191128923, 0.3501294795071209, 0.3472881639890739, 0.33949609569173234, 0.33200911089875407], [0.30915619253796733, 0.3227497953802446, 0.3088208435978471, 0.31144217548464836, 0.3239484839808413, 0.3197188462797995, 0.33252466848823947, 0.34765628889200817, 0.3194989989228195, 0.3151796900412781, 0.31945797992552905, 0.3082764489360954, 0.31322174186405116, 0.29765961239561733, 0.3062757516280977, 0.3347744447232518, 0.31731336277560185, 0.342217545616579, 0.32005500331684866, 0.3392861932957446], [0.2806396008576256, 0.29752379853713995, 0.2765131987669289, 0.30120424733082574, 0.2555689118887948, 0.25549020855200844, 0.30575922518342347, 0.29339758758810486, 0.2966375531364296, 0.2889455273407192, 0.26376917549063883, 0.2580729831923847, 0.29807189562924896, 0.2783223609374057, 0.26712283843715934, 0.29078595363580517, 0.27267221943366826, 0.2996734380295494, 0.30242435266121603, 0.3007940796763937], [0.24761361740980214, 0.24769239857331438, 0.23290762834495582, 0.2589242371884177, 0.27612184262333084, 0.27728054672408253, 0.2438887265885913, 0.28892153619025285, 0.23012184989545503, 0.24954426307268474, 0.26356591840612986, 0.2128739005124236, 0.24576670595496253, 0.22133888537132262, 0.22266722238039094, 0.2489427406329776, 0.22111442467173137, 0.23765842497183964, 0.2413869687763981, 0.24804907391983144], [0.16019441789241584, 0.22447900255829267, 0.18991126532364389, 0.1751800162528151, 0.15952462340404938, 0.17860504819973078, 0.049966827446516815, 0.12111555745428881, 0.22051783515346868, 0.1537610202232983, 0.12268718060461348, 0.16929072038400272, 0.141386286858857, 0.13134086187844862, 0.1701948363909449, 0.16655040069894222, 0.15533940151065362, 0.1424864681154704, 0.12299321790484874, 0.17685166007212016]], 'MSE': [[0.08628380980768742, 0.087496229388386734, 0.082783699392349488, 0.10329483018083326, 0.090650165684120293, 0.10210018679471919, 0.088254821341201398, 0.097410431812597328, 0.088019223150996098, 0.10864839559915163, 0.094728042604708504, 0.09935869721460458, 0.083110513676812381, 0.099151835293030538, 0.099245778902972384, 0.065255178623497515, 0.080264818104601274, 0.07526666265790391, 0.095738996390649297, 0.075605563135410322], [0.092471972619807871, 0.086372330043738857, 0.093640473851418923, 0.089849450379299492, 0.093565562582187345, 0.095168269503835626, 0.095928046352831614, 0.093211449486633638, 0.087114589932425365, 0.089053270659493727, 0.093955481356996301, 0.089381452976336137, 0.086168041668412521, 0.095879830955335116, 0.084193207160865854, 0.094060465565006371, 0.086368588049637596, 0.096036879806083567, 0.090078761341212357, 0.10194923589751076], [0.086630370852697772, 0.08569961719333119, 0.094632455917763744, 0.088658585180649827, 0.089014846449123955, 0.10049948271289177, 0.0937319451139738, 0.086913599384784393, 0.092834979927771691, 0.092836384353808921, 0.088616730296204593, 0.092504125464982989, 0.08958829004304214, 0.094453773452018927, 0.09388172332042273, 0.08588755283842732, 0.091179115384054432, 0.091920899003605575, 0.093712079117780192, 0.095114105769497109], [0.095218039542007277, 0.091627805082814109, 0.090154369144517466, 0.088720159581211613, 0.095247558727549322, 0.089871594476319386, 0.092975615889643662, 0.091198353817140407, 0.097120493975711431, 0.092436144419585767, 0.093895732157865092, 0.093257887618435606, 0.092318090215956772, 0.096170168927192198, 0.093722133976988545, 0.086613356450200088, 0.088616712579451251, 0.089164447819391729, 0.09306928934867606, 0.092820899192939704], [0.093635730031420381, 0.094168223543994595, 0.091271485539676039, 0.095062859611138584, 0.093776163182526975, 0.095046438413072337, 0.090259791856884347, 0.094130619689510975, 0.093094187580811727, 0.091454385375297459, 0.092043202078644262, 0.095916625338345579, 0.096842168642018084, 0.097329613901018339, 0.095220448993258489, 0.097182530596516409, 0.092887239017580892, 0.094589941420447229, 0.094566613534516744, 0.097220546743252756], [0.093900199645140681, 0.095940130241532195, 0.096889729509512287, 0.095762757057068604, 0.092282878320264397, 0.094247763429587531, 0.094145290131720683, 0.098943019815623021, 0.094447587982698492, 0.096221306022922032, 0.093216477113691992, 0.09441677505655395, 0.094405407137058528, 0.0918344280732728, 0.093297436379012735, 0.095000462375640721, 0.095256718939655954, 0.093947616568391415, 0.095986013995904632, 0.095435045752058814], [0.096182948639744137, 0.096130606465300042, 0.095729268287198868, 0.097742852068119265, 0.09214845232258391, 0.097674383661665531, 0.094651975872091274, 0.093990228631526673, 0.097930067536529941, 0.096431140296031156, 0.09618516345589484, 0.095316107946935069, 0.10020495584119998, 0.093277073543593325, 0.093961749606615727, 0.096254016972652803, 0.096070327863447685, 0.094033687359057566, 0.095570415470626432, 0.09417105027984897], [0.096649715026866381, 0.097035935636946513, 0.097987741377872556, 0.096321942647413644, 0.097163833793396825, 0.098031287879921658, 0.097930044011244013, 0.09803207385092301, 0.098655722420812192, 0.096019854776141778, 0.096551479585846006, 0.097720340017011603, 0.09730518417572398, 0.097501497467641682, 0.0958455440412989, 0.095549945785148541, 0.098287875835383079, 0.094659107282520763, 0.098260900011165178, 0.10071678906488822], [0.097440417516923186, 0.098177788340198108, 0.099739743045102303, 0.095951076895564896, 0.099168981179134988, 0.10192034456443871, 0.097225073651042243, 0.098324909947452285, 0.10004320367270141, 0.10132314440037234, 0.098464994552679777, 0.10075460887237842, 0.10053582828748832, 0.097058486727839288, 0.098557015924508995, 0.097089418965230045, 0.09648284595240042, 0.097247093757014721, 0.094554756617149113, 0.099713048964248055], [0.096452418410416366, 0.10109482725997125, 0.10031877414699103, 0.10196361194164448, 0.09948967507584297, 0.099609456560555351, 0.10011845929141838, 0.097076499986090525, 0.10204707935776806, 0.10035960939376476, 0.10043544669259519, 0.10094523318074036, 0.099596418445875232, 0.096500217940730312, 0.098177971086555557, 0.10058664648526051, 0.10149845855539931, 0.10112896250426928, 0.10027632205252404, 0.10190917602691962], [0.10827580521470578, 0.10579533059265016, 0.10113845861496028, 0.1005104505736977, 0.09780724773102982, 0.10570460372893459, 0.10389483757485911, 0.099716700193663924, 0.10054334694468016, 0.10613148894690658, 0.10443009303503104, 0.10254164841566031, 0.10416398219972613, 0.099681472748948827, 0.10113101576745234, 0.10386317838070479, 0.10319230324455617, 0.10406009743598944, 0.1029089513672671, 0.1012110774811817], [0.10509740632439181, 0.10334299745707026, 0.10629946374068501, 0.10181512415766465, 0.10624860565570615, 0.10470042355825319, 0.10217524905095114, 0.10419419018078573, 0.10281206031622875, 0.10366191742998349, 0.10406369573691773, 0.10199275485085606, 0.10702886487162593, 0.10506995905369483, 0.10679510123574813, 0.10584045781443363, 0.10330766216925726, 0.10475870870319433, 0.10507725828388106, 0.10511680534177401], [0.11048363447967485, 0.10768683842310772, 0.11022892596483481, 0.10936239263542398, 0.10793459212084901, 0.10893389028969291, 0.10605590360304548, 0.10411205214651147, 0.10832548624086051, 0.1094995098975083, 0.1080520773872934, 0.11000333964006972, 0.10886759603918035, 0.11209333510885394, 0.11024608163986098, 0.1056583790544251, 0.1083005369634107, 0.10552092175199811, 0.10826802061042863, 0.10561255655462284], [0.11475391124705119, 0.11163057610326049, 0.11508363293151747, 0.11152221917431872, 0.11839469373276808, 0.11889929506994681, 0.11022089829899245, 0.11261989350502365, 0.11241627226520523, 0.11281290709083233, 0.11831214691552992, 0.11767907489711622, 0.111858885444067, 0.11513095311886885, 0.11593319827118252, 0.11287758097598229, 0.11575179067831241, 0.11109858082745573, 0.11134942418702488, 0.11163422244754125], [0.11940195386146504, 0.11985375225408851, 0.12234294594658311, 0.11798346089744838, 0.11559401589275208, 0.11476994171067582, 0.11959479026856855, 0.11257331622015374, 0.12325982999199138, 0.11909986884977362, 0.11731702390284017, 0.12533079811418515, 0.12049698981585326, 0.12413973745216722, 0.12325609050441738, 0.11992549790003201, 0.12388755230176166, 0.12123385317807965, 0.12017145933041851, 0.11939654274295462], [0.13396208419472186, 0.12374761084946026, 0.1295072392700107, 0.1318056065657246, 0.13382306697863874, 0.13078481591240421, 0.15097487621180253, 0.13898966205253679, 0.12337705292622421, 0.13412707059541884, 0.13978506911177599, 0.13177199783778201, 0.13703585264626308, 0.13879657425529029, 0.13165511437362282, 0.1329676850891498, 0.13469300145588442, 0.13632892708765534, 0.13903467073419426, 0.13125352515173969]], 'Rp': [[0.66290716143209838, 0.70434367912350049, 0.72072780924497892, 0.62514076755543246, 0.64271004148857758, 0.61714173919210513, 0.66409483544772185, 0.65450707231870164, 0.68819349802880059, 0.57557821491365535, 0.653030898987361, 0.65530559864462146, 0.6968241862128105, 0.66993735923551512, 0.65463966698771558, 0.75229637918956405, 0.67577717287610017, 0.65729091769688697, 0.64825431252192667, 0.72841836830713658], [0.65671352083088963, 0.67424175519498131, 0.65216300808965932, 0.65736277231166251, 0.65454922609826061, 0.65097716803817551, 0.64335711029982312, 0.64130127136167503, 0.67027524206258204, 0.67825470366054574, 0.65181997873631459, 0.66440725416133606, 0.67800603369385959, 0.62012926485023745, 0.67965864850707502, 0.64090145697165812, 0.66161865465027536, 0.63649310959875438, 0.65063051458424193, 0.59293916644516087], [0.67627971984844704, 0.6715501423442255, 0.63826277754200889, 0.66324294306525455, 0.66122853161569661, 0.61077080655598825, 0.63613950073646552, 0.6712614093021978, 0.64505007657006386, 0.65337762274889488, 0.66629787840901111, 0.64445150301041476, 0.64831838063109937, 0.64573345593455478, 0.64905556580383872, 0.66977835244756245, 0.65154379114583449, 0.66465872426987505, 0.63602734255989579, 0.64053914593082983], [0.62908000561272581, 0.64184483039010676, 0.66086930285527146, 0.662046253541695, 0.64066571611945478, 0.65664323741747121, 0.6446854241234935, 0.65885484030980801, 0.62154082403551336, 0.64413872717880993, 0.64226769099734238, 0.6425925884302448, 0.64497360010319882, 0.63912876949887931, 0.64287124616522873, 0.65972869609674933, 0.66761719616235837, 0.66854831451664865, 0.64825559236251884, 0.63985713441385483], [0.63942169967301155, 0.64031310292823951, 0.65287262798887968, 0.64643789671438945, 0.63632733399072927, 0.6443925500767812, 0.64929836445668965, 0.64428157955561782, 0.64516501414099281, 0.64703787464345275, 0.64646052935047726, 0.6242859532996422, 0.63035605844893117, 0.62575002794459078, 0.63478515946230951, 0.63024579016417925, 0.63695151558748153, 0.64009968740492318, 0.64076803336273858, 0.63127597540814651], [0.63973511557361007, 0.6301556456351074, 0.63145684029893601, 0.6379608444253857, 0.64660332362210293, 0.64013676522770613, 0.63802323129945782, 0.627230599398652, 0.64452132781779747, 0.63805610088881204, 0.64269647605587421, 0.63577140391877229, 0.63696500936577383, 0.64667110250513371, 0.64349126387356281, 0.63493062266114209, 0.64268547731643977, 0.64257298158759268, 0.62986660355879787, 0.63419666732441549], [0.62434412956068164, 0.62836799845061497, 0.63493226123626034, 0.62388180279776573, 0.64618412039393591, 0.61887675036244105, 0.63765256754003063, 0.64038743053624136, 0.61469583381404502, 0.63007476566324816, 0.63689747711836331, 0.63448874375106079, 0.61880468005025691, 0.63969443547637728, 0.64151566957289019, 0.63474347997309866, 0.63183243212105278, 0.64141753940874857, 0.63123004834226581, 0.63821698983440522], [0.63217486242931198, 0.6252895662352469, 0.6216039267392286, 0.63262598749221455, 0.62288332415152825, 0.62087870859598804, 0.62516642715187798, 0.61762486302428898, 0.61977734613638802, 0.63009311762073472, 0.63101155943240861, 0.62565657725593316, 0.62771234761372952, 0.62790658496466911, 0.62539768450672428, 0.63718936698247342, 0.62109977986850384, 0.63188420864029982, 0.62318391274791152, 0.61036350774707404], [0.6251969112589052, 0.62160651040204395, 0.61734657942924953, 0.62892796157431041, 0.62170785786220162, 0.6077923451653221, 0.62509635150372889, 0.61688674143680844, 0.61600328560917417, 0.61425500390191023, 0.6232418746663908, 0.61464251794119895, 0.61500642383908666, 0.62779833026771836, 0.61938929058231129, 0.62188467162286043, 0.63493146690531255, 0.62458638182076553, 0.63206323680739296, 0.61682828329560657], [0.62577686627724471, 0.61062143402467306, 0.61314802450573447, 0.60685897274552802, 0.61847456835045134, 0.61452248418182231, 0.61158048307280743, 0.62612660226052474, 0.60480565649565587, 0.61681464747048464, 0.6131603804868081, 0.61525130585814491, 0.61719905457958579, 0.63005160975717189, 0.6218034840528448, 0.61058563749376515, 0.60832856042731154, 0.60934027759249965, 0.60930566202239655, 0.60692078737730204], [0.57524365831127067, 0.59409121748460769, 0.60957194244426138, 0.60996449377348694, 0.62044397887293334, 0.59288464939904573, 0.59314551394342463, 0.61455721314955136, 0.61171062805864596, 0.59368279597657336, 0.59632116479891562, 0.6003812512608856, 0.59177225939057243, 0.61393840589095094, 0.61702645815791546, 0.59583604353918684, 0.5977241980630762, 0.60043274000996916, 0.59995405372804944, 0.60653623660149458], [0.59031833125418598, 0.59844153486721963, 0.58921446661164678, 0.6088079726497635, 0.58472387848065399, 0.59448932087738804, 0.6014807491600942, 0.59164310251879082, 0.59528293909781815, 0.59808468094780398, 0.59745165265368672, 0.60272804952246639, 0.5877660215285786, 0.58599785369637414, 0.5886911215688112, 0.59075666322955578, 0.59909535820910009, 0.59644725637019003, 0.59198229123950108, 0.58509102495628684], [0.57139255263351274, 0.5834865753499876, 0.57146869331511674, 0.57800294813275821, 0.58057943003004309, 0.57856252255554341, 0.58656028747122213, 0.59578234255441664, 0.57747076314192503, 0.57391443927159047, 0.58051600679454318, 0.57631961019887734, 0.57352184226564784, 0.56935609485984229, 0.57412999541910692, 0.58946015788027151, 0.57882427935588943, 0.59226168418234981, 0.5829315636091621, 0.59257984351568893], [0.55356502830259979, 0.56529827880693573, 0.55346750047536319, 0.57085837153774466, 0.54518497070632377, 0.55256552538169024, 0.57112601027363297, 0.56791197266935312, 0.56342292588213427, 0.56160953439435901, 0.54639276973822093, 0.55004160439289373, 0.56452837547564361, 0.55915508649049139, 0.5486451744034736, 0.5649450149587002, 0.55287291290592644, 0.56475663737203408, 0.56617691509228107, 0.56469871805758587], [0.53964673522321194, 0.54062401114105096, 0.5272188125217494, 0.54757159691169921, 0.55557573515436209, 0.55091040004048142, 0.53918561256909947, 0.55900973099897544, 0.5340848855768624, 0.54334286850907254, 0.54119766978229, 0.522016292015127, 0.52688852736982528, 0.52726462907160976, 0.53247500697556172, 0.53938659564014879, 0.52688073302584637, 0.53845842462141014, 0.53621688581865623, 0.54812418278643982], [0.49008847656921373, 0.52381430602504331, 0.51655933427439005, 0.50859420761260488, 0.50007492920585561, 0.51293759443758014, 0.47714678249920045, 0.50227098058256203, 0.53339943505323872, 0.49575822825133492, 0.50139366043830613, 0.51425664195311871, 0.49537553877091184, 0.50020892696463537, 0.50769362270157858, 0.50668713875090021, 0.51410906818266289, 0.50999185223211285, 0.49949658996317281, 0.50625280994901123]]} 
average_performances = {'R^2': [0.44210735683439806, 0.4248211359826312, 0.4242514551444014, 0.41805922367572473, 0.4070260581349783, 0.4056359764007446, 0.39691336775984165, 0.3874969024606047, 0.38177020993691463, 0.3721735062272471, 0.3545635340645275, 0.342658764413308, 0.32046170340415553, 0.2841694578152736, 0.2458190456104447, 0.15661883241637106], 'MSE': [0.090133393987811672, 0.09172236800945345, 0.091415533088841636, 0.092210942647179869, 0.094284940754496588, 0.094778852177365563, 0.095682823606033154, 0.097311340734408308, 0.098488639091693392, 0.09997926321976662, 0.10283510450963029, 0.10446993529665516, 0.10826230352758262, 0.11399900785909986, 0.11998147105681048, 0.13422107516501497], 'Rp': [0.66735598397026052, 0.65278999300735852, 0.65217838352360791, 0.64781049951656877, 0.63932633873011024, 0.63818637011775348, 0.63241195780018911, 0.62547618296682672, 0.62125960129461499, 0.61453382495163789, 0.60176094514274081, 0.59392471347199582, 0.58035608162687458, 0.55936116636586941, 0.53880396678767406, 0.50580550622087173]}
'''