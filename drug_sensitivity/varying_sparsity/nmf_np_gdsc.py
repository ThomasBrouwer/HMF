"""
Test the performance of NP-NMF for recovering the GDSC dataset, where we vary 
the fraction of entries that are missing.
We repeat this 10 times per fraction and average that.
"""

import sys, os
project_location = os.path.dirname(__file__)+"/../../../"
sys.path.append(project_location)

from HMF.code.models.nmf_np import nmf_np
from HMF.code.generate_mask.mask import try_generate_M_from_M
from HMF.drug_sensitivity.load_dataset import load_data_without_empty

import numpy, matplotlib.pyplot as plt, random

''' Settings '''
fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]
repeats = 20
iterations = 1000

init_UV = 'random'
expo_prior = 1.
K = 2

metrics = ['MSE', 'R^2', 'Rp']

''' Load data '''
location = project_location+"DI_MMTF/data/datasets_drug_sensitivity/overlap/"
location_data = location+"data_row_01/"
R, M_original, _, _ = load_data_without_empty(location_data+"gdsc_ic50_row_01.txt")

#''' Seed all of the methods the same '''
#numpy.random.seed(0)
#random.seed(0)

''' Generate matrices M - one list of (M_train,M_test)'s for each fraction '''
M_attempts = 1000
all_Ms_train_test = [ 
    [try_generate_M_from_M(M=M_original,fraction=fraction,attempts=M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]

''' Make sure each M has no empty rows or columns '''
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms_train_test,fraction in zip(all_Ms_train_test,fractions_unknown):
    for (M_train,M_test) in Ms_train_test:
        check_empty_rows_columns(M_train,fraction)

''' Run the method on each of the M's for each fraction '''
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms_train_test) in zip(fractions_unknown,all_Ms_train_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for repeat,(M_train,M_test) in zip(range(0,repeats),Ms_train_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
    
        NMF = nmf_np(R,M_train,K)
        NMF.initialise(init_UV,expo_prior=expo_prior)
        NMF.run(iterations)
    
        # Measure the performances
        performances = NMF.predict(M_test)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
 
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)

'''
1000 iterations
repeats=10 
fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.5060407585284845, 0.5333029308536477, 0.5660821396803861, 0.5137703787512382, 0.49743459828016856, 0.5669949001145442, 0.5328920856008045, 0.5191225983808463, 0.555947819431266, 0.5521915852926196], [0.5353482719877596, 0.5136404101319185, 0.5507475327656193, 0.534602809669845, 0.5507852488934213, 0.49960367369528125, 0.563375763464464, 0.5762588602197325, 0.5460698716923946, 0.5815914374647371], [0.5413235830967862, 0.5435399168135089, 0.5369243182516463, 0.540513760265547, 0.5422711283731333, 0.5320805062153848, 0.5425019475576691, 0.5260824335769881, 0.5615687036012784, 0.5082806822547911], [0.5199749336034657, 0.54941254535977, 0.5264677795943207, 0.5243271107886658, 0.5401872957128717, 0.525558314127241, 0.5133127267335235, 0.5306185646853838, 0.5448813253122764, 0.5314537630275766], [0.5306562348444082, 0.5093274679339992, 0.4916921852081604, 0.501363411557203, 0.5228836878361556, 0.5170831672581779, 0.5253806533287051, 0.5271145913260202, 0.5515294909667621, 0.5041927634873182], [0.538108582572649, 0.5386914358694668, 0.5014027795655667, 0.5271336447678613, 0.5192723339727278, 0.4776226718649689, 0.5237195269209831, 0.5112992943523629, 0.5186291310310054, 0.5215940202617795], [0.48932083944897653, 0.4894941140910466, 0.499325782562852, 0.4849452698937615, 0.46495204228439535, 0.48152148111551807, 0.5053567072328169, 0.4766432746544387, 0.48203139593765987, 0.488428163090442], [0.47303349347746415, 0.49948915687121176, 0.4729960182241406, 0.4874696492182983, 0.46612324370865044, 0.5012274653330921, 0.48536010756879666, 0.486785565486214, -0.05336260639755719, 0.4589329859109218], [0.4286950422674076, 0.47212032600126064, 0.4738216598729905, 0.47746221887939155, -0.08023051647942459, 0.44381802425038686, 0.45846300364364967, 0.4745212734390918, -0.2783343381771637, 0.4691930963026597], [-0.12079422316204314, 0.41148222026951087, 0.42999039612322854, 0.38733334403224584, 0.39019657533009855, 0.28866990505404466, 0.39878571826657006, -0.12226363087425818, 0.41504534216039657, 0.41300696875144505], [-15.586261023257677, 0.28658008557054204, 0.3299359483728901, 0.24254343064608652, 0.22352930901244128, 0.3299037909466137, 0.024224736701983662, -567.3675272143224, 0.0682473661574764, -4.846320524734421], [-1188661.821222181, -0.9307448264729832, -99.17123266808007, -15.21792039294833, -0.07816292026035443, 0.13133157072106905, 0.13267755619808974, -2.7032089081133517, -3.808632155534461, 0.14283198640511452], [-0.17768235700969126, -28421.619551367272, -32494.20575735634, -3902.0031605461163, -1206782.4303194135, -4.664829858847253, -1775.8925601829337, -0.28610945794340736, -57523.119147280304, -1547531.237535557]], 'MSE': [[0.096760538665035423, 0.090324488184432963, 0.086316216141761201, 0.09639894270408271, 0.099378582071684374, 0.088851297131436011, 0.09318172025369989, 0.096236105311380979, 0.0885577668074983, 0.087216168812378383], [0.092155335788594417, 0.097798143248055414, 0.089822746851471014, 0.093560685394138768, 0.089975355210008739, 0.09934791027095502, 0.087023022204003778, 0.084208765073924441, 0.090857959005191252, 0.083108965030300186], [0.091113434243296806, 0.092752679383306558, 0.092069408614374654, 0.091211566681915851, 0.09134889949902246, 0.094833404794292933, 0.091405461632530119, 0.094599279254931126, 0.087516016532757313, 0.097165531291851931], [0.096287095130200132, 0.089683748662104906, 0.093589493118144088, 0.095244388962619997, 0.091044400578677395, 0.094229105246533648, 0.096578071431975124, 0.093733800203385467, 0.090326922571444965, 0.092895447209534118], [0.094009853102214283, 0.098209408117003807, 0.10148795096447902, 0.0998082078243199, 0.095052325040520053, 0.095766238893703753, 0.094377060712564409, 0.094530392822133644, 0.089077690412530997, 0.099003813827430079], [0.091984019577862397, 0.091942364919121777, 0.099596354082737676, 0.094798244498704914, 0.095787921952934549, 0.10479939503334078, 0.094295447297515975, 0.097633472947215749, 0.096090208503715427, 0.094883749700071879], [0.1019944897418615, 0.10144226838736421, 0.099588911856066165, 0.1024209085965252, 0.10649188092320717, 0.10383896574756574, 0.098695190286347365, 0.10409256037651406, 0.10372733057214543, 0.10167882864195951], [0.10511209250063071, 0.10017617263803127, 0.10498811278562427, 0.10267905478576936, 0.1063264169715642, 0.099497647142122794, 0.10246688508032635, 0.10281694451253477, 0.2108173758808948, 0.10811212299784881], [0.11369657949356118, 0.10605527809535809, 0.10498125277954119, 0.10462458276653122, 0.21558385704954192, 0.11088407217274315, 0.10749821427187763, 0.10502861531826606, 0.25603278128213802, 0.10553777222653252], [0.2244129572693376, 0.117544560032038, 0.1134249058784559, 0.12220792050062043, 0.121357557528417, 0.14080197410126366, 0.11983387593407878, 0.22406814853736512, 0.11684092732753446, 0.11686433879934108], [3.3047994172491286, 0.14216680618796254, 0.1335687067101429, 0.15116688223249158, 0.15470559120679581, 0.13332554624116352, 0.19507440763848435, 113.26023859056689, 0.18585341834616484, 1.1692745172032815], [237434.75629302333, 0.38580731994270689, 19.918137636333764, 3.2302457065538666, 0.21461866719342804, 0.17315837861905781, 0.17311674523923068, 0.73939416731584195, 0.95959115410932594, 0.17114335946849676], [0.23483483943512395, 5660.3399970662231, 6471.2825482423459, 777.43449043939904, 240758.34687214188, 1.1305497899600496, 354.69513419505415, 0.25658072898424977, 11475.777657530738, 308294.049490089]], 'Rp': [[0.71936774493401445, 0.73601788610757934, 0.7558103085462351, 0.72175443462117383, 0.71488333997081333, 0.75620751626722238, 0.73542856114543886, 0.72710324944228288, 0.74791265957935438, 0.74773224990154097], [0.73532579050929947, 0.72105867731621565, 0.74510011085101724, 0.73392044181579441, 0.74453219420196826, 0.71693432646959865, 0.75291020130832909, 0.76258153026675313, 0.741607917978652, 0.7649079795229603], [0.73988489974167526, 0.74066964916274924, 0.73690922692076644, 0.73973414766407564, 0.74035025240224794, 0.73350795305658445, 0.74015270355217611, 0.72966064218429305, 0.75100944921140877, 0.71826572210447603], [0.72678618043073806, 0.74402781107491023, 0.73303250924590868, 0.729702362725693, 0.73981588669015097, 0.73059280062328491, 0.72255324238049057, 0.73275946455891061, 0.74274389135903229, 0.73274352262972642], [0.73375684699666788, 0.7209571063582888, 0.71166272473410186, 0.71586576438512772, 0.72972613937233566, 0.72482147875456648, 0.73069472316210948, 0.73397198882758874, 0.74625415236094816, 0.7197409809858144], [0.73781326157856986, 0.73952713758763655, 0.71922970543752651, 0.73214862002733538, 0.72817286728340491, 0.70590737603396492, 0.72986192308613962, 0.72271809059891878, 0.72857152093410316, 0.72844919814905074], [0.7090030922591557, 0.71124066684141063, 0.7196460201647048, 0.70752265540125481, 0.70226122892012366, 0.70458381341803789, 0.71961433658583285, 0.70666099835355878, 0.7067652407499958, 0.71019218836891107], [0.70278043766541498, 0.71791032283735901, 0.70535447163171061, 0.71019389000639566, 0.69926174325538604, 0.71806839386349686, 0.70938963329904337, 0.71076921039046792, 0.54653432731718321, 0.69705302673219083], [0.68446388118227797, 0.70243049516425538, 0.70399575649984192, 0.70686373641365519, 0.53602519485722488, 0.68679951948732609, 0.69633473310859773, 0.70482050513513361, 0.50361525577634891, 0.70068933449250448], [0.51711941342211432, 0.67404256817611741, 0.67919988791866381, 0.66376288087402158, 0.6676404294667303, 0.62446674646254263, 0.6646425729679396, 0.50964386856596977, 0.6718736700598823, 0.67896154448486568], [0.16865969467316133, 0.61730645521328054, 0.64528336160044697, 0.61092086241950982, 0.59331726324419698, 0.64515944937029557, 0.55208083043186262, 0.050842322101870847, 0.54386367722875417, 0.25599369973762803], [0.017812336829178117, 0.42023736151618452, 0.1019380477580181, 0.15147683029764161, 0.11841864086602573, 0.57499480063689801, 0.57172941885038375, 0.28957928089971424, 0.28236882475112379, 0.57574772978988564], [0.10198214161157389, 0.012119784883604951, -0.0064491381963088191, 0.036109417980537052, 0.039182938294302284, 0.26633310110718644, 0.033367438935612156, 0.084046302464303044, 0.0082023116624770406, 0.034751568836944781]]} 
average_performances = {'R^2': [0.5343779794914005, 0.5452023879985173, 0.5375086980006734, 0.5306194358945093, 0.518122365374691, 0.517747342117937, 0.48620190703119076, 0.42780550794012323, 0.3339529790000251, 0.2891452615951239, -58.62951440949065, -118878.33242829393, -287843.56366533774], 'MSE': [0.092322182608339007, 0.090785888807664306, 0.092401568192827993, 0.09336124731146199, 0.096132294171689989, 0.096181117851322107, 0.10239713351295562, 0.11429928252953474, 0.13299230054560912, 0.14173571659084522, 11.883017388358251, 23746.072150615815, 57379.354815506304], 'Rp': [0.7362217950515656, 0.74188791702405887, 0.73701446460004527, 0.73347576717188445, 0.72674519059375497, 0.72723997007166508, 0.70974902410629859, 0.69173154569986484, 0.66260384121171656, 0.63513535823988465, 0.46834276160210064, 0.31043032721950536, 0.060964586758023284]}

repeats=20 
fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.5201448934681467, 0.5125982375267846, 0.5641537240636526, 0.5467003006396864, 0.5556667607963813, 0.5162559434243277, 0.5150956381703964, 0.5078462471766548, 0.5098558266729647, 0.542565525176951, 0.5853666344305902, 0.5586792247169428, 0.5807432788391854, 0.501800886427331, 0.5369119357795665, 0.5301268489510764, 0.5508563609176524, 0.5728468840038431, 0.5338024485125263, 0.5491019782527407], [0.5643881156582491, 0.5315507490424121, 0.542729388683836, 0.5412204576012563, 0.5632398344912629, 0.5269046061032847, 0.5240043944057464, 0.5339858153758081, 0.5506154362146728, 0.536981800535451, 0.5543723689070977, 0.5681990298740665, 0.5278336271673015, 0.5478367199803761, 0.5284133765747616, 0.5416741833718666, 0.5692800668735043, 0.520303750194009, 0.5333907043240846, 0.5491429706327229], [0.5427097170881978, 0.5423718680408375, 0.5219664234821864, 0.5444121688672365, 0.5364274714774815, 0.5390054343957734, 0.5470846685406505, 0.4464259227241295, 0.5387828836797348, 0.5482440941042177, 0.5489780337474283, 0.52464630502529, 0.5522328313089453, 0.5445319018246111, 0.5595103619432187, 0.5449160034576597, 0.5546743566538004, 0.5295862422235177, 0.5228300640328061, 0.5416960616005765], [0.5484408888035746, 0.5164059867202248, 0.5269268521256332, 0.5524214752237613, 0.5131938435693779, 0.5476332976598064, 0.5227315626543274, 0.5519335249087709, 0.536342288786475, 0.528998482120175, 0.5340443591492886, 0.5265037661677936, 0.5231360995612536, 0.5487501870280473, 0.5213485418708622, 0.537464119507947, 0.5235025142189942, 0.5493393109872253, 0.5291514553000034, 0.5529348111397894], [0.5384053033198243, 0.547964159913614, 0.5232238294720661, 0.5319372559917868, 0.5078613656885099, 0.5136989914381929, 0.49481888236465665, 0.521519651988706, 0.546448699715067, 0.534080473397781, 0.5139588156350281, 0.5333435448689949, 0.5248066813009995, 0.5285492520249626, 0.5229450738782544, 0.1437890479162507, 0.5309360777725003, 0.5254150734113856, 0.5744744232769299, 0.5037936968091594], [0.525940175683458, 0.5214384295957323, 0.5073696989838375, 0.5330834704866136, 0.5073362908665937, 0.5201807120870913, 0.5175265330351078, 0.48929489774158885, 0.5181352640619341, 0.5273062140930483, 0.5191460046232246, 0.5232380648411554, 0.5345711063269334, 0.531103703151605, 0.5037303474363304, 0.5070111048218564, 0.4823764122866274, 0.49845273579435256, 0.5193284822857067, 0.5225644989796975], [0.5065474662976608, 0.5093471011366226, 0.49127147973985597, 0.48983809456999006, 0.5225671966075589, 0.512575697591165, 0.46360388186011503, 0.5022513305761707, 0.5055126153809868, 0.49425817292522933, 0.5071399618067769, 0.476110399697003, 0.4683019036299333, 0.5170704596200916, 0.5068561342846098, 0.49010034440714, 0.46174285181539254, 0.5056504492120593, 0.4958533826227135, 0.47608509375569363], [-9186.610174050478, 0.46072757063425873, 0.48909112347414163, 0.4691981321601767, 0.5016708673821213, 0.4954630169981392, 0.48048432817984643, 0.4684406664524472, 0.482045372598766, 0.47859383256393184, 0.4654741602436414, 0.4899845786957475, 0.4301904247278948, 0.45892430786636496, 0.4699636792460644, 0.4837843788720546, 0.492066163213459, 0.45682373429426426, 0.48962182945938504, 0.44982416940001013], [0.44629966842095037, 0.47897140776999125, 0.4726321474714814, 0.4321776537160803, 0.4457793732137333, 0.057836920214214826, 0.4349699827784703, 0.4635941692712392, 0.47042573760703155, 0.44569506451399543, 0.43524661992411595, 0.43775496867686325, 0.3939097221250003, 0.4602009101753276, 0.33694467462520183, 0.4346498289626203, 0.4537234257345638, 0.43728741420387907, 0.4550545559361102, 0.4440000083799859], [0.39376852278817576, 0.3918221857961631, 0.4233864725567329, 0.39403986539923086, 0.4086969401908559, 0.4109251956447654, -0.022052988572861087, 0.4314829525014926, 0.4021012269538774, -3.6518308008235723, 0.44145543993561553, 0.3842661422332678, 0.4258747074982113, 0.2727153642900092, 0.4104991636474612, 0.22935898109668273, 0.3782478302965564, -7027.252029895745, 0.40181420798090317, 0.40622615497955805], [0.2889529801297278, -406.6363668012016, 0.32058780291174493, 0.27681295223915525, -123.92041492004306, 0.21190053132625397, 0.35774931193225257, -0.20261895060678037, 0.04226340786964877, 0.36700713574689436, 0.2800521991532049, -0.03151295574511548, 0.3371884590723051, 0.07038656804881505, 0.2751681417671107, 0.3025760491150573, -0.03873368711783143, 0.30699115900680407, 0.2453659788815522, -0.09095489058146167], [0.2564885553911739, -3.659114163769031, 0.06984441420575471, -0.12115022010068488, -42.4925459862154, -148551.5933833709, -0.05056174121741108, -0.06845185284896815, -0.16751722639596411, -1.1853524428453555, 0.10487611791572238, -31.57644171707775, -33541.92502373046, -0.07111483029731014, -1559648.925125013, -0.0623234509775934, -18481.195924292766, -0.06711879889670813, -563.8245352668664, -13.872206477515604], [-1963804.5038772644, -0.1966976760369965, -0.16890281572880328, -867.1659759187903, -2570.496658052446, -0.16054048763679507, -0.20153316679117617, -1407.5245412439708, -43.084091695809335, -10.389197162142684, -0.18723391502915243, -4.068082556462661, -48.695443342193805, -0.148331251651308, -0.22776206453089953, -0.5209184281918395, -0.1260861371423283, -0.23237906000161646, -0.1713582210446174, -782080.6429228917]], 'MSE': [[0.096771539825025385, 0.09550116278454264, 0.086533626870375066, 0.090987609903334418, 0.088734583509351816, 0.09661071944921848, 0.095707934563477107, 0.096726940451754881, 0.095867185420751413, 0.092153761011523352, 0.084690838730362192, 0.08594633859134454, 0.083268894391814105, 0.099909113350702849, 0.092010324466794122, 0.093959509636635824, 0.090186856726371278, 0.08399989907755126, 0.090961744121423813, 0.088703230570244207], [0.087377821073593417, 0.093713808293186693, 0.091914966154114486, 0.091283683785687214, 0.08765445357374349, 0.094315910812475728, 0.093112742302016105, 0.093483630664411108, 0.089708616881468237, 0.093881968227097198, 0.088760777691283543, 0.085922232482435246, 0.093627214396016498, 0.092156425159118302, 0.094610511412138928, 0.091156581455759333, 0.086483260675241341, 0.09535339193594769, 0.093363941128963332, 0.089505666775489698], [0.092733983821967417, 0.091538861906718713, 0.094684711258231691, 0.091258039833785179, 0.091815764373762224, 0.092590296028410596, 0.089401212658658136, 0.1100143554466866, 0.091918439057085119, 0.090264145876984683, 0.089325382130767017, 0.094646971273430913, 0.090451554515322413, 0.091380438009842857, 0.088230467807233912, 0.090613300868443616, 0.088876755059581661, 0.094826604283996918, 0.096038728135118642, 0.091440232794335607], [0.090622669105703144, 0.096188678341353806, 0.094489129357959459, 0.090086640596316853, 0.097061191549178041, 0.090394635138562163, 0.094656424904996789, 0.09003213175695006, 0.091982975250161705, 0.094269770959828136, 0.092403675738758323, 0.094233598920146516, 0.095445001776706659, 0.090188086082890098, 0.095862926919860758, 0.091949039319331238, 0.094200408088769241, 0.089568382988438097, 0.093134689741112942, 0.089157881898669564], [0.092462505506534245, 0.090183683931543066, 0.095487304192051231, 0.093721926924126564, 0.096876336623816534, 0.096144109075083029, 0.10011331955041981, 0.095685342318209618, 0.090851352537547558, 0.093437072744695926, 0.096298304221984793, 0.093853664137132267, 0.095024377173227897, 0.093956405013914709, 0.095129283774472037, 0.17234862659604774, 0.093591286641790505, 0.093864777601906438, 0.08500914187582953, 0.099444876723779982], [0.094668004113275417, 0.095381799265801148, 0.098192911507612765, 0.093294966051333361, 0.09806130825746355, 0.096266205828880694, 0.096480636042160908, 0.10145138977876689, 0.096670887753549373, 0.094341041048517205, 0.095638041221050421, 0.094967287157461749, 0.093331257578058102, 0.093643471233699135, 0.098636075819740654, 0.098072332710758339, 0.1039629980166209, 0.10035159762007165, 0.095853654723431589, 0.095466938411141233], [0.098769760185768149, 0.098057360528274018, 0.10104952717632423, 0.10126709013946063, 0.095378028434727452, 0.096843294671461244, 0.10621175234626526, 0.098910737948122371, 0.098031140625587293, 0.1019290397565589, 0.098434839826974138, 0.10409898256552645, 0.10602049203284823, 0.095786422206117397, 0.098567207659480655, 0.10142028410993771, 0.10715144728131817, 0.098563926047701811, 0.10037061371685314, 0.10437408346843653], [1850.602009081691, 0.10762995710306515, 0.10169381150700238, 0.1056617582232976, 0.099628476485857681, 0.10039539833375402, 0.1039106270099865, 0.10600170533748542, 0.10301894924943793, 0.1036165818004694, 0.10669427181071059, 0.10134910914818542, 0.11362177758386478, 0.10782015800448068, 0.10551890624785797, 0.10301584083252224, 0.10139039770136314, 0.1085791291657652, 0.10156726610512078, 0.11026452542088566], [0.11071479843962517, 0.10367392366641558, 0.10508318356507028, 0.11305191119530771, 0.11025772184945017, 0.18765708261555511, 0.11308709861223995, 0.10754239055518397, 0.10578954521259862, 0.11021742509972558, 0.11230931672557218, 0.1117175019534674, 0.12097317168213075, 0.10772730656493444, 0.13300775728541706, 0.11289235982912292, 0.10908648205177685, 0.11219239349379187, 0.10824464251410618, 0.11031236891029662], [0.12063900459741833, 0.12143974729418697, 0.11529329797771033, 0.12091477350747981, 0.11788781675423354, 0.11796615044098838, 0.20318284413068605, 0.11310723039809156, 0.11945630071544483, 0.93292115423986599, 0.11194882724921491, 0.12274875749251327, 0.11451757509112755, 0.14551067594400538, 0.11748283987543892, 0.15415488036400773, 0.12362793107989317, 1401.1115698231292, 0.11965080758290182, 0.11832885812545728], [0.14209397219839665, 81.444106064052136, 0.13516016762643265, 0.14448046446473475, 24.90519661052171, 0.157139844953846, 0.12839053944313789, 0.23933222872915833, 0.19104285732895884, 0.12610651451324048, 0.14349239953121504, 0.2064415994221997, 0.1320266815449091, 0.18546010069971411, 0.14456735510413896, 0.13840774096948014, 0.20744794891929924, 0.13759198686505417, 0.15061062952836671, 0.21775361333717108], [0.1479494130556645, 0.92902191022139702, 0.18538831278915299, 0.22340459473373112, 8.6705611374039808, 29610.971557583533, 0.20925224653568261, 0.21289005017442059, 0.2335638968176551, 0.43606575000082876, 0.17881760935393856, 6.4924426079608404, 6705.7579740420861, 0.21313481643431875, 311078.75550426356, 0.21153937878283602, 3683.8008471359258, 0.21260561828960634, 112.23731071451979, 2.9657107609797611], [391572.660852751, 0.238126634982955, 0.23266054422112201, 173.29749168541366, 513.07778302334566, 0.23200890517666203, 0.23946607707490758, 280.7515823101113, 8.7920722114181302, 2.2715915751147886, 0.23711691105011731, 1.0119017276587536, 9.9199082053337442, 0.22900209500465576, 0.24466020475120231, 0.30296526404652496, 0.22444756737276927, 0.24492221944607523, 0.23355041927320802, 155894.05385013163]], 'Rp': [[0.72898292254118591, 0.72006000912424284, 0.75588296725683568, 0.74347202338739948, 0.74697938625598648, 0.7245899076451906, 0.72376152417476247, 0.71788947084148169, 0.71834297609627884, 0.74015046527597883, 0.76566140209983957, 0.75088429337916296, 0.76678061668612063, 0.71290070715931164, 0.73566772439235395, 0.72976236471415046, 0.7465900148161162, 0.75930927875465215, 0.73349307676780207, 0.74724280894991857], [0.75438341607441117, 0.73367418349439928, 0.7400640779313219, 0.73871537948018318, 0.75223544537427167, 0.72956970840521274, 0.72760076892626202, 0.7340080156664992, 0.74439528851095171, 0.73674680902495415, 0.74596098819109702, 0.75530036344158635, 0.73193466825862963, 0.74469007752261818, 0.73132714533555332, 0.73890890385192953, 0.75684059056263175, 0.72755749274220072, 0.73423829579401778, 0.74273956000318797], [0.7389896194809269, 0.74055665726789188, 0.72666927782444024, 0.74172987454863248, 0.73857482218042492, 0.73787187204334626, 0.74451369000491541, 0.6874740021825958, 0.73930880245877195, 0.74335839517054625, 0.74366339515227842, 0.7286302446255154, 0.74631478837662801, 0.74177222687341982, 0.75014460710920605, 0.74103596102792857, 0.74812460646663281, 0.73190343845417671, 0.73095929812849991, 0.74003958798088421], [0.74561361854038566, 0.72589553537937124, 0.73102877489301732, 0.74555881134970658, 0.7227302575443979, 0.74260689816159509, 0.727955760336786, 0.74567102984301203, 0.73629020258396793, 0.73408268133885524, 0.73542709699501307, 0.73110132816213713, 0.72870378614867415, 0.74446685140621849, 0.72785644318438802, 0.7362706189904985, 0.72781781591439521, 0.74439055944070898, 0.73384175526045825, 0.74661096181067643], [0.73867000396912708, 0.74346626325600196, 0.72945136213603812, 0.73524066156482559, 0.7216035377379082, 0.722062119946414, 0.71355972286808533, 0.72772845924686069, 0.74275576557345657, 0.73642156597883834, 0.72481909127453448, 0.73532930614055703, 0.73042096318557659, 0.73085520739909626, 0.72884263176614605, 0.59089281343628952, 0.7339709636485392, 0.73125664581471084, 0.75940050725317909, 0.72290338320167802], [0.73254427928126609, 0.72789253471699, 0.72072649169137137, 0.73493468447825283, 0.72052286533828902, 0.72862745817363794, 0.72537767714262091, 0.70784824724621642, 0.72595247296493359, 0.73127549770441258, 0.72729132861639534, 0.73159040228339578, 0.73649932120676032, 0.73476264322040175, 0.72030145706525361, 0.71973747615465355, 0.70878963898132608, 0.71430981937983384, 0.72795208537812139, 0.72902516854074906], [0.72250553231450299, 0.72294206876608436, 0.71160831705007777, 0.71002579122373077, 0.72943601494565313, 0.722851173451317, 0.69979223332087293, 0.71651242793171299, 0.71904491532473214, 0.71690698365069327, 0.72209175050786545, 0.70197748242390801, 0.70255971516727067, 0.72771662835642426, 0.7205568433799171, 0.71363135058986671, 0.69528595185895004, 0.71958759107635228, 0.71486208391579253, 0.70395046322494748], [0.03804949766553728, 0.69776318202874765, 0.71128122882462019, 0.6990949186572043, 0.71674973736199421, 0.71483788888013122, 0.70525889011020293, 0.7019744495493474, 0.70742867580405944, 0.70559874396791533, 0.6996487363960594, 0.7130681441507869, 0.6808250436202582, 0.69506454324770872, 0.70069418514985504, 0.71008127331074655, 0.7121537911042799, 0.69367449658980762, 0.71264272175005305, 0.69168237889667916], [0.69189645010070577, 0.70959711952936, 0.70226258629855165, 0.68760538941832994, 0.69083406288675453, 0.56442873613597777, 0.68907508435235298, 0.69744350218439977, 0.70382398516902844, 0.68748168789583397, 0.68759583344466058, 0.68696867596444633, 0.67040638902944327, 0.69748669086196569, 0.64357504472085381, 0.68035559506519383, 0.69522457925363079, 0.68649119292044047, 0.69675470711772058, 0.68816731997800973], [0.66484521413720077, 0.66210287720048866, 0.67816464924564412, 0.66995123792981226, 0.6721654195997312, 0.67349816746430502, 0.15167592223918633, 0.68421682583189314, 0.66978173594278867, 0.29387866568450599, 0.68404345977743808, 0.66662421841935715, 0.68075846955203467, 0.62301052962971049, 0.67730463180435763, 0.61173839069625691, 0.65047288567149064, 0.027324366897189274, 0.67354567527487419, 0.67040880635116973], [0.62413820131759912, 0.024485997544478832, 0.63461835882517981, 0.61193684744937937, 0.093584855268470865, 0.60400285211176874, 0.64374497944418896, 0.50100488162099222, 0.5690289330824474, 0.65468890213080499, 0.61550944893918713, 0.14613262856194231, 0.63506571245399923, 0.56116961224653106, 0.61556728334133204, 0.63234929620319491, 0.1367807040647134, 0.63161680514897212, 0.61786910346637247, 0.51326290890474913], [0.60442084027769483, 0.29159494760433974, 0.55467884212838303, 0.10771459305297397, 0.11685943989044023, 0.023006127103242818, 0.1302892398350983, 0.11968921215743485, 0.51837606454747431, 0.40687525701333804, 0.5465910266939048, 0.11858335140929743, 0.038073214854458935, 0.12954322324471168, 0.034272572599868475, 0.1196826288090341, -0.009397269352499852, 0.1292233651524764, 0.047751114956320742, 0.18185879182623788], [0.0069135296482258609, 0.10472541706830829, 0.10959374654093292, 0.056519969564057165, 0.046423062185368902, 0.095849979292165738, 0.083545617504911476, 0.044476840603404406, 0.12155025389067579, 0.19162422672332602, 0.10110804069329467, 0.27994748484924997, 0.12024533442491164, 0.093185007396891242, 0.09352860851042466, 0.061193015844246454, 0.10502919616913652, 0.075622194997478284, 0.090537644673709311, 0.030860404626864915]]} 
average_performances = {'R^2': [0.5395559788973701, 0.5428033698005885, 0.536551640710915, 0.5345601683751665, 0.5080985150092335, 0.5154567073591247, 0.49513420087683846, -458.87989008570077, 0.4218577126860429, -351.2159616165676, -26.361879976404765, -88044.02133407474, -137541.94562666758], 'MSE': [0.091461590672629947, 0.091369380244009354, 0.092602512257018182, 0.09279639692178468, 0.098174184858205657, 0.096736640206969773, 0.10056180153638719, 92.62966938643811, 0.11527691909108943, 70.21611746479951, 5.4638424659876659, 17560.652277092158, 27422.924798023167], 'Rp': [0.73842019701593853, 0.74004455892959586, 0.73708175836788326, 0.73569603936421313, 0.7249825487698931, 0.72529807747824404, 0.71469226592403345, 0.67037862635329959, 0.6828737316163831, 0.58927560746747176, 0.50332791560631529, 0.21048432919021151, 0.095623978760379216]}
'''