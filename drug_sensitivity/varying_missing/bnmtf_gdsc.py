"""
Test the performance of Gibbs sampling for recovering the GDSC dataset, where we 
vary the fraction of entries that are missing.
We repeat this 10 times per fraction and average that.

GDSC has 0.7356934001670844 observed entries
"""

project_location = "/home/tab43/Documents/Projects/libraries/"
import sys
sys.path.append(project_location)

from HMF.code.models.bnmtf_gibbs import bnmtf_gibbs
from HMF.code.generate_mask.mask import try_generate_M_from_M
from HMF.drug_sensitivity.load_dataset import load_data_without_empty

import numpy, matplotlib.pyplot as plt, random

''' Settings '''
fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]
repeats = 10
iterations, burn_in, thinning = 1000, 900, 2

init_S = 'random'
init_FG = 'kmeans'
K, L = 7,7

alpha, beta = 1., 1.
lambdaF = 1.
lambdaS = 1.
lambdaG = 1.
priors = { 'alpha':alpha, 'beta':beta, 'lambdaF':lambdaF, 'lambdaS':lambdaS, 'lambdaG':lambdaG }

metrics = ['MSE', 'R^2', 'Rp']

''' Load data '''
location = project_location+"DI_MMTF/data/datasets_drug_sensitivity/overlap/"
location_data = location+"data_row_01/"
R, M_original, _, _ = load_data_without_empty(location_data+"gdsc_ic50_row_01.txt")

''' Seed all of the methods the same '''
numpy.random.seed(0)
random.seed(0)

''' Generate matrices M - one list of (M_train,M_test)'s for each fraction '''
M_attempts = 1000
all_Ms_train_test = [ 
    [try_generate_M_from_M(M=M_original,fraction=fraction,attempts=M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]

''' Make sure each M has no empty rows or columns '''
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms_train_test,fraction in zip(all_Ms_train_test,fractions_unknown):
    for (M_train,M_test) in Ms_train_test:
        check_empty_rows_columns(M_train,fraction)

''' Run the method on each of the M's for each fraction '''
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms_train_test) in zip(fractions_unknown,all_Ms_train_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for repeat,(M_train,M_test) in zip(range(0,repeats),Ms_train_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
    
        BNMTF = bnmtf_gibbs(R,M_train,K,L,priors)
        BNMTF.initialise(init_FG=init_FG,init_S=init_S)
        BNMTF.run(iterations)
    
        # Measure the performances
        performances = BNMTF.predict(M_test,burn_in,thinning)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
 
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)

'''
200 iterations
repeats=10 
fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.5941929599474387, 0.5968491052848404, 0.6106399966584322, 0.5747983319636255, 0.5569201486639157, 0.6080661505915745, 0.5660788382623474, 0.543287325070379, 0.5797668208719176, 0.6068486259434914], [0.5854150873567245, 0.5473538645539486, 0.5860857495459351, 0.5809250055909023, 0.583538936506822, 0.5671182607151077, 0.5928974813762868, 0.6100612533373422, 0.5920062566668283, 0.6154231900517017], [0.584426987583068, 0.6007306547456885, 0.5840749948347832, 0.6060098519262915, 0.5903258100679247, 0.5712475102433576, 0.5947353926389474, 0.5702207240438959, 0.5943648884675565, 0.5489544600772971], [0.5623650277470954, 0.5849070871787971, 0.5804924711174851, 0.5732629781164881, 0.578603128551517, 0.5787610098537443, 0.5569165734195822, 0.5733106425345196, 0.5872824789307423, 0.5790127020644471], [0.5841364713098784, 0.5625071342284721, 0.553414885900496, 0.5789165174394189, 0.5731507797660512, 0.556302254502138, 0.5751077406587155, 0.5816281033350199, 0.5968467946061626, 0.5795110715580771], [0.5791164622681151, 0.5702055831101803, 0.5561989288056723, 0.5677443893662977, 0.5682371781538549, 0.5763462915449601, 0.5648514179437465, 0.5552940932707378, 0.5711211870692408, 0.5642903260837506], [0.5600743545506364, 0.5531882003202768, 0.5707508378847957, 0.5450334261949854, 0.5526317038021961, 0.5547612246382561, 0.5674035439388387, 0.5516553926888992, 0.546266197179326, 0.5620688066302071], [0.5374947546511608, 0.5472602739400619, 0.544514115223371, 0.5592133260017639, 0.5454578297502141, 0.5603233356008892, 0.5365616005592324, 0.5528884464324122, 0.5509226613333051, 0.5529627836090476], [0.5332495218213473, 0.537312822063635, 0.5308552044036863, 0.5383632208944443, 0.539039104119168, 0.5434649358327914, 0.5242858140533704, 0.5482011544720105, 0.5410834425727185, 0.5559596533852306], [0.5310201375727599, 0.5391145317818341, 0.5362529507763594, 0.5255449871656166, 0.5184708235663289, 0.507319207737583, 0.5065748947322809, 0.5297866171158615, 0.5218270142007155, 0.5285019575594061], [0.5156442765541576, 0.49901073383771577, 0.5091546922445104, 0.49783560565235696, 0.5028484505684676, 0.5132254799405133, 0.5152478868972215, 0.5070112619323204, 0.515729813807532, 0.5126529638284281], [0.5124783202879708, 0.501225727361974, 0.4819650222593641, 0.498130277460641, 0.4908021400994358, 0.49502563542967537, 0.4810226828612414, 0.5023141072004862, 0.49998294123226794, 0.5010983459337773], [0.4857096319886841, 0.47611234976930217, 0.4858708348221581, 0.48312670336859953, 0.48841534632113137, 0.4795168869786578, 0.476013811327178, 0.4856878567658217, 0.490825844994085, 0.48134637581178863]], 'MSE': [[0.079492606864839346, 0.078025770105755177, 0.077452636267685976, 0.084299658933671431, 0.087615755520830604, 0.080423604523058898, 0.086561411311570038, 0.091400113487509871, 0.083807519725123764, 0.076571041280984325], [0.082225481009121873, 0.091018975501313132, 0.082757286043696074, 0.084248346408462502, 0.083414963615133911, 0.0859436689113936, 0.081139086090595211, 0.077491320120495408, 0.081663402568907556, 0.076388925828361459], [0.08255119065371247, 0.081131522628289876, 0.082694839661872133, 0.078210086734722267, 0.081758632070636453, 0.086895414612430208, 0.080969521774811329, 0.085788779789318745, 0.080969514308704568, 0.089128244390265593], [0.087784166193538918, 0.082619007878507483, 0.08291198633479277, 0.085445918442843272, 0.083437941598933557, 0.083662490709301568, 0.087925337630881201, 0.0852083443708683, 0.081911610405968519, 0.083466262719250686], [0.08329772790263093, 0.087565356923330201, 0.089164492148831584, 0.084285005779547215, 0.085037987154454764, 0.087988782769688176, 0.08448893378955119, 0.083633072647305434, 0.080076517174577894, 0.083964098387851765], [0.083817447378352616, 0.085661351621261678, 0.088650651903866881, 0.086656774391729183, 0.086031377854652258, 0.084993451971259265, 0.08615203121935841, 0.08884411586142428, 0.085611858161689161, 0.086415658233183437], [0.087863369407030698, 0.088785660954818726, 0.085381782167658238, 0.09047211324619038, 0.089040787167787669, 0.089170780004054678, 0.086315108629707898, 0.089173093314508317, 0.090863800986810878, 0.087042185583582621], [0.09225423917725796, 0.090614885932062031, 0.090740497409613902, 0.088306105149232456, 0.090526211818751076, 0.087708906506296314, 0.092272460638397877, 0.089573949410881246, 0.089877223218570543, 0.08932376445908749], [0.092888976592316055, 0.092957580570368431, 0.0936021204613144, 0.092430743093878179, 0.091994927348356278, 0.091017812895278605, 0.094432007115192104, 0.090302051728626542, 0.091914672918883111, 0.088286396868607467], [0.093902302181876826, 0.092052579297898729, 0.092279963445974902, 0.094639001363633679, 0.095829577805821117, 0.097522133036692979, 0.098349365016629137, 0.093881543713809371, 0.095511975731774001, 0.093870461899353816], [0.096507495591716563, 0.099834673050447312, 0.097843740150572608, 0.10021779324780293, 0.099053480404210331, 0.096850986330592345, 0.096910359251592582, 0.09823928958375025, 0.096595669534984566, 0.097470275196013312], [0.097382192109762761, 0.099666596405893579, 0.10300653902566025, 0.099961183505811152, 0.10136071643348232, 0.10066043528918109, 0.10358738510469066, 0.09936950774910866, 0.099781378774220122, 0.099611399127216158], [0.10255167301786651, 0.10433177051856955, 0.10238664494083358, 0.10295536833030379, 0.10206328029568754, 0.10387462443996022, 0.10459571708068126, 0.10260602923136587, 0.10157772910609153, 0.10332439105651946]], 'Rp': [[0.77098364527170316, 0.77270381234441532, 0.78144431662644653, 0.75850064237860004, 0.75032334428968694, 0.78010032436497845, 0.75399946431626097, 0.73813375574884565, 0.76380049571423614, 0.77945695492600831], [0.76548948478687462, 0.7402504787587898, 0.76603619334825035, 0.76228039945261727, 0.7639584803230145, 0.75411874600076678, 0.77009380114819559, 0.78224153616485115, 0.76948656223674838, 0.78452930498316353], [0.76516126871301304, 0.77526043970083947, 0.76531768174913162, 0.77877144576975499, 0.76872236853369247, 0.75623102463665126, 0.77140972580145839, 0.75544782122099752, 0.77219219796840588, 0.74233475022403828], [0.75024670658669734, 0.76527893130743474, 0.76275707448322505, 0.75814066074045394, 0.76093384221364613, 0.76097488518179002, 0.74689075479450295, 0.75870827078570824, 0.76641377712589587, 0.76118281886246431], [0.76492038016648556, 0.75070734999194699, 0.74441022103270083, 0.76089069911196028, 0.7579259006188579, 0.74630560117451639, 0.75846164616751066, 0.76293750629590606, 0.7729596881439974, 0.76139651499790295], [0.76122877013832846, 0.75563975656120452, 0.74601459717076768, 0.7535421313476689, 0.75451763599841559, 0.76002905597467341, 0.7523093614047951, 0.74537831380185804, 0.75776983067886072, 0.75140575686027955], [0.74863262493518068, 0.74419392651742322, 0.7558206804249783, 0.73891975329170689, 0.74470854169661593, 0.74487002733490515, 0.75338787336342272, 0.74314428227535279, 0.73992005453826126, 0.75007834758715486], [0.73336796285058115, 0.74006513175696731, 0.73823088304914075, 0.74796431258817264, 0.73905275881335841, 0.74974709735615508, 0.73308976311057827, 0.74366059901479609, 0.74249373388167961, 0.7445877677413858], [0.73245996146080805, 0.73321894140068189, 0.72879082311278875, 0.734254442766619, 0.73465772539407126, 0.73771384595342293, 0.72605102041892411, 0.74120136791494196, 0.73573732928075619, 0.74570983005180214], [0.72891658521309133, 0.73490391845968939, 0.73263239337125885, 0.72597732088028677, 0.72218445032472822, 0.7141828347088689, 0.7132261520509845, 0.72844360061386049, 0.72400013910688665, 0.72711022263458036], [0.71857933591613854, 0.70767278808980139, 0.71434287484692949, 0.70811754700214236, 0.70950338911936783, 0.7173928745414162, 0.71860226854198128, 0.71246953131685131, 0.7184403770470551, 0.71639754022127722], [0.71638834192477951, 0.70829503378686187, 0.69740019716259738, 0.70624291713075049, 0.70316287083305917, 0.70441687613303128, 0.69471567118152611, 0.70980131273825953, 0.70760100226464473, 0.70802099948480901], [0.69903226639966975, 0.69201108037973835, 0.69760963564088074, 0.69648939697131418, 0.69921080039451666, 0.69355475664661959, 0.69145838856496844, 0.69739307385914362, 0.70311582416355245, 0.69595202705071812]]} 
average_performances = {'R^2': [0.5837448303257962, 0.58608250857016, 0.5845091274628811, 0.5754914099514419, 0.574152175330443, 0.5673405857616557, 0.5563833687828418, 0.5487599127101459, 0.5391814873618402, 0.5244413122208746, 0.5088361165263223, 0.49640452001268337, 0.48326256421474073], 'MSE': [0.082565011802102947, 0.082629145609748073, 0.08300977466247636, 0.084437306628488626, 0.084950197467776906, 0.086283471859677718, 0.088410868146215016, 0.0901198243720151, 0.091982728959282112, 0.094783890349346464, 0.097952376234168276, 0.10043873335250268, 0.10302672280178793], 'Rp': [0.76494467559811807, 0.76584849872032712, 0.76508487243179812, 0.75915277220818178, 0.75809155077017853, 0.75378352099368517, 0.74636761119650008, 0.74122600101628155, 0.73497952877548167, 0.72515776173642355, 0.71415185266429604, 0.70560452226403192, 0.69658272500711227]}

1000 iterations
repeats=10 
fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.6056942861099961, 0.6141388200272883, 0.6067842422679758, 0.5722024151393201, 0.5659573322572442, 0.6275376252079007, 0.5842792492830786, 0.5701832256860475, 0.5961138581032752, 0.6027508911953992], [0.5922546710328855, 0.5598584729374989, 0.6009560761917756, 0.5939771667971747, 0.598078590163217, 0.5696803972472531, 0.6009082083010908, 0.627786271882117, 0.6005846406510957, 0.6268699213891397], [0.5963442272157937, 0.6094347196161924, 0.589894904219247, 0.6102150617837405, 0.6010703534424602, 0.5804251879216458, 0.5918035688436817, 0.5788253308687701, 0.5954947597060095, 0.5519789000141476], [0.5746611633110035, 0.5933962525605189, 0.5815482278962333, 0.5714920735524749, 0.5895967783237825, 0.5757961355628876, 0.5604598778336048, 0.5912125383780107, 0.5952213203161516, 0.587119884231147], [0.5904979522243624, 0.5672910537550448, 0.5634004539411592, 0.57967983688392, 0.5790000798059372, 0.5594677648505719, 0.5815176395079135, 0.5829772380345597, 0.5981504925869485, 0.5918263095314871], [0.5860161707859528, 0.5822784116199573, 0.5616262944777345, 0.5810091770487876, 0.5736122101892924, 0.579503298948669, 0.5669099709160959, 0.5645236021487847, 0.5734887437521501, 0.5685896122824796], [0.5585625414333979, 0.5675744587018816, 0.5677114617938179, 0.5568942090655038, 0.562638682056781, 0.5540396750965665, 0.5694445806654373, 0.5603209280827789, 0.5508979450000999, 0.5560198624899944], [0.547982468336409, 0.5536333851954183, 0.5546665310922354, 0.5564331279553969, 0.5543746425222422, 0.5587359631093394, 0.5464693902344706, 0.5518062761190321, 0.5609034796761156, 0.5580589150962035], [0.536124135292638, 0.5293760001105634, 0.542162364828791, 0.5426383291192327, 0.5435442203757485, 0.5484875907082298, 0.5367241879176892, 0.5537711982398842, 0.5468762826069493, 0.5637689553933687], [0.5387001646547449, 0.5431708948599574, 0.5354643289737095, 0.540981089531221, 0.5334855008306545, 0.5261333328452573, 0.5266331845773891, 0.5351332665034829, 0.5319691108239605, 0.5454405953836339], [0.5390221515515623, 0.4988266690773743, 0.5216191920645684, 0.4922771100375053, 0.5132051291210133, 0.5192986201507326, 0.5259505635901128, 0.5006601701945237, 0.5225566403289348, 0.5204431213903798], [0.5144850084892016, 0.5074045390243065, 0.49342703069564786, 0.5034640943106554, 0.5022451589770431, 0.4951689949124579, 0.4972613670516324, 0.5030553425570947, 0.504562818418993, 0.5063237833720282], [0.4911770176574246, 0.483277880044643, 0.4887142445484237, 0.489345253544093, 0.49221957394956406, 0.4846135763051671, 0.4830384075433042, 0.4838998229410586, 0.49441971015343966, 0.4955203013616106]], 'MSE': [[0.077239638560134619, 0.074679521032833041, 0.078219634263829857, 0.084814320374017427, 0.085828719468700715, 0.076428118610352411, 0.082930675124157124, 0.086017542554921431, 0.080547413876135635, 0.07736912526913696], [0.08086897226863525, 0.088504524244606197, 0.079784139131158005, 0.081624417485584119, 0.08050274735522249, 0.085434986299398358, 0.079542478278397666, 0.073968882050540988, 0.079946366373757308, 0.074115248662985078], [0.080183899488038501, 0.079362856828140371, 0.081537716460770848, 0.077375320105920006, 0.079614344756194499, 0.085035371519766784, 0.081555283191719813, 0.084071203439387426, 0.08074397878969268, 0.088530604023659823], [0.085317713381681343, 0.080929346600535884, 0.082703325260590821, 0.085800508176536547, 0.081261163436095282, 0.084251345904607533, 0.08722220540285737, 0.081633399556251013, 0.080335996942911062, 0.08185890734307448], [0.082023519250716867, 0.086607842747417688, 0.087170789100850105, 0.084132218062963823, 0.083872674725438842, 0.087361036955719659, 0.083214338859751324, 0.083363378910137495, 0.079817569478386599, 0.081504966213549995], [0.082443395167291225, 0.083255143519437219, 0.087566518637459553, 0.083997505928167682, 0.084960369910882683, 0.084360092810735074, 0.085744472681301157, 0.087000228600883675, 0.085139251633187807, 0.085562967395597336], [0.088165313600937906, 0.085926977589712517, 0.085986343271625645, 0.08811354417137765, 0.08704907423566427, 0.089315289285376243, 0.085907864639829537, 0.087449569525668777, 0.089936256665467396, 0.08824445965404952], [0.090162293071843008, 0.089339321372127661, 0.088717964337481969, 0.088863083105918964, 0.088750347367483162, 0.088025563533437601, 0.090299779622053225, 0.089790750493589158, 0.087879687024105438, 0.088305492082827078], [0.092316893828761848, 0.09455215202459788, 0.09134615556066833, 0.09157476400401976, 0.091095831901381194, 0.09001646360675436, 0.09196291822956329, 0.089188754549061056, 0.090754446754887891, 0.086733711078648287], [0.092364555507456592, 0.091242402562768374, 0.092436889492713212, 0.091559979594845756, 0.092841492652212199, 0.093798030858294412, 0.094351351845986864, 0.092814046027700187, 0.093486157219819635, 0.090498151490013196], [0.091849472450780109, 0.09987135256917147, 0.095359101381023367, 0.10132711157177869, 0.096989994818717673, 0.095642645311814628, 0.094770708458483316, 0.099504889976262084, 0.095233946477410264, 0.095912229809406252], [0.096981357225800119, 0.098431927414326228, 0.10072742300061141, 0.098898806914864537, 0.099082873805034041, 0.10063185833765206, 0.10034615899080687, 0.099221510400624227, 0.098867437035043776, 0.098568081010241518], [0.10146145320773989, 0.10290476138788758, 0.10182039194103777, 0.10171670282374545, 0.10130432095639304, 0.10285746043130467, 0.10319349943771447, 0.1029627446099619, 0.10086077075694574, 0.10050071036093378]], 'Rp': [[0.77939286778673988, 0.78379075372310014, 0.77903660050560442, 0.75691093708781843, 0.75690993883190572, 0.79281350511242199, 0.76548119282328986, 0.75540866070955459, 0.77566114237892325, 0.77718635034500816], [0.77077047902704154, 0.74838529774977014, 0.77592499238852597, 0.77108749825264966, 0.77344285646834765, 0.75632672530448497, 0.77531058389168894, 0.7942725305980507, 0.77516649898011347, 0.79213834022181684], [0.77343971286186985, 0.7811615284026463, 0.77002662705139213, 0.78186660257747442, 0.77592889108537455, 0.76274494268121895, 0.76959295957424056, 0.76137871102493382, 0.77323148286234344, 0.74483235174871509], [0.75885686151109177, 0.77136712590698997, 0.7637379965318023, 0.75712573362947666, 0.76860566929133478, 0.75918656580312649, 0.74968717936109908, 0.77072287126227668, 0.77181921702477563, 0.766773258630573], [0.76937810303238807, 0.75465386095098919, 0.75083393097032181, 0.76177797822911753, 0.76189133903150008, 0.74842864001507103, 0.76323916270541503, 0.76429477418517133, 0.77410203202827355, 0.76983965493359408], [0.76609473555281116, 0.76356112846241442, 0.74975864472915243, 0.76239433570706805, 0.75868577573000173, 0.76251451363034839, 0.7538088687563389, 0.75184881181604735, 0.7600995562692493, 0.75432912516623662], [0.74772064161289276, 0.75406561814751527, 0.75457074519872191, 0.74722768393668193, 0.75155659709284284, 0.74455252421997353, 0.75489649747184262, 0.74961295847986986, 0.74332859583971711, 0.74709104962198603], [0.74055353235155419, 0.74551803447654252, 0.74512979469545415, 0.74636136686091947, 0.74570582760017257, 0.74940858658178311, 0.74136979297401795, 0.74335121765377787, 0.74994994361601441, 0.74819281963882356], [0.73628102687328378, 0.72848571847169041, 0.73660169233998429, 0.73742334699607537, 0.73809454564390775, 0.74112553158811312, 0.73446549169338082, 0.74545629305295769, 0.74011017139833268, 0.75134303184403173], [0.73410683674958854, 0.73853467283533347, 0.73203184911821528, 0.73677663684107375, 0.73267123006938562, 0.72707721050496976, 0.72644560784832646, 0.73252613291918833, 0.73124916095655701, 0.73862344837162053], [0.73486322486452571, 0.70726438223338095, 0.72272980935754105, 0.70526165872053703, 0.71683703235539997, 0.72233785968541298, 0.7257846637957609, 0.71059687926256743, 0.72362060496899205, 0.72206167609673011], [0.71815121292888973, 0.71318854691019617, 0.70511992104336951, 0.71054317570035785, 0.71194125803719077, 0.70521787589059204, 0.70659400821092722, 0.71122173648366205, 0.71141006208491686, 0.7120169592243234], [0.70522181987704136, 0.69734574176085518, 0.70136859977962518, 0.70265674174297188, 0.70177949605188183, 0.6993303818327512, 0.6974907506804654, 0.69699722251559204, 0.70749368647236088, 0.70713972983920825]]} 
average_performances = {'R^2': [0.5945641945277526, 0.5970954416593247, 0.5905487013631688, 0.5820504251965815, 0.5793808821121904, 0.5737557492169904, 0.5604104344386258, 0.5543064179336862, 0.5443473264593095, 0.5357111468984013, 0.5153859367506708, 0.502739813780906, 0.4886225788048728], 'MSE': [0.08040747091342193, 0.080429276215028558, 0.081801057860329068, 0.083131391200514132, 0.083906833430493225, 0.085002994628494338, 0.087609469263970952, 0.089013428201086736, 0.09095420915383437, 0.092539305725181042, 0.096646145282484788, 0.099175743413500467, 0.10195828159136644], 'Rp': [0.77225919493043671, 0.77328258028824903, 0.76942038098702092, 0.76378824789525468, 0.76184394760818408, 0.75830954958196695, 0.74946229116220442, 0.74555409164490605, 0.73893868499017579, 0.73300427862142581, 0.71913577913408466, 0.7105404756514424, 0.70168241705527534]}
'''