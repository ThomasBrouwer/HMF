"""
Test the performance of HMF for recovering the GDSC dataset, where we vary the 
fraction of entries that are missing.
We repeat this 10 times per fraction and average that.

GDSC has 0.7356934001670844 observed entries
"""

project_location = "/home/tab43/Documents/Projects/libraries/"
import sys
sys.path.append(project_location)

from HMF.code.models.hmf_Gibbs import HMF_Gibbs
from HMF.code.generate_mask.mask import try_generate_M_from_M
from HMF.drug_sensitivity.load_dataset import load_data_without_empty,load_data_filter

import numpy, random


''' Settings '''
metrics = ['MSE', 'R^2', 'Rp']

fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]
repeats = 10

iterations, burn_in, thinning = 500, 450, 2
settings = {
    'priorF'  : 'exponential',
    'orderG'  : 'normal',
    'priorSn' : 'normal',
    'priorSm' : 'normal',
    'orderF'  : 'columns',
    'orderG'  : 'rows',
    'orderSn' : 'rows',
    'orderSm' : 'rows',
    'ARD'     : True
}
hyperparameters = {
    'alphatau' : 1.,
    'betatau'  : 1.,
    'alpha0'   : 0.001,
    'beta0'    : 0.001,
    'lambdaF'  : 0.1,
    'lambdaG'  : 0.1,
    'lambdaSn' : 0.1,
    'lambdaSm' : 0.1,
}
init = {
    'F'       : 'kmeans',
    'Sn'      : 'least',
    'Sm'      : 'least',
    'G'       : 'least',
    'lambdat' : 'exp',
    'tau'     : 'exp'
}

K = {'Cell_lines':10, 'Drugs':10}
alpha_n = [1., 1., 1., 1.] # GDSC, CTRP, CCLE IC, CCLE EC


''' Load data '''
location = project_location+"HMF/drug_sensitivity/data/overlap/"
location_data = location+"data_row_01/"

R_gdsc,     M_gdsc,   cell_lines, drugs   = load_data_without_empty(location_data+"gdsc_ic50_row_01.txt")
R_ccle_ec,  M_ccle_ec                     = load_data_filter(location_data+"ccle_ec50_row_01.txt",cell_lines,drugs)
R_ctrp,     M_ctrp                        = load_data_filter(location_data+"ctrp_ec50_row_01.txt",cell_lines,drugs)
R_ccle_ic,  M_ccle_ic                     = load_data_filter(location_data+"ccle_ic50_row_01.txt",cell_lines,drugs)


''' Seed all of the methods the same '''
numpy.random.seed(0)
random.seed(0)

''' Generate matrices M - one list of (M_train,M_test)'s for each fraction '''
M_attempts = 1000
all_Ms_train_test = [ 
    [try_generate_M_from_M(M=M_gdsc,fraction=fraction,attempts=M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]

''' Make sure each M has no empty rows or columns '''
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms_train_test,fraction in zip(all_Ms_train_test,fractions_unknown):
    for (M_train,M_test) in Ms_train_test:
        check_empty_rows_columns(M_train,fraction)

''' Run the method on each of the M's for each fraction '''
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms_train_test) in zip(fractions_unknown,all_Ms_train_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for repeat,(M_train,M_test) in zip(range(0,repeats),Ms_train_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
     
        R = [(R_gdsc,    M_train,   'Cell_lines', 'Drugs', alpha_n[0]), 
             (R_ctrp,    M_ctrp,    'Cell_lines', 'Drugs', alpha_n[1]), 
             (R_ccle_ic, M_ccle_ic, 'Cell_lines', 'Drugs', alpha_n[2]),
             (R_ccle_ec, M_ccle_ec, 'Cell_lines', 'Drugs', alpha_n[3])]
        C, D = [], []

        HMF = HMF_Gibbs(R,C,D,K,settings,hyperparameters)
        HMF.initialise(init)
        HMF.run(iterations)
        
        # Measure the performances
        performances = HMF.predict_Rn(n=0,M_pred=M_test,burn_in=burn_in,thinning=thinning)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
 
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)

'''
200 iterations
repeats=10 
fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.6123144865842867, 0.6125188293386558, 0.6234420861379597, 0.5897001480892428, 0.5657820540915737, 0.642063540936501, 0.5992776161373643, 0.5731961796458944, 0.5900610439307158, 0.6130150471233395], [0.5822176635672656, 0.5762035828863449, 0.6128619826279479, 0.6012243686712244, 0.6075750865441238, 0.5934297913584454, 0.6257330876121867, 0.6285518636565669, 0.6110447259028822, 0.6336228874115334], [0.606256758027161, 0.6107986035987734, 0.6053196283112867, 0.6169323559664224, 0.5978730833609667, 0.5969008596108992, 0.6096064566854381, 0.5880589260302564, 0.6016033532102711, 0.5841875810707443], [0.5731194697102961, 0.5962476956863648, 0.5948496769170497, 0.6018046038017162, 0.6043276362071539, 0.5865892878976798, 0.571845835634052, 0.6059872565353512, 0.5995962314322325, 0.5880918938304296], [0.6032308851241087, 0.570105970493081, 0.5809474017870717, 0.594430790509267, 0.5868971615080747, 0.5783369800523106, 0.5850779258679574, 0.5908337695813846, 0.6225963978238405, 0.6002252930901983], [0.5892235903304789, 0.5907793845223979, 0.5707115315928675, 0.589761097073096, 0.58935164663409, 0.5878912954337202, 0.5713429109299861, 0.581339368698712, 0.5885664711496015, 0.5671878754441224], [0.5700448866480712, 0.5770283411229065, 0.569712211180172, 0.5634429963042455, 0.556890439469129, 0.5661968236140221, 0.5845566997790406, 0.5650257201047006, 0.5751238274188786, 0.5676163647140509], [0.5540434811868222, 0.5602314952177019, 0.564047156325445, 0.5553810254682923, 0.5744274612069734, 0.5689066095883383, 0.5619760331875249, 0.5606761104236199, 0.5614949377867791, 0.569442586215989], [0.5523493559586798, 0.5472838871873997, 0.5433070568609351, 0.5544386175777517, 0.5527323575263589, 0.5630444492504367, 0.5469478156594952, 0.5547241121718416, 0.5544209952261778, 0.5606071936079463], [0.548835641071592, 0.5395039978312355, 0.5414213047182206, 0.5321902613713463, 0.5261295092496957, 0.5305026900274954, 0.5356529959294345, 0.5494464936583147, 0.5469241233825712, 0.5339799327990468], [0.5294187707817815, 0.5104765439856005, 0.5142961219459762, 0.4932679678710845, 0.5107229554633513, 0.513251241215378, 0.5203250509717339, 0.5031323156243284, 0.5125820398418535, 0.513726482374532], [0.48681955687213885, 0.4873294158927164, 0.47143217157667827, 0.47872970770478696, 0.4885265521626041, 0.4867753217334243, 0.4877950774355082, 0.49359173844045157, 0.48440166635260284, 0.5040481493006133], [0.4876016009902988, 0.4590634196433452, 0.45672181984142746, 0.4634005932344578, 0.4389922063605243, 0.48000231396187054, 0.4835017277365605, 0.456961795358244, 0.48768156553712194, 0.4789953776353756]], 'MSE': [[0.075942822729632889, 0.074993053813490806, 0.074906007000646521, 0.08134525373887723, 0.085863379426415379, 0.073447445969661851, 0.079938703501762312, 0.085414571914999779, 0.081754532610100877, 0.075370055294731036], [0.082859632665538974, 0.085217817376924118, 0.077403693172926516, 0.08016748308930044, 0.07860064900912446, 0.080719818439210098, 0.074594663102944422, 0.07381673836699254, 0.07785269173589851, 0.072773899399945982], [0.078214832208835558, 0.079085715631325854, 0.07847094944801776, 0.07604188534056161, 0.080252423587244645, 0.081696241470006453, 0.077998369292566053, 0.082228073939459259, 0.079524632053950814, 0.082166051129084205], [0.085626958062396188, 0.080361802817438682, 0.080074410441386856, 0.079731004349470141, 0.078344405996605873, 0.082107712413747327, 0.084962779471308592, 0.078682940983271388, 0.079467712955420655, 0.08166619366981831], [0.079473104735103398, 0.086044429699662264, 0.083667392673054647, 0.081179634399491982, 0.082299398026055431, 0.083619121892443138, 0.08250638339120045, 0.081792848291687287, 0.074961988710678787, 0.079827839815728607], [0.081804649065834359, 0.081560833867421773, 0.08575171411075963, 0.082242958062544641, 0.081824191121305984, 0.08267729206531696, 0.084866825821772046, 0.083640745650345891, 0.082129468402045477, 0.08584097823356561], [0.085872022564846204, 0.084048403210205319, 0.085588374997358149, 0.086811288896372393, 0.088193160772832832, 0.086880500412718234, 0.082892573634460495, 0.086513814191145316, 0.085084831126648164, 0.085939565839704524], [0.088953324882224502, 0.088018723791173883, 0.086849185022636596, 0.089073858699498715, 0.08475664594519397, 0.085996671956136708, 0.08721234426226003, 0.088013775412219566, 0.087761314066800683, 0.086030888715365683], [0.089087879155795108, 0.09095431327917447, 0.091117770630280981, 0.08921206354272565, 0.089262136207906018, 0.087114313189119913, 0.089933469211270586, 0.088998293497581399, 0.089243344613463768, 0.087362348899332573], [0.090335162253071963, 0.091974791307457254, 0.09125152452948096, 0.093313476081772442, 0.094305415508906532, 0.09293315234242143, 0.09255352536822356, 0.089956305457706415, 0.090498989732348947, 0.092779852777507693], [0.093762938489153125, 0.097549822885610094, 0.096818861836031916, 0.10112936440646522, 0.097484548119497319, 0.096845860744151469, 0.095895346049709021, 0.099012258416921309, 0.097223544928574601, 0.097255569574863421], [0.10250751623839524, 0.10244339974703587, 0.10510090049065141, 0.10382534152608328, 0.10181369403167902, 0.10230503395835029, 0.10223562150794385, 0.10111104292748269, 0.10289071487244171, 0.09902243727847132], [0.10217440640258106, 0.10772705014523223, 0.10819154777332461, 0.10688458840768186, 0.11192340364109742, 0.10377774608922653, 0.10310101358808865, 0.10833692074396598, 0.10220499732811969, 0.10379274882676172]], 'Rp': [[0.78278513827449325, 0.78478329344033293, 0.79108498936183058, 0.76986101675394347, 0.75663671318384207, 0.80158853037092093, 0.77589717021800109, 0.7608855233527374, 0.770796766288811, 0.78386593976434837], [0.7647379518183548, 0.76075985507508592, 0.78319413965153051, 0.77603469442833228, 0.7803393138925564, 0.77215176318807188, 0.79171252894006083, 0.79474256078132455, 0.78196618551751951, 0.79645037923547513], [0.77984357405265892, 0.78172598182250808, 0.77954854916556648, 0.78639750695936039, 0.77381575735516572, 0.7739820348562727, 0.78148093695283982, 0.7680012400669739, 0.77660969454910556, 0.76647691681744567], [0.75857953669066225, 0.77289516993594631, 0.77347437265558572, 0.7764367319345421, 0.77870293948353264, 0.76792372529984454, 0.75825757764395363, 0.77922041827258803, 0.77572460180101666, 0.76842546950341095], [0.7775948075182566, 0.75772949746028584, 0.7645016456383692, 0.77177738940426233, 0.7675274826418611, 0.76225867645310452, 0.76612402141367775, 0.77075689022182858, 0.78933855759681459, 0.77598461429857224], [0.76848297403058174, 0.77006129749817021, 0.75725194154003661, 0.76928615243476184, 0.76836896202312621, 0.76777569076890895, 0.75783589533016482, 0.76413946660637466, 0.76853864814873463, 0.75603563654874517], [0.7566606936998318, 0.76085494540348919, 0.7570701610134023, 0.75237542591796536, 0.75057092069111098, 0.75383123359618776, 0.76625746534257921, 0.75424913101440216, 0.75957911434155911, 0.7556970671506793], [0.74677443282084599, 0.75043738139036742, 0.75332382525440444, 0.74814853359282407, 0.75890813476502883, 0.75673792688201102, 0.75178519473811578, 0.75024469452474496, 0.7518352526921851, 0.7562126449943839], [0.74608092152501349, 0.74127990530278132, 0.73927377359389612, 0.74580175119849323, 0.74613834531133094, 0.75190140087366297, 0.74312606898958367, 0.74632692412083801, 0.74794723621345816, 0.75074070551324479], [0.7422519456566814, 0.7367503180286652, 0.73896114162424642, 0.73400324556206131, 0.72907247607122883, 0.73185484015969193, 0.73473360414910149, 0.74265048517375964, 0.74155767845211906, 0.73333829398522565], [0.7306540399531537, 0.72002576365172766, 0.72274567168508752, 0.70995592473446323, 0.71734963915766514, 0.72107567182992138, 0.72451225370843386, 0.71466052537772373, 0.71984944283200769, 0.72066824836152898], [0.70407854605039211, 0.70399297309196418, 0.69763090253365989, 0.70174825908951877, 0.70730866392385039, 0.70295427292974966, 0.70478586105502827, 0.70682020179616478, 0.70317493030130984, 0.71329416509512433], [0.70109411131445853, 0.68557449434504847, 0.68520146108698299, 0.69180526373455253, 0.67697012546263546, 0.69887452820150298, 0.70233321758059775, 0.68431905982690411, 0.70232210971130127, 0.69887761991627684]]} 
average_performances = {'R^2': [0.6021371032015532, 0.6072465040238522, 0.6017537605872219, 0.5922459587652327, 0.5912682575837295, 0.5826155171809072, 0.5695638310355218, 0.5630626896607486, 0.5529855841027024, 0.5384586950038953, 0.512119949007562, 0.48694493574715236, 0.4692922420299227], 'MSE': [0.078897582600031879, 0.078400708635880598, 0.079567917410105229, 0.081102592116086406, 0.081537214163510605, 0.083233965640091237, 0.085782453564629157, 0.087266673275351023, 0.089228593222665048, 0.09199021953588972, 0.097297811545097757, 0.10232557025785347, 0.10581144229460797], 'Rp': [0.77781850810092612, 0.78020893725283114, 0.7767882192597898, 0.77096405432210824, 0.77035935826470325, 0.76477766649296053, 0.75671461581712074, 0.75244080216549114, 0.74586170326423029, 0.73651740288627809, 0.72014971812917117, 0.70457887758667626, 0.692737199118026]}

500 iterations
repeats=10 
fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.622009207731547, 0.6210991446769469, 0.6249587426675756, 0.6095678627813437, 0.5741127708887146, 0.6600323141360378, 0.6312891690802458, 0.585387298236994, 0.6108606392620128, 0.6113525162994842], [0.5949191132502005, 0.5841299710515468, 0.6254229296910593, 0.6028109241455436, 0.6075037069383902, 0.6074710313798307, 0.6207179641086717, 0.6310929914510927, 0.6202340952447903, 0.6429267520237594], [0.6119001626923851, 0.6146339634924372, 0.608950054008828, 0.6265178716731654, 0.6188615417786957, 0.5965927549249095, 0.61265211636584, 0.5998113390503617, 0.6156976607027227, 0.5820454595182576], [0.583130524973754, 0.6093185665860616, 0.5934147645054679, 0.600334240852475, 0.61554479800929, 0.6040297248984594, 0.5748742707579988, 0.6197764205347593, 0.611944117987016, 0.596346265987099], [0.6102363566609345, 0.5870486935998158, 0.5835547179107443, 0.5990868447314681, 0.5912323629200694, 0.58710191798712, 0.5982828587969466, 0.6035233651794568, 0.6135854378441972, 0.611059115755767], [0.5930708990952416, 0.5987857317653871, 0.5832691067715057, 0.5993384451888422, 0.5946701239231404, 0.5922635074926579, 0.5859673019668503, 0.5812096676017506, 0.5926972280148519, 0.5877562986704514], [0.5880887318308359, 0.580555953447067, 0.5862019897978651, 0.5686360971816491, 0.5669455395866735, 0.5747374103323457, 0.5804978926885334, 0.5781700940671928, 0.5741650701233549, 0.5833152385921637], [0.5634002609820491, 0.5643736942882835, 0.5768582129401876, 0.5636161603107935, 0.574243402243068, 0.575257867658128, 0.5688018635043874, 0.5665398442433035, 0.591483248913673, 0.5771721051654435], [0.5606453562813629, 0.5594184645781246, 0.5468926536427694, 0.5705800725071566, 0.552535094789119, 0.5625294224636472, 0.5511888990635709, 0.5741942217283469, 0.5535833052067552, 0.5696074759787378], [0.5612894442654688, 0.5550198026362123, 0.5519530204632301, 0.5413663099398532, 0.5444949883178203, 0.5438225349841943, 0.5517999544924429, 0.5487240720068072, 0.559912682397353, 0.5547568882688918], [0.5425757793509585, 0.5272809040511495, 0.5267323846783135, 0.49508453043534484, 0.5237816563884536, 0.5290258124752439, 0.52977200315017, 0.5091416898070962, 0.5382761502694862, 0.5284067308975737], [0.5136323531755138, 0.5175277212976205, 0.49799859555365933, 0.5107513883176702, 0.5164726814437842, 0.5230061322260642, 0.5088629637142031, 0.520243421984163, 0.5134850206695487, 0.5177272375752429], [0.4876961918187199, 0.49644972414774036, 0.4661211438108206, 0.47922553685303615, 0.46598277827893064, 0.49845184276922927, 0.4981409372656206, 0.5120618866951203, 0.5091494402382551, 0.5000296117633491]], 'MSE': [[0.074043746122377421, 0.073332420733429299, 0.074604309226033824, 0.077406319115054634, 0.084216041945348263, 0.069760309704842399, 0.073552831031485827, 0.082974811242848737, 0.077606448682936757, 0.07569385351787053], [0.080340527946957202, 0.083623963649416919, 0.074892279545728885, 0.07984853140528228, 0.078614945969241665, 0.077932092430030603, 0.075594221000749473, 0.073311747906111155, 0.076013361647667699, 0.070925862270832571], [0.077093802304257511, 0.078306370580925794, 0.077749142710663105, 0.074139086454633213, 0.076063759298216654, 0.081758685152720237, 0.077389864124999652, 0.079882160050679982, 0.076711243371028415, 0.082589342163679982], [0.083618864114839764, 0.077760210854566122, 0.080358008303331355, 0.08002541637889217, 0.076123371729941089, 0.078643858324558488, 0.084361817745384246, 0.075929294064053354, 0.077017040955375399, 0.080029655944358236], [0.078069904354098218, 0.082653298752925486, 0.083146819974370997, 0.0802476682377187, 0.081435728176118424, 0.081880965168048755, 0.079880610199515395, 0.079256182040970291, 0.076751795369575257, 0.077664519712203034], [0.081038471320616395, 0.079965106935120933, 0.083243299196567921, 0.080322931868505101, 0.080764452055980138, 0.081800138417837634, 0.081971444691909701, 0.083666657560017926, 0.081304895678502381, 0.081761578719788508], [0.082268247583287366, 0.083347433826636078, 0.082308399611987659, 0.085778617843749738, 0.08619187003067165, 0.085170023200246261, 0.083702419323244001, 0.083899475874581644, 0.085276829896749826, 0.082819294175479632], [0.087086962046692251, 0.087189671524090614, 0.084297005716060386, 0.087424052282431455, 0.084793302963715442, 0.084729691137398311, 0.085853293825358154, 0.086839039952282912, 0.081759527957748726, 0.084486431778206972], [0.087436874998733274, 0.08851637894843141, 0.090402384964598875, 0.085980157548077654, 0.089301504343778454, 0.087216992293958392, 0.089091589717193997, 0.085106758895984833, 0.089411122399853257, 0.08557286623773426], [0.087841578019470762, 0.088875822147716346, 0.089155842528700832, 0.09148314011841141, 0.090650484112361249, 0.090296597980457485, 0.089335117742287973, 0.090100542228339797, 0.087904608681447671, 0.088643372386791347], [0.091141414916650107, 0.094201132791274567, 0.094339851769110361, 0.10076682995851168, 0.094882706130534122, 0.093707276610221199, 0.094006736377468647, 0.097814753068478658, 0.092098431158146074, 0.094319493724834058], [0.097151674664011256, 0.096409082257054274, 0.099818408949072082, 0.097447341522989117, 0.096250749038083991, 0.095082867030783308, 0.098030491192567265, 0.095789685194141258, 0.097086958496057682, 0.096291251461156524], [0.10215554459160794, 0.10028160007521764, 0.10631971222864153, 0.10373243698164504, 0.10653867154008638, 0.10009570948128757, 0.10017880179837588, 0.097344371458991677, 0.09792226235534815, 0.0996023810528648]], 'Rp': [[0.78879951381502633, 0.7898256617594841, 0.79163432540926604, 0.7816616393875091, 0.76180791094871214, 0.81253490889551216, 0.79526681464162186, 0.7680324032544168, 0.78283636726517769, 0.78354985930000387], [0.77282681466999481, 0.76601435682054853, 0.7910931720197959, 0.77674593920883972, 0.78010977101172396, 0.78046697034053047, 0.78839637234147519, 0.79568227346311249, 0.78787112155904948, 0.80210787178115817], [0.78309088304675001, 0.7844376121619846, 0.78181599890186382, 0.79226231065827613, 0.78705574795709021, 0.77372430529015224, 0.78321609016326221, 0.77507383560213261, 0.78508516125374805, 0.76443852305532367], [0.76483937748323605, 0.78112908823805438, 0.77200141334801886, 0.77552989103884162, 0.78542751574044067, 0.77824964801706031, 0.76034101766999707, 0.7878493390943605, 0.78305671679211164, 0.77355779759627707], [0.78138364452602027, 0.76729786782420262, 0.76544017788736995, 0.77475751266358439, 0.77094424561802288, 0.76729983475833419, 0.77423809375067443, 0.77795572004708236, 0.78350307008038489, 0.7822833875443419], [0.77079552835813503, 0.77515527302285292, 0.76513272927299036, 0.77508577386380717, 0.77191618164691722, 0.77044453641808563, 0.76699063881346741, 0.76375053313712238, 0.77139289431679225, 0.7681494279288934], [0.7676459557767461, 0.76286496470917742, 0.76645300043236264, 0.75564919115706564, 0.75649179382253862, 0.7599329158434841, 0.76396497925621709, 0.76232787249135814, 0.75885821401548548, 0.7649019960167065], [0.75203035701566923, 0.75276075541813503, 0.76124604823824438, 0.75276481315004662, 0.75928482201200276, 0.75998925334362533, 0.75609829304777276, 0.75414741269055896, 0.7699326704061904, 0.76063102373282709], [0.75085409678986448, 0.74895587247029816, 0.74249540166945582, 0.7559721765181393, 0.74601501746920418, 0.7512061302338201, 0.74485936097235972, 0.75840192002679219, 0.74661050516668537, 0.7559786351857708], [0.74957096176289295, 0.7460692861465682, 0.74470106529913471, 0.73927933474780816, 0.74058966625586775, 0.73950622973225089, 0.74414646303105636, 0.74223980975620862, 0.75009283869477716, 0.74686867394182255], [0.73787771356104248, 0.72877487655358275, 0.72902075693729818, 0.71143795422411593, 0.72569216613799004, 0.730386952769702, 0.73023899800517145, 0.71782079853054181, 0.73519277553575446, 0.72950979352941081], [0.72022565500195213, 0.72191583182736718, 0.71065821753683933, 0.71858460291980131, 0.72130332972371736, 0.72497771132980027, 0.71615170566377462, 0.72332540282516944, 0.72002601745100669, 0.72242671849493911], [0.70311235350138912, 0.70587530984858449, 0.68898124190831855, 0.69894381195844357, 0.68968300390926407, 0.70925524490900926, 0.70906021517588735, 0.71762354169942755, 0.71564960076412776, 0.71240517260643488]]} 
average_performances = {'R^2': [0.6150669665760902, 0.6137229479284885, 0.6087662924207603, 0.600871369509238, 0.5984711671386519, 0.5909028310490679, 0.5781314017647681, 0.5721746660249317, 0.560117496623959, 0.5513139697772274, 0.5250077641503791, 0.513970751595747, 0.4913309093640822], 'MSE': [0.07631910913222277, 0.077109753377201842, 0.078168345621180441, 0.079386753841530017, 0.080098749198554448, 0.081583897644484663, 0.084076261136663374, 0.085445897918398517, 0.087803663034834445, 0.089428710594598476, 0.094727862650522951, 0.096935850980591681, 0.10141714915640668], 'Rp': [0.78559494046767298, 0.78413146632162278, 0.78102004680905823, 0.77619818050183986, 0.7745103554700018, 0.76988135167790639, 0.76190908835211413, 0.75788854490550717, 0.75013491165023904, 0.74430643293683874, 0.72759527857846096, 0.71995951927743673, 0.70505894962808857]}
'''