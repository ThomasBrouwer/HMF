"""
Test the performance of HMF for recovering the CTRP dataset, where we vary the 
fraction of entries that are missing.
We repeat this 10 times per fraction and average that.

GDSC has 0.7356934001670844 observed entries
"""

project_location = "/home/tab43/Documents/Projects/libraries/"
import sys
sys.path.append(project_location)

from HMF.code.models.hmf_Gibbs import HMF_Gibbs
from HMF.code.generate_mask.mask import try_generate_M_from_M
from HMF.drug_sensitivity.load_dataset import load_data_without_empty,load_data_filter

import numpy, random


''' Settings '''
metrics = ['MSE', 'R^2', 'Rp']

fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]
repeats = 10

iterations, burn_in, thinning = 500, 450, 2
settings = {
    'priorF'  : 'exponential',
    'orderG'  : 'normal',
    'priorSn' : 'normal',
    'priorSm' : 'normal',
    'orderF'  : 'columns',
    'orderG'  : 'rows',
    'orderSn' : 'rows',
    'orderSm' : 'rows',
    'ARD'     : True
}
hyperparameters = {
    'alphatau' : 1.,
    'betatau'  : 1.,
    'alpha0'   : 0.001,
    'beta0'    : 0.001,
    'lambdaF'  : 0.1,
    'lambdaG'  : 0.1,
    'lambdaSn' : 0.1,
    'lambdaSm' : 0.1,
}
init = {
    'F'       : 'kmeans',
    'Sn'      : 'least',
    'Sm'      : 'least',
    'G'       : 'least',
    'lambdat' : 'exp',
    'tau'     : 'exp'
}

K = {'Cell_lines':10, 'Drugs':10}
alpha_n = [1., 1., 1., 1.] # GDSC, CTRP, CCLE IC, CCLE EC


''' Load data '''
location = project_location+"HMF/drug_sensitivity/data/overlap/"
location_data = location+"data_row_01/"

R_ctrp,     M_ctrp,   cell_lines, drugs   = load_data_without_empty(location_data+"ctrp_ec50_row_01.txt")
R_ccle_ec,  M_ccle_ec                     = load_data_filter(location_data+"ccle_ec50_row_01.txt",cell_lines,drugs)
R_gdsc,     M_gdsc                        = load_data_filter(location_data+"gdsc_ic50_row_01.txt",cell_lines,drugs)
R_ccle_ic,  M_ccle_ic                     = load_data_filter(location_data+"ccle_ic50_row_01.txt",cell_lines,drugs)


''' Seed all of the methods the same '''
numpy.random.seed(0)
random.seed(0)

''' Generate matrices M - one list of (M_train,M_test)'s for each fraction '''
M_attempts = 1000
all_Ms_train_test = [ 
    [try_generate_M_from_M(M=M_ctrp,fraction=fraction,attempts=M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]

''' Make sure each M has no empty rows or columns '''
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms_train_test,fraction in zip(all_Ms_train_test,fractions_unknown):
    for (M_train,M_test) in Ms_train_test:
        check_empty_rows_columns(M_train,fraction)

''' Run the method on each of the M's for each fraction '''
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms_train_test) in zip(fractions_unknown,all_Ms_train_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for repeat,(M_train,M_test) in zip(range(0,repeats),Ms_train_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
     
        R = [(R_ctrp,    M_train,   'Cell_lines', 'Drugs', alpha_n[1]),
             (R_gdsc,    M_gdsc,    'Cell_lines', 'Drugs', alpha_n[0]),  
             (R_ccle_ic, M_ccle_ic, 'Cell_lines', 'Drugs', alpha_n[2]),
             (R_ccle_ec, M_ccle_ec, 'Cell_lines', 'Drugs', alpha_n[3])]
        C, D = [], []

        HMF = HMF_Gibbs(R,C,D,K,settings,hyperparameters)
        HMF.initialise(init)
        HMF.run(iterations)
        
        # Measure the performances
        performances = HMF.predict_Rn(n=0,M_pred=M_test,burn_in=burn_in,thinning=thinning)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
 
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)

'''
200 iterations
repeats=10 
fractions_unknown = [0.15, 0.2, 0.25] 
all_performances = {'R^2': [[0.4348838455724032, 0.39280427769291393, 0.49981285974004575, 0.3995359659498341, 0.4103630592421885, 0.43197303040323, 0.4636584549080546, 0.38047528466072356, 0.45365415640913587, 0.5665722003461124], [0.4158178298081997, 0.4154050039413044, 0.4184830617955204, 0.42716249044621724, 0.417637201103524, 0.4684707855915281, 0.4527882823772993, 0.4324113501827117, 0.4668693588480235, 0.47895861228418024], [0.444240525429635, 0.42871156041485536, 0.41071114649657914, 0.42105277411145414, 0.4530864021756983, 0.45986337235193353, 0.4011303136753993, 0.41356060180387866, 0.41462281979130633, 0.45258414802328395]], 'MSE': [[0.093740803618279245, 0.086956920276219318, 0.078354905600301353, 0.098656405431336996, 0.10159021917901406, 0.093697352070783252, 0.08458563056171374, 0.10533086265492582, 0.087659853755237993, 0.067160966313441595], [0.090653077877469443, 0.093087723876182471, 0.092530911955070266, 0.093978933142721044, 0.094272568678299209, 0.085336684469607502, 0.083086276945172802, 0.092109804031501208, 0.088059063445565924, 0.083906886237739439], [0.089885872740905037, 0.092453575564495891, 0.093556602744979692, 0.090847772114902942, 0.086101215230863615, 0.085064649915824145, 0.097114482613302799, 0.090947661738193811, 0.092541266597027952, 0.088315085938224042]], 'Rp': [[0.66152495841011427, 0.62884415004343364, 0.70793169576828974, 0.63381542793603385, 0.65272321558543234, 0.66095321081923031, 0.68174182984289389, 0.6283031075625698, 0.67433817512765126, 0.75283125252352423], [0.6472899505843388, 0.64665055295855234, 0.64880681961443287, 0.65478690407171181, 0.64844743600795629, 0.68477960517413428, 0.6760862886636132, 0.65884137826859102, 0.68404650363728725, 0.69221422899373752], [0.66721437360783475, 0.65660524518837249, 0.64291953536030422, 0.6503683810639409, 0.67372829815685109, 0.67945021222837954, 0.63840355425700535, 0.64645193942770807, 0.64669239110458399, 0.67387116239107636]]} 
average_performances = {'R^2': [0.4433733134924642, 0.4394003976378508, 0.4299563664274024], 'MSE': [0.089773391946125353, 0.089702193065932939, 0.090682818519871991], 'Rp': [0.66830070236191741, 0.6641949667974355, 0.65757050927860572]}

repeats=10 
fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.4298985215867027, 0.40120090124287267, 0.4287727074555263, 0.42963566997518077, 0.4113212996793446, 0.4248287457666431, 0.41863849828416144, 0.44102025475427, 0.42919706302104543, 0.413934194077224], [0.3977820712795713, 0.41731541825894836, 0.4101011376020167, 0.43756902746341053, 0.42524683219254156, 0.4207520048989396, 0.425098109729786, 0.4174863716171996, 0.42244244658953956, 0.42606266805221904], [0.3950443898328099, 0.42738500916252686, 0.3966797347025943, 0.41439399314928316, 0.43850399680194163, 0.4287483354154187, 0.44361393942933336, 0.41053936977777095, 0.4226217787223804, 0.43557940156370134], [0.40656560700696454, 0.3946162910054022, 0.42849660707229087, 0.3859442297047396, 0.4101501817037284, 0.4031999156716515, 0.4081738325104154, 0.43888617773490657, 0.4037483827716105, 0.4049407250691833], [0.3929053076553586, 0.40487497591524524, 0.3999704182537148, 0.39471901868473547, 0.40778044323203577, 0.4217434851890527, 0.40805741467758894, 0.4121232770171245, 0.41096068132100694, 0.3973926901011401], [0.4012685444519395, 0.39851899418686143, 0.3974583225918492, 0.3887811180870915, 0.40580338264099947, 0.3943919112465569, 0.37852230749796845, 0.38472438327742675, 0.4148158456906499, 0.4030166209630337], [0.3957779779219397, 0.4085341843702597, 0.3725301223100581, 0.39899575760973105, 0.39276316843884906, 0.39559120514244706, 0.4061732319135327, 0.395308492692204, 0.40208618138083263, 0.3892990218631789], [0.3986860643002045, 0.37510244983789487, 0.39451863028611134, 0.40261999340654364, 0.3849112083465792, 0.378570324156551, 0.38477600564300296, 0.39930374180820627, 0.3834290958672416, 0.4024989683680692], [0.37567993220396045, 0.3744587066879014, 0.379561994268645, 0.3702784235016202, 0.38729951080897107, 0.3498409542163323, 0.39595419974948287, 0.3665262644077528, 0.36637462629309214, 0.35533489767052684], [0.36334328573720487, 0.3841405591035625, 0.37467548254989624, 0.3919818825838618, 0.31844869369707096, 0.35066509450698, 0.3597812861668287, 0.3484517906864363, 0.34320477254857895, 0.3372156804211772], [0.3395274780729248, 0.3473147684360762, 0.33878379962596217, 0.3544887127349987, 0.35308900005075383, 0.34612423145291116, 0.335711004072783, 0.34331454056076416, 0.3466552455775028, 0.3351117677951977], [0.3218623676566237, 0.3289991320184671, 0.31482678454979474, 0.32239071251515383, 0.3178535089411534, 0.33292464920369835, 0.345188899207164, 0.33085581980566137, 0.3357980541818355, 0.3532345857659054], [0.2944763688181272, 0.24507204195582433, 0.24550287922981462, 0.29819251760783083, 0.25581347146251543, 0.2483696209302121, 0.30699853610355887, 0.25178778218776066, 0.305151098187856, 0.28338173266479094]], 'MSE': [[0.092204211981031223, 0.092906402938007157, 0.093948984375797684, 0.089962831393878243, 0.094556957783272999, 0.092074339659319687, 0.093255004899740021, 0.090782736154643051, 0.091628624729205285, 0.093999836486715241], [0.09398350048387151, 0.091772876254994043, 0.09283418701093854, 0.08936778717317849, 0.09316706177055295, 0.091235886053510837, 0.090334991495466893, 0.092171905806052737, 0.093585054140232798, 0.089521350428656138], [0.095872432048009923, 0.091402791824648999, 0.095463105302865947, 0.093469840916536526, 0.088763681021598331, 0.090275623558997348, 0.090113885784498651, 0.092909449484114476, 0.092729851704582353, 0.089828135347543414], [0.094414255231798361, 0.095576199859404895, 0.090633342266345798, 0.097512435213297582, 0.09423787339733343, 0.094458086949740769, 0.094865245667124273, 0.089356687544596386, 0.092994996998658624, 0.095175129229998476], [0.097147454484010604, 0.094193353429102428, 0.095812351735781703, 0.094613236998251332, 0.09369527650261468, 0.092066275544816611, 0.094268791712219122, 0.093059712574892955, 0.093171747539587416, 0.095538605012336381], [0.094923641607187109, 0.094394870345691925, 0.096522447922582133, 0.09729244905408535, 0.094093004281424281, 0.096479562209925887, 0.099297768334007205, 0.097314049698701097, 0.094629370752967304, 0.094935786650729437], [0.096529210990591002, 0.094612784735601085, 0.099001515618990371, 0.09567521284648299, 0.097441949106714068, 0.095416628572339318, 0.093775083701538725, 0.096716098402094372, 0.095100329325456395, 0.097405802668649191], [0.095981043941685065, 0.099742031946966764, 0.096109818475576661, 0.09496276749922021, 0.097658365510379694, 0.099019421079990178, 0.097218840091803899, 0.096291207538155968, 0.098199363748963972, 0.09579438372553041], [0.099004330009538524, 0.098476792931279131, 0.098871927152978142, 0.099325195784164544, 0.098242953065129923, 0.10267052613473869, 0.096206993014429004, 0.10158704924880188, 0.10088207078534552, 0.10190008540599775], [0.10171475361439489, 0.097491811154939073, 0.098957034573899871, 0.096699673733968886, 0.1078342462248597, 0.10239248320950384, 0.10312134521159806, 0.10300208985838097, 0.10425600940055117, 0.10509095686209194], [0.10567500062276904, 0.1040186268270752, 0.10555878942096462, 0.10278155881596877, 0.10346510127592763, 0.10437174729821384, 0.10553052848519526, 0.10493725534647794, 0.10362381029333542, 0.10611967189817388], [0.10726114464003141, 0.10621889103961753, 0.10845242673963479, 0.10822900617556776, 0.10845936662269409, 0.10593174800567819, 0.10406519313204322, 0.10618118337277836, 0.10626414481054534, 0.10242180248203976], [0.11219491365263118, 0.12044515216646356, 0.11976879153288084, 0.11167978950525774, 0.11812010556965073, 0.11942815802516744, 0.11047931821427397, 0.11911243829554678, 0.11046310740183422, 0.11369526585283549]], 'Rp': [[0.6567387074594917, 0.63783651276107478, 0.65817351265165658, 0.65806625049360234, 0.6449760616284681, 0.65588528771100096, 0.6492639301232882, 0.6663407803390532, 0.65677678018463648, 0.64527754636174084], [0.63530983869675195, 0.64973035882886587, 0.64258966758969061, 0.66271592326936801, 0.65353917619136914, 0.6517520238706459, 0.65348009389462236, 0.64758445087454775, 0.65169576189835321, 0.65464183940848053], [0.63375577659687687, 0.6557387923626864, 0.63501262429034455, 0.64586547173517217, 0.66285544020858622, 0.65549469724162113, 0.66692778302379663, 0.64274636893045645, 0.65149718166764148, 0.66185110308825612], [0.64194937354954684, 0.63223218023936778, 0.65576382079492646, 0.62583071288200642, 0.64298605036064782, 0.6387869677063498, 0.64079611070534404, 0.66335587344955982, 0.63908783789781198, 0.63960481760914756], [0.6321318516126333, 0.63904248123381424, 0.63532918152910467, 0.63486207378558834, 0.64145473977143797, 0.65173433946175496, 0.64141851632427294, 0.6450133341934019, 0.64293878946377481, 0.63463878260585371], [0.6357470392052138, 0.63541186834233987, 0.63307813469844731, 0.62927283391469413, 0.64043625306445051, 0.63207781527047324, 0.62111424604207288, 0.62540279714879965, 0.64554150084791628, 0.63747145992705834], [0.63201930016003827, 0.64102067069848667, 0.61689812496053231, 0.63494829504234218, 0.63052458708286141, 0.63296389189263613, 0.6397385442862501, 0.63064623014431964, 0.63666093647630839, 0.6273041814872341], [0.63478853525447143, 0.61738585092483633, 0.63076655487066091, 0.63554813787156894, 0.62450915318850675, 0.61968288310209063, 0.62342622864118569, 0.63321707406973604, 0.62633205484170518, 0.63596228828008816], [0.61892685792612501, 0.61576220649992675, 0.62006284582684601, 0.6145894267833697, 0.62518255854600557, 0.60398778266394404, 0.63174454362314347, 0.60946631470590085, 0.61237019279956295, 0.6068877565322478], [0.61018391855335796, 0.62457948182292389, 0.61784068053165064, 0.62740411996721357, 0.58318349291545502, 0.60290474420453566, 0.6066187015611042, 0.60105570885696002, 0.59791026688527948, 0.59438115137963576], [0.59338149537836538, 0.59879081435920634, 0.59005858097142427, 0.60063169715242704, 0.60106461470606964, 0.5973501776979101, 0.5915434920726661, 0.59369557411484908, 0.59894951294720689, 0.58935384663441481], [0.58419621649696818, 0.58710516827753401, 0.57794400121461353, 0.58595013996228329, 0.57975329359231331, 0.5850058974078135, 0.59343003891511448, 0.59007200166350771, 0.59031482615515274, 0.60013532660659241], [0.56367378783029409, 0.54158544449638624, 0.54197226995666947, 0.57049080454188461, 0.54162946265357714, 0.53948300394662196, 0.57113227966397995, 0.52750878538105106, 0.57391742945579383, 0.55561283725207244]]} 
average_performances = {'R^2': [0.42284478558429717, 0.41998560876841723, 0.42131099485577606, 0.4084721950250893, 0.40505277120470035, 0.3967301430634377, 0.39570593436430335, 0.3904416482020405, 0.37213095098082855, 0.3571908528001597, 0.3440120548379874, 0.3303934513845458, 0.2734746049148291], 'MSE': [0.092531993040161062, 0.091797460061745481, 0.092082879699339606, 0.093922425235829859, 0.094356680553361327, 0.095988295085730174, 0.096167461596845763, 0.097097724355827295, 0.099716792353240311, 0.10205604038441884, 0.10460820902841017, 0.10634849070206305, 0.11553870402165418], 'Rp': [0.65293353697140133, 0.65030391345226946, 0.65117452391454389, 0.64203937451947091, 0.63985640899816376, 0.63355539484614665, 0.63227247622310079, 0.62816187610448504, 0.61589804859070729, 0.60660622666781183, 0.59548198060345403, 0.58739069102918928, 0.55270061051783304]}

Combined:
repeats=10 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.4348838455724032, 0.39280427769291393, 0.49981285974004575, 0.3995359659498341, 0.4103630592421885, 0.43197303040323, 0.4636584549080546, 0.38047528466072356, 0.45365415640913587, 0.5665722003461124], [0.4158178298081997, 0.4154050039413044, 0.4184830617955204, 0.42716249044621724, 0.417637201103524, 0.4684707855915281, 0.4527882823772993, 0.4324113501827117, 0.4668693588480235, 0.47895861228418024], [0.444240525429635, 0.42871156041485536, 0.41071114649657914, 0.42105277411145414, 0.4530864021756983, 0.45986337235193353, 0.4011303136753993, 0.41356060180387866, 0.41462281979130633, 0.45258414802328395], [0.4298985215867027, 0.40120090124287267, 0.4287727074555263, 0.42963566997518077, 0.4113212996793446, 0.4248287457666431, 0.41863849828416144, 0.44102025475427, 0.42919706302104543, 0.413934194077224], [0.3977820712795713, 0.41731541825894836, 0.4101011376020167, 0.43756902746341053, 0.42524683219254156, 0.4207520048989396, 0.425098109729786, 0.4174863716171996, 0.42244244658953956, 0.42606266805221904], [0.3950443898328099, 0.42738500916252686, 0.3966797347025943, 0.41439399314928316, 0.43850399680194163, 0.4287483354154187, 0.44361393942933336, 0.41053936977777095, 0.4226217787223804, 0.43557940156370134], [0.40656560700696454, 0.3946162910054022, 0.42849660707229087, 0.3859442297047396, 0.4101501817037284, 0.4031999156716515, 0.4081738325104154, 0.43888617773490657, 0.4037483827716105, 0.4049407250691833], [0.3929053076553586, 0.40487497591524524, 0.3999704182537148, 0.39471901868473547, 0.40778044323203577, 0.4217434851890527, 0.40805741467758894, 0.4121232770171245, 0.41096068132100694, 0.3973926901011401], [0.4012685444519395, 0.39851899418686143, 0.3974583225918492, 0.3887811180870915, 0.40580338264099947, 0.3943919112465569, 0.37852230749796845, 0.38472438327742675, 0.4148158456906499, 0.4030166209630337], [0.3957779779219397, 0.4085341843702597, 0.3725301223100581, 0.39899575760973105, 0.39276316843884906, 0.39559120514244706, 0.4061732319135327, 0.395308492692204, 0.40208618138083263, 0.3892990218631789], [0.3986860643002045, 0.37510244983789487, 0.39451863028611134, 0.40261999340654364, 0.3849112083465792, 0.378570324156551, 0.38477600564300296, 0.39930374180820627, 0.3834290958672416, 0.4024989683680692], [0.37567993220396045, 0.3744587066879014, 0.379561994268645, 0.3702784235016202, 0.38729951080897107, 0.3498409542163323, 0.39595419974948287, 0.3665262644077528, 0.36637462629309214, 0.35533489767052684], [0.36334328573720487, 0.3841405591035625, 0.37467548254989624, 0.3919818825838618, 0.31844869369707096, 0.35066509450698, 0.3597812861668287, 0.3484517906864363, 0.34320477254857895, 0.3372156804211772], [0.3395274780729248, 0.3473147684360762, 0.33878379962596217, 0.3544887127349987, 0.35308900005075383, 0.34612423145291116, 0.335711004072783, 0.34331454056076416, 0.3466552455775028, 0.3351117677951977], [0.3218623676566237, 0.3289991320184671, 0.31482678454979474, 0.32239071251515383, 0.3178535089411534, 0.33292464920369835, 0.345188899207164, 0.33085581980566137, 0.3357980541818355, 0.3532345857659054], [0.2944763688181272, 0.24507204195582433, 0.24550287922981462, 0.29819251760783083, 0.25581347146251543, 0.2483696209302121, 0.30699853610355887, 0.25178778218776066, 0.305151098187856, 0.28338173266479094]], 'MSE': [[0.093740803618279245, 0.086956920276219318, 0.078354905600301353, 0.098656405431336996, 0.10159021917901406, 0.093697352070783252, 0.08458563056171374, 0.10533086265492582, 0.087659853755237993, 0.067160966313441595], [0.090653077877469443, 0.093087723876182471, 0.092530911955070266, 0.093978933142721044, 0.094272568678299209, 0.085336684469607502, 0.083086276945172802, 0.092109804031501208, 0.088059063445565924, 0.083906886237739439], [0.089885872740905037, 0.092453575564495891, 0.093556602744979692, 0.090847772114902942, 0.086101215230863615, 0.085064649915824145, 0.097114482613302799, 0.090947661738193811, 0.092541266597027952, 0.088315085938224042], [0.092204211981031223, 0.092906402938007157, 0.093948984375797684, 0.089962831393878243, 0.094556957783272999, 0.092074339659319687, 0.093255004899740021, 0.090782736154643051, 0.091628624729205285, 0.093999836486715241], [0.09398350048387151, 0.091772876254994043, 0.09283418701093854, 0.08936778717317849, 0.09316706177055295, 0.091235886053510837, 0.090334991495466893, 0.092171905806052737, 0.093585054140232798, 0.089521350428656138], [0.095872432048009923, 0.091402791824648999, 0.095463105302865947, 0.093469840916536526, 0.088763681021598331, 0.090275623558997348, 0.090113885784498651, 0.092909449484114476, 0.092729851704582353, 0.089828135347543414], [0.094414255231798361, 0.095576199859404895, 0.090633342266345798, 0.097512435213297582, 0.09423787339733343, 0.094458086949740769, 0.094865245667124273, 0.089356687544596386, 0.092994996998658624, 0.095175129229998476], [0.097147454484010604, 0.094193353429102428, 0.095812351735781703, 0.094613236998251332, 0.09369527650261468, 0.092066275544816611, 0.094268791712219122, 0.093059712574892955, 0.093171747539587416, 0.095538605012336381], [0.094923641607187109, 0.094394870345691925, 0.096522447922582133, 0.09729244905408535, 0.094093004281424281, 0.096479562209925887, 0.099297768334007205, 0.097314049698701097, 0.094629370752967304, 0.094935786650729437], [0.096529210990591002, 0.094612784735601085, 0.099001515618990371, 0.09567521284648299, 0.097441949106714068, 0.095416628572339318, 0.093775083701538725, 0.096716098402094372, 0.095100329325456395, 0.097405802668649191], [0.095981043941685065, 0.099742031946966764, 0.096109818475576661, 0.09496276749922021, 0.097658365510379694, 0.099019421079990178, 0.097218840091803899, 0.096291207538155968, 0.098199363748963972, 0.09579438372553041], [0.099004330009538524, 0.098476792931279131, 0.098871927152978142, 0.099325195784164544, 0.098242953065129923, 0.10267052613473869, 0.096206993014429004, 0.10158704924880188, 0.10088207078534552, 0.10190008540599775], [0.10171475361439489, 0.097491811154939073, 0.098957034573899871, 0.096699673733968886, 0.1078342462248597, 0.10239248320950384, 0.10312134521159806, 0.10300208985838097, 0.10425600940055117, 0.10509095686209194], [0.10567500062276904, 0.1040186268270752, 0.10555878942096462, 0.10278155881596877, 0.10346510127592763, 0.10437174729821384, 0.10553052848519526, 0.10493725534647794, 0.10362381029333542, 0.10611967189817388], [0.10726114464003141, 0.10621889103961753, 0.10845242673963479, 0.10822900617556776, 0.10845936662269409, 0.10593174800567819, 0.10406519313204322, 0.10618118337277836, 0.10626414481054534, 0.10242180248203976], [0.11219491365263118, 0.12044515216646356, 0.11976879153288084, 0.11167978950525774, 0.11812010556965073, 0.11942815802516744, 0.11047931821427397, 0.11911243829554678, 0.11046310740183422, 0.11369526585283549]], 'Rp': [[0.66152495841011427, 0.62884415004343364, 0.70793169576828974, 0.63381542793603385, 0.65272321558543234, 0.66095321081923031, 0.68174182984289389, 0.6283031075625698, 0.67433817512765126, 0.75283125252352423], [0.6472899505843388, 0.64665055295855234, 0.64880681961443287, 0.65478690407171181, 0.64844743600795629, 0.68477960517413428, 0.6760862886636132, 0.65884137826859102, 0.68404650363728725, 0.69221422899373752], [0.66721437360783475, 0.65660524518837249, 0.64291953536030422, 0.6503683810639409, 0.67372829815685109, 0.67945021222837954, 0.63840355425700535, 0.64645193942770807, 0.64669239110458399, 0.67387116239107636], [0.6567387074594917, 0.63783651276107478, 0.65817351265165658, 0.65806625049360234, 0.6449760616284681, 0.65588528771100096, 0.6492639301232882, 0.6663407803390532, 0.65677678018463648, 0.64527754636174084], [0.63530983869675195, 0.64973035882886587, 0.64258966758969061, 0.66271592326936801, 0.65353917619136914, 0.6517520238706459, 0.65348009389462236, 0.64758445087454775, 0.65169576189835321, 0.65464183940848053], [0.63375577659687687, 0.6557387923626864, 0.63501262429034455, 0.64586547173517217, 0.66285544020858622, 0.65549469724162113, 0.66692778302379663, 0.64274636893045645, 0.65149718166764148, 0.66185110308825612], [0.64194937354954684, 0.63223218023936778, 0.65576382079492646, 0.62583071288200642, 0.64298605036064782, 0.6387869677063498, 0.64079611070534404, 0.66335587344955982, 0.63908783789781198, 0.63960481760914756], [0.6321318516126333, 0.63904248123381424, 0.63532918152910467, 0.63486207378558834, 0.64145473977143797, 0.65173433946175496, 0.64141851632427294, 0.6450133341934019, 0.64293878946377481, 0.63463878260585371], [0.6357470392052138, 0.63541186834233987, 0.63307813469844731, 0.62927283391469413, 0.64043625306445051, 0.63207781527047324, 0.62111424604207288, 0.62540279714879965, 0.64554150084791628, 0.63747145992705834], [0.63201930016003827, 0.64102067069848667, 0.61689812496053231, 0.63494829504234218, 0.63052458708286141, 0.63296389189263613, 0.6397385442862501, 0.63064623014431964, 0.63666093647630839, 0.6273041814872341], [0.63478853525447143, 0.61738585092483633, 0.63076655487066091, 0.63554813787156894, 0.62450915318850675, 0.61968288310209063, 0.62342622864118569, 0.63321707406973604, 0.62633205484170518, 0.63596228828008816], [0.61892685792612501, 0.61576220649992675, 0.62006284582684601, 0.6145894267833697, 0.62518255854600557, 0.60398778266394404, 0.63174454362314347, 0.60946631470590085, 0.61237019279956295, 0.6068877565322478], [0.61018391855335796, 0.62457948182292389, 0.61784068053165064, 0.62740411996721357, 0.58318349291545502, 0.60290474420453566, 0.6066187015611042, 0.60105570885696002, 0.59791026688527948, 0.59438115137963576], [0.59338149537836538, 0.59879081435920634, 0.59005858097142427, 0.60063169715242704, 0.60106461470606964, 0.5973501776979101, 0.5915434920726661, 0.59369557411484908, 0.59894951294720689, 0.58935384663441481], [0.58419621649696818, 0.58710516827753401, 0.57794400121461353, 0.58595013996228329, 0.57975329359231331, 0.5850058974078135, 0.59343003891511448, 0.59007200166350771, 0.59031482615515274, 0.60013532660659241], [0.56367378783029409, 0.54158544449638624, 0.54197226995666947, 0.57049080454188461, 0.54162946265357714, 0.53948300394662196, 0.57113227966397995, 0.52750878538105106, 0.57391742945579383, 0.55561283725207244]]} 
average_performances = {'R^2': [0.4433733134924642, 0.4394003976378508, 0.4299563664274024, 0.42284478558429717, 0.41998560876841723, 0.42131099485577606, 0.4084721950250893, 0.40505277120470035, 0.3967301430634377, 0.39570593436430335, 0.3904416482020405, 0.37213095098082855, 0.3571908528001597, 0.3440120548379874, 0.3303934513845458, 0.2734746049148291], 'MSE': [0.089773391946125353, 0.089702193065932939, 0.090682818519871991, 0.092531993040161062, 0.091797460061745481, 0.092082879699339606, 0.093922425235829859, 0.094356680553361327, 0.095988295085730174, 0.096167461596845763, 0.097097724355827295, 0.099716792353240311, 0.10205604038441884, 0.10460820902841017, 0.10634849070206305, 0.11553870402165418], 'Rp': [0.66830070236191741, 0.6641949667974355, 0.65757050927860572, 0.65293353697140133, 0.65030391345226946, 0.65117452391454389, 0.64203937451947091, 0.63985640899816376, 0.63355539484614665, 0.63227247622310079, 0.62816187610448504, 0.61589804859070729, 0.60660622666781183, 0.59548198060345403, 0.58739069102918928, 0.55270061051783304]}

500 iterations

'''