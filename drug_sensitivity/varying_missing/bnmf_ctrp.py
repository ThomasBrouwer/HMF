"""
Test the performance of Gibbs sampling for recovering the CTRP dataset, where we 
vary the fraction of entries that are missing.
We repeat this 10 times per fraction and average that.

GDSC has 0.7356934001670844 missing entries
"""

project_location = "/home/tab43/Documents/Projects/libraries/"
import sys
sys.path.append(project_location)

from HMF.code.models.bnmf_gibbs import bnmf_gibbs
from HMF.code.generate_mask.mask import try_generate_M_from_M
from HMF.drug_sensitivity.load_dataset import load_data_without_empty

import numpy, matplotlib.pyplot as plt, random

''' Settings '''
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]
repeats = 10
iterations, burn_in, thinning = 1000, 900, 2

init_UV = 'random'
K = 3

alpha, beta = 1., 1.
lambdaU = 1.
lambdaV = 1.
priors = { 'alpha':alpha, 'beta':beta, 'lambdaU':lambdaU, 'lambdaV':lambdaV }

metrics = ['MSE', 'R^2', 'Rp']

''' Load data '''
location = project_location+"DI_MMTF/data/datasets_drug_sensitivity/overlap/"
location_data = location+"data_row_01/"
R, M_original, _, _ = load_data_without_empty(location_data+"ctrp_ec50_row_01.txt")

''' Seed all of the methods the same '''
numpy.random.seed(0)
random.seed(0)

''' Generate matrices M - one list of (M_train,M_test)'s for each fraction '''
M_attempts = 1000
all_Ms_train_test = [ 
    [try_generate_M_from_M(M=M_original,fraction=fraction,attempts=M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]

''' Make sure each M has no empty rows or columns '''
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms_train_test,fraction in zip(all_Ms_train_test,fractions_unknown):
    for (M_train,M_test) in Ms_train_test:
        check_empty_rows_columns(M_train,fraction)

''' Run the method on each of the M's for each fraction '''
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms_train_test) in zip(fractions_unknown,all_Ms_train_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for repeat,(M_train,M_test) in zip(range(0,repeats),Ms_train_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
    
        BNMF = bnmf_gibbs(R,M_train,K,priors)
        BNMF.initialise(init_UV)
        BNMF.run(iterations)
    
        # Measure the performances
        performances = BNMF.predict(M_test,burn_in,thinning)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
 
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)

'''
200 iterations
repeats=10 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.40782149920348054, 0.3653120142973486, 0.49934841033677646, 0.45435635423440257, 0.4327143347966125, 0.4294260743940749, 0.4491906480122979, 0.3382706775616051, 0.36107141122674447, 0.48157576924943146], [0.38606824760635006, 0.37979288555123036, 0.3944617668173269, 0.422362269764444, 0.4310007472222208, 0.4527801029904158, 0.4475401170771387, 0.4225353893646312, 0.4508746341867641, 0.4637126138280966], [0.42880241254517937, 0.4089208005163698, 0.36535622978169613, 0.4108171428708386, 0.4496412492163069, 0.4324078110644658, 0.3947735047164893, 0.40377987913150515, 0.3853355878043945, 0.4490511759995456], [0.3934087422386793, 0.35573178512470505, 0.44537304274757195, 0.3901054313613992, 0.38444212896291297, 0.40362699750528874, 0.4001597233970928, 0.42769366022269395, 0.41003465146923, 0.3702533305490556], [0.409486584423831, 0.39507337404827214, 0.3927325129140281, 0.37480540755503533, 0.4045812085450067, 0.4265735873001443, 0.4125524077825258, 0.40014689386353297, 0.40012632565239403, 0.3929501509337592], [0.40724033514998337, 0.38567820847495626, 0.40322680534465205, 0.38234413368367504, 0.4084864764660041, 0.39985078590518297, 0.4031811018726136, 0.4047056073811316, 0.41705452414652133, 0.39167783935658607], [0.3926242280031701, 0.41331214983484776, 0.3854637701969227, 0.4020156985736574, 0.4105722299893425, 0.3812537704341662, 0.3887629342306661, 0.3961923554284813, 0.3983225835479377, 0.393620546755613], [0.37121248604994095, 0.3786820926735275, 0.39299005531740816, 0.3793111719157092, 0.39884462692333045, 0.38964987531995876, 0.38315397233753334, 0.3826683958790609, 0.3583518221298553, 0.37797033142638403], [0.36366858569785876, 0.35643553871537625, 0.3955036817084451, 0.3616728333701622, 0.38005122228606725, 0.37605383704388673, 0.3937782493391865, 0.36456938743497624, 0.3579222018488092, 0.37844534849949785], [0.3629894976399378, 0.3431107092410439, 0.34566006396184124, 0.3626405152461266, 0.352678527165486, 0.3654892267916292, 0.34880061199998513, 0.3451325417079405, 0.3357788683343115, 0.33872641033989326], [0.33306418054018494, 0.3463778818635176, 0.33100311092699897, 0.34682399424163424, 0.340737342526633, 0.32049414308167234, 0.33318143473763984, 0.347915402066153, 0.3043032349048279, 0.3388472572855752], [0.3475982934830978, 0.32894970562084347, 0.30295887281899847, 0.3130982441717667, 0.3264327153732155, 0.3269143895719716, 0.3354838072506465, 0.3476816779897943, 0.29401067636856304, 0.3120994337872328], [0.27806604901656373, 0.296385361355452, 0.28341069427180243, 0.3048494197466115, 0.28805162042460153, 0.3077771513238543, 0.28466332417876405, 0.27746783673034714, 0.31100145295781034, 0.29248807529722454], [0.23145412333267057, 0.2536783712489342, 0.2860408706558111, 0.2491683135199364, 0.26273879293376023, 0.28365156099189814, 0.25316814886238737, 0.24393780832803424, 0.24402210275663472, 0.267684994423803], [0.21438355049235558, 0.2604381101939731, 0.22530599455393263, 0.1778543728212385, 0.1881804300696942, 0.22741791872227235, 0.18845396782090706, 0.18996485943048513, 0.1623666495010334, 0.20764109190660263], [0.16993940191500223, -0.03375256413449934, 0.13512571282579822, 0.0714635269107794, 0.10763664486276525, 0.12947784398485074, 0.05337446786201494, 0.13462174147976413, 0.08820476691064993, 0.19282574399745844]], 'MSE': [[0.098229873832505532, 0.090894106373673303, 0.0784276621472417, 0.089649400605376253, 0.097739254584451568, 0.094117478308922975, 0.086867326955217816, 0.11250644026094248, 0.10251452867983481, 0.08033142388493425], [0.095269602190905772, 0.098758403689884283, 0.096353177799186424, 0.094766450738896058, 0.092109285203379965, 0.087855813792976897, 0.083883135823629495, 0.09371250136498209, 0.090700968384094291, 0.086362054460830923], [0.092382759098379466, 0.095656382393708342, 0.10075723432047802, 0.092453936291564245, 0.086643589488223177, 0.089388551665147142, 0.098145321587479128, 0.092464500238298525, 0.097171234478972995, 0.088885063454890959], [0.0975374408291029, 0.1027558417711094, 0.087593039340633089, 0.096198974116494029, 0.097360819827064085, 0.094796335937728834, 0.096982941784739943, 0.090973615325171148, 0.091580220170240742, 0.10075004093023922], [0.093431740660352661, 0.096247118260140735, 0.097032975149927925, 0.098337344912943048, 0.094415168672435698, 0.091219368455659866, 0.095097434643288098, 0.09476260764123122, 0.093691810483226584, 0.095793796854591315], [0.093722829519699985, 0.096578723254716475, 0.0955756834720876, 0.097294924698601862, 0.094112566569898262, 0.096907162629723695, 0.094849537016407914, 0.095191104648596411, 0.095175040801848187, 0.097337605229557506], [0.097679051826792707, 0.093720602749318302, 0.097909811883676465, 0.095500660480001456, 0.094842443019131639, 0.097613481054174708, 0.09584886952438873, 0.097381862804645405, 0.095731333840514701, 0.097071395243344544], [0.10044927148472738, 0.099357048380720112, 0.097443529168665957, 0.097977007499515809, 0.09572406055762149, 0.096805583260446915, 0.098083801454144137, 0.097860825287757719, 0.10140308270647741, 0.099107114516948314], [0.10131954317292358, 0.10234268046352413, 0.097031247462115028, 0.10226930799904062, 0.097475811118901842, 0.099417268125795308, 0.096170736435050364, 0.10266894721923639, 0.10086419013858465, 0.098857581489540339], [0.1017503895421806, 0.10400477517844485, 0.10241446912023983, 0.10165245601069002, 0.10242286369514425, 0.10202543779955488, 0.10284318931993203, 0.10343725477975781, 0.105965014201667, 0.10533409061247227], [0.10596376495851838, 0.10267910881159258, 0.10795401980237575, 0.10366880231559517, 0.10407147090202708, 0.10716655411065791, 0.10658260328690934, 0.10311485539583831, 0.11143730121628503, 0.10490584233536092], [0.10441582593266355, 0.10581592160908174, 0.11175431748451042, 0.10913525710752882, 0.10663602092601954, 0.10650362216936375, 0.10581729952286766, 0.10377095955254062, 0.1118724577169057, 0.1098314041241832], [0.1149803617661618, 0.11124932517744159, 0.11406196796261943, 0.11025306904861364, 0.11403922931397675, 0.11072024310657644, 0.11329714148611843, 0.11478949948100162, 0.10989080417906369, 0.11325846148444084], [0.1226593533153733, 0.11920969832405295, 0.11309081204462373, 0.1190023994806419, 0.11707734298214946, 0.11386057392922518, 0.11889533982063216, 0.11988645405797572, 0.12021814173288027, 0.11663213432500576], [0.12466324411820391, 0.11832080928022928, 0.12268058041381057, 0.13080220694126657, 0.12971771108742275, 0.12229568817110167, 0.12837251875949271, 0.12926268209883834, 0.13314884747399477, 0.12591186328278559], [0.13199923151063192, 0.16493028713922098, 0.13729005101699673, 0.14775955011065534, 0.14163929293701077, 0.1383191266718794, 0.15091244224335029, 0.13776481052621106, 0.14495199531661551, 0.1280624508317843]], 'Rp': [[0.64047248427964398, 0.60862708702244239, 0.70806365491494649, 0.67429787709274003, 0.66287655182560656, 0.65930531986848695, 0.6722514776352827, 0.59297498378995783, 0.60639697628695455, 0.69575851922926635], [0.62397566743231758, 0.61907457587281811, 0.62962658784136361, 0.65044075081856689, 0.65694018896134831, 0.67339133933446327, 0.67324923061697184, 0.65052998405280094, 0.67166241983865871, 0.68112894903287113], [0.65582189477365027, 0.64128780591663692, 0.6103582922556483, 0.64150597453986424, 0.67061024992566032, 0.65847277428854922, 0.63293784562650957, 0.63716621525424977, 0.62531493941214378, 0.67039181914750445], [0.63009234035330131, 0.60135702562663695, 0.66751825663989328, 0.62697249691830281, 0.62330557569417033, 0.63698628108195088, 0.63467370863236106, 0.6542668053043329, 0.6421340171677582, 0.61410170567640299], [0.64166926230280408, 0.62974652802416931, 0.62852654407216568, 0.6171799692853166, 0.63831810725294702, 0.65363071828112462, 0.64299305753137503, 0.63493362458572666, 0.63399882542908892, 0.62917490615996485], [0.63987770741336314, 0.62304507815578825, 0.636917795639666, 0.62382144869327483, 0.64229386979127379, 0.63415949277150707, 0.63693802352841278, 0.63759882276808477, 0.64640359987929186, 0.62812908444049131], [0.62878993404804739, 0.64429943878640306, 0.62432001589029484, 0.63536954599153128, 0.64198765189243112, 0.6212413877158538, 0.62754881764092296, 0.63099093366842818, 0.6335269502116222, 0.62994402337793398], [0.61384688589290937, 0.6205372619368138, 0.6285251060293281, 0.62107434315703902, 0.63346355311329705, 0.62612759194678524, 0.62257717661882817, 0.62358362267019429, 0.60380319350837675, 0.61844392271297655], [0.60960970697617045, 0.60122327780333329, 0.63100575640279322, 0.60771074613117915, 0.62022762659243003, 0.61689382889900535, 0.62970342916815092, 0.60931334941078874, 0.60722481954621266, 0.61879712735566161], [0.60878725417285695, 0.59847273881832264, 0.59836813494209573, 0.60781149312794791, 0.60073252168561031, 0.61095123350844993, 0.60053367273829672, 0.59601211170979751, 0.5893017714937695, 0.59156326878106702], [0.58860285407538859, 0.60238255183975642, 0.58624133224481667, 0.59596187395706057, 0.59242933354329086, 0.58025617789045991, 0.58812429494414464, 0.5997970979589079, 0.56878555133841724, 0.59400492389503334], [0.59665952714312032, 0.58756696831218647, 0.56880916324306141, 0.57457378833949602, 0.58440505734705162, 0.58627160768197084, 0.59104309726545845, 0.596595126473492, 0.56295489782000085, 0.57087978118017912], [0.55100017482390262, 0.56777606401232161, 0.55634068802470638, 0.56786331213053498, 0.55647651946798593, 0.57223228813962501, 0.56212556531780145, 0.55998943505895526, 0.5695432272718185, 0.56359900139496255], [0.53504724979487328, 0.54131421363272281, 0.56440931697537411, 0.54056044083128674, 0.5467651754210503, 0.55908868216546526, 0.54664955515360891, 0.5426831853360693, 0.54852048462625436, 0.54349650719693876], [0.53105809586595232, 0.53823971923504277, 0.52775992376692149, 0.51144194783768715, 0.5079256199353327, 0.54176400202222186, 0.51178883300621592, 0.51592645755208644, 0.50984750976651516, 0.5288570761476038], [0.50281960343983867, 0.43675375804309235, 0.50184768932772394, 0.47091016432299254, 0.50337051654263398, 0.49266395193050039, 0.4645180421671562, 0.48817343214388609, 0.48750907000076238, 0.51209914082676022]]} 
average_performances = {'R^2': [0.4219087193312774, 0.42511287744086185, 0.41288857936467915, 0.398082949357863, 0.400902845301853, 0.4003445817781307, 0.3962140266994805, 0.38128348299727083, 0.3728100885944266, 0.3501006972428195, 0.33427479821748374, 0.323522781643613, 0.29241609853030315, 0.257554508705387, 0.20420069455124948, 0.10489172866145839], 'MSE': [0.093127749563310075, 0.091977139344876613, 0.093394857301714207, 0.095652927003252328, 0.095002936573379729, 0.095674517784113788, 0.096329951242598869, 0.098421132431702529, 0.099841731362471223, 0.10318499402600836, 0.10575443231351604, 0.1075553086145665, 0.11265401030060143, 0.11805322500125606, 0.12651761516271462, 0.14236292383043564], 'Rp': [0.65210249319453273, 0.65300196938021804, 0.64438678111404157, 0.6331408213095111, 0.6350171542924683, 0.63491849230811537, 0.63180186992234699, 0.62119826575865489, 0.61517096682857253, 0.60025342009782146, 0.58965859916872765, 0.58197590148060174, 0.56269462756426136, 0.5468534811133644, 0.52246091851355803, 0.4860665368745346]}

1000 iterations
repeats=10 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.4174630202610329, 0.3666746166768625, 0.5091402523076292, 0.4573576652284276, 0.4386313141448147, 0.4324939240790676, 0.4501422768947291, 0.34374634720978336, 0.38570273558537616, 0.4873517765173391], [0.3854015040454287, 0.3745952205910946, 0.40618821328844323, 0.43373011575132314, 0.42978661853255584, 0.4575492097950761, 0.4516892778498741, 0.4236881276462031, 0.4494130857560533, 0.474090295603798], [0.4390701326764237, 0.41690369587882914, 0.3723053409854573, 0.4156485854878198, 0.4540839752553454, 0.4403859108577671, 0.4017918275436424, 0.4062533748205137, 0.3964261469234257, 0.44721345436276694], [0.3967978462873807, 0.36385230898531595, 0.45443680825713473, 0.3930885985038477, 0.3943567019646541, 0.41221159000717944, 0.3998109918783348, 0.44140217692796613, 0.41206532157289055, 0.38280852507410057], [0.4177149668127036, 0.402998919669738, 0.3984841087486376, 0.3857639732077035, 0.4109639314408441, 0.42904129185257744, 0.40991309726670755, 0.42187549112480194, 0.4012744958478478, 0.4020957198799794], [0.41246457786733615, 0.39153998320290684, 0.40602392730707637, 0.3942906291937873, 0.415168656637925, 0.4074051041975788, 0.4244517015989613, 0.40873924255991334, 0.41765069589271675, 0.4025869108099741], [0.39851847929965634, 0.4194496580436433, 0.3894755290738521, 0.4045116065867127, 0.41717145889917895, 0.390928417610814, 0.4002924109880003, 0.40744132590805016, 0.40610251422038923, 0.4058414909239426], [0.3755063646951242, 0.38455303111366457, 0.40112874132828535, 0.39046233496131455, 0.4043394321232817, 0.39894475483629543, 0.38988951111510317, 0.3859478561503953, 0.367628333728212, 0.3904120854502089], [0.37081099179411003, 0.37196279544359523, 0.402111971600144, 0.3738399489868993, 0.3933904013549695, 0.38474161285183606, 0.4068627757870832, 0.3791114425837655, 0.3646784728393634, 0.3850873101814376], [0.37217639947915104, 0.3616292935427936, 0.3650589372602415, 0.37595478441081787, 0.3528191414019699, 0.3796272828414017, 0.36095675495492974, 0.3607004777125258, 0.3528189332071331, 0.3512988369068131], [0.33952530628726396, 0.3524555835368216, 0.3461324737368955, 0.3604345415189, 0.33594302218602645, 0.3486731002373131, 0.3412371203872846, 0.36226349310548167, 0.34516208288247274, 0.34694251307723745], [0.35494125309822344, 0.3502445586849394, 0.3231395967105877, 0.35416995827180475, 0.32644313236911615, 0.3404258514945806, 0.3503910249883678, 0.3619422413395099, 0.3166579868768633, 0.3185223114473654], [0.31924222248795353, 0.2992882850089541, 0.31035274792195167, 0.3074017036807404, 0.3177684684866674, 0.3228489429689648, 0.29671384470780304, 0.3098531432110465, 0.3254236171107272, 0.31275958680482185], [0.29317403541366316, 0.30507611747542684, 0.2741506233097689, 0.2615647148023601, 0.2909154760928614, 0.31400144077026637, 0.28244857323894157, 0.26258995372448524, 0.2773584507721849, 0.2615423050034986], [0.21385762968655908, 0.27103673101798287, 0.25762355543655213, 0.19731355525350047, 0.22791606677838439, 0.24946782203398732, 0.2435011005785963, 0.2246812435678347, 0.22295419195518806, 0.21472339592397405], [0.21412799861003173, 0.024553319453125777, 0.10880360025605129, 0.15524928174935293, 0.11772573695809296, 0.11282543383869348, 0.11953758113940793, 0.09607103031027897, 0.1158388925978191, 0.17241675807551327]], 'MSE': [[0.096630549649403777, 0.090698967142399792, 0.076893758550918762, 0.089156284386150156, 0.096719801447595857, 0.093611429463673498, 0.086717246973874243, 0.11157547335457757, 0.098562492956666733, 0.079436413851300236], [0.095373067101402212, 0.099586051555281746, 0.094487266912196638, 0.092901457577380039, 0.092305827686000125, 0.087090136664497567, 0.083253145072424053, 0.093525431913805829, 0.090942377479828557, 0.084690864830420667], [0.090722107274549157, 0.094364482945939798, 0.099653980402716294, 0.0916957915449855, 0.08594416619280551, 0.088132102405511156, 0.097007209564552874, 0.092080899392368312, 0.095417947157833374, 0.089181544719904707], [0.096992486493898883, 0.10146068046149713, 0.086161585714962921, 0.095728437677118666, 0.095792663523484575, 0.093431773975175963, 0.097039325141945881, 0.08879451431100209, 0.091264999597287622, 0.098741397735050501], [0.092129836132643944, 0.0949861208201533, 0.096113949403349344, 0.096613663576987738, 0.093403064473763522, 0.090826811632634827, 0.095524692602306921, 0.091330003032202928, 0.093512482486424686, 0.094350606027509359], [0.092896810411784006, 0.095657182252847014, 0.095127712876712775, 0.095413078440100871, 0.093049400469308138, 0.095687353398744276, 0.091469103617875025, 0.094546102456103898, 0.09507770636386155, 0.095592045131224421], [0.09673112979167961, 0.092740164909084724, 0.097270646057621424, 0.095102053253732222, 0.093780587735591059, 0.096087207529168828, 0.094040917462438312, 0.095567633207217492, 0.094493489241240375, 0.095115022719071921], [0.099763321188031842, 0.098418206754302268, 0.096137022916762266, 0.096216773488667404, 0.094849103617586972, 0.095331353639561286, 0.097012793101136863, 0.097340957705231809, 0.099937066117825712, 0.097124787301498178], [0.10018229722440895, 0.09987346227419279, 0.095970512115380352, 0.10031995888855602, 0.095378464779747499, 0.098032990141259574, 0.094095013247905646, 0.10031933191426476, 0.099802845541744081, 0.097801184812856101], [0.10028295558722621, 0.10107274199717428, 0.099378241005514761, 0.09952896339317463, 0.10240061491554804, 0.099752125164027733, 0.10092338329069864, 0.10097827694766176, 0.10324656603709599, 0.10333143219706621], [0.10493721159303046, 0.10172434768261367, 0.1055126399408938, 0.1015086048762301, 0.10482830425845388, 0.1027223808838113, 0.10529500274228094, 0.10084597596299393, 0.10489249609733017, 0.10362135907925596], [0.10324059725783838, 0.10245799967479211, 0.10851880821984364, 0.102609764866284, 0.10663437175596897, 0.10436567773366828, 0.10344347998074545, 0.10150238561765637, 0.10828372032041196, 0.10880591627524309], [0.10842235003193426, 0.11079034055751401, 0.10977350923776077, 0.10984826878689392, 0.10927921222866552, 0.10830952748488069, 0.11138854435205914, 0.10964440932385808, 0.10759056243897556, 0.11001339928103115], [0.11280890101008663, 0.11099995391070955, 0.11497422199416873, 0.11703764289924461, 0.11260287563367137, 0.10903658808368763, 0.11423390766419718, 0.11692884078649435, 0.11491688381885438, 0.11761044962939043], [0.12474669832011241, 0.11662516026094297, 0.11756276989925066, 0.1277062785275293, 0.12336849750182866, 0.11880530421713696, 0.1196650162859506, 0.12372275833304677, 0.12351794936774468, 0.12478643125185385], [0.12497220141339092, 0.15562786172752271, 0.14146842032588544, 0.13442658387892423, 0.14003791401156304, 0.14096506372527051, 0.14036462087985535, 0.14390193191518183, 0.14055887994178137, 0.13130044403674529]], 'Rp': [[0.64752070399107042, 0.61063498232004942, 0.71536820930868428, 0.67644117306560447, 0.66776410142548204, 0.66197162760784545, 0.67245654097203911, 0.59674632310755471, 0.62377348131153254, 0.69913546818262573], [0.62364048394477101, 0.61485797080310711, 0.63809813534587989, 0.65879354857532424, 0.6560274720505862, 0.67684944321061291, 0.67608833970471327, 0.65130912030859445, 0.67072166613141715, 0.68892886211281068], [0.66294480154541968, 0.64672308329586348, 0.61508556914364743, 0.6450841281604508, 0.67387482527301135, 0.66414055068929223, 0.6370493390672044, 0.638680734161855, 0.63273491650232383, 0.66904581076726033], [0.63297791908757017, 0.60761836715694251, 0.67420500585179033, 0.62902654925445467, 0.63023422945856045, 0.64278594712214931, 0.63424032956524257, 0.664415119410806, 0.64332462102597654, 0.62249224781047618], [0.64751297492526105, 0.63563990139193505, 0.63223094083557552, 0.62451626979574981, 0.64271174088575134, 0.65552819033867726, 0.64121162660366116, 0.65014183368711997, 0.63514038231999148, 0.63533556186210427], [0.64321909475724026, 0.62734689883286365, 0.63852316868029746, 0.63139014603161259, 0.64663527825045575, 0.63941078988495992, 0.65248156820498082, 0.6400523208779596, 0.64666106381767618, 0.63588804681724187], [0.63309050205634054, 0.64868207888110585, 0.62667729538458183, 0.63713708667248814, 0.64665475542264339, 0.62825926267349219, 0.63501791980856981, 0.63931508170663409, 0.63890677188054401, 0.63836177230719293], [0.61745526625303737, 0.62431158787854746, 0.63440965258834048, 0.6281106671691461, 0.63696623636231853, 0.63258337724388281, 0.62692637060607048, 0.62516695413873835, 0.61015165509317104, 0.62685771391948142], [0.61373076601209708, 0.6123408996592633, 0.63540674153540433, 0.61561192413676535, 0.62929245647852727, 0.62290956142043763, 0.63923418457136294, 0.61824386489227467, 0.61125667583966015, 0.62332266328528785], [0.61475044085662323, 0.60953722475204886, 0.61114919622791308, 0.6174464051917018, 0.60055456131697094, 0.61970096124802021, 0.60820997052894521, 0.60642199381901363, 0.60033931861396517, 0.59891903843712979], [0.59146660418006913, 0.60539740923790175, 0.59555835447423044, 0.60542101797957271, 0.58860821509890382, 0.59741611330417932, 0.59422455520220852, 0.60963051810768087, 0.59528091557205209, 0.59903495429479325], [0.6013131925257067, 0.60035538581706893, 0.58210538859776317, 0.60272724608277761, 0.58257544502032343, 0.59272163755818175, 0.59968124654154276, 0.60571010285105753, 0.57809648711685213, 0.57483233155512903], [0.5787186266748845, 0.56827154156638193, 0.57110890028661143, 0.56986464340270815, 0.5738339974645591, 0.58125096355367378, 0.56761171266479094, 0.57602579557249278, 0.58160157150945802, 0.57451640903286338], [0.56414494911112945, 0.57056001361099795, 0.55908897337440711, 0.5461207390724373, 0.56709806760274739, 0.57671608059125445, 0.56440627304070756, 0.55233116501789226, 0.55624933314000991, 0.53856374264874662], [0.52724996258527879, 0.54512446497634526, 0.53918514814697516, 0.51968076214185699, 0.52872135907296303, 0.54330635654493931, 0.53785884661040373, 0.52859667382068287, 0.53172876088331245, 0.53024999940837025], [0.52492228962505827, 0.45831784852438795, 0.49637270044801218, 0.5001467164977943, 0.50984092789675328, 0.4841823977626693, 0.49181366100643031, 0.48497844962937986, 0.49305691204830299, 0.51698652581843696]]} 
average_performances = {'R^2': [0.4288703928905061, 0.42861316688598505, 0.4190082444791991, 0.4050830869458804, 0.4080125995851541, 0.4080321429268176, 0.403973289155424, 0.3888812445501886, 0.3832597723423204, 0.36330408417177773, 0.3478769236955697, 0.33968779152813583, 0.3121652562389631, 0.28228216906034576, 0.23230752922325593, 0.12371496329883676], 'MSE': [0.092000241777656061, 0.091415562679323742, 0.092420023160116674, 0.094540786463142429, 0.093879123018797653, 0.094451649541856197, 0.095092885190684609, 0.097213138583060466, 0.098177606094031589, 0.10108953005351884, 0.1035888323116894, 0.10498627217024523, 0.10950601237235731, 0.11411502654305047, 0.12205068639653968, 0.13936239218561208], 'Rp': [0.65718126112924891, 0.65553150421878159, 0.64853637586063284, 0.63813203357439685, 0.63999694226458259, 0.64016083761552889, 0.63721025267935927, 0.62629394812527328, 0.62213497378310811, 0.60870291109923325, 0.59820386574515916, 0.59201184636664039, 0.57428041617284242, 0.55952793372103304, 0.53317023341911285, 0.49606184292572253]}
'''