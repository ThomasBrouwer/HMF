"""
Plot the performances of the many different algorithms in a single graph, as we 
vary the fraction of missing values on the GDSC dataset.

We plot the average performance across all 10 attempts for different fractions.

We have the following methods:
- Non-probabilistic NMF
- Bayesian NMF
- Non-probabilistic NMTF
- Bayesian NMTF
- HMF D-MF
- HMF D-MTF
"""

import matplotlib.pyplot as plt, numpy
metrics = ['MSE']

MSE_max, MSE_min = 0.12, 0.075
fraction_min, fraction_max = 0.25, 0.95

fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]

np_nmf_all = {'R^2': [[0.5060407585284845, 0.5333029308536477, 0.5660821396803861, 0.5137703787512382, 0.49743459828016856, 0.5669949001145442, 0.5328920856008045, 0.5191225983808463, 0.555947819431266, 0.5521915852926196], [0.5353482719877596, 0.5136404101319185, 0.5507475327656193, 0.534602809669845, 0.5507852488934213, 0.49960367369528125, 0.563375763464464, 0.5762588602197325, 0.5460698716923946, 0.5815914374647371], [0.5413235830967862, 0.5435399168135089, 0.5369243182516463, 0.540513760265547, 0.5422711283731333, 0.5320805062153848, 0.5425019475576691, 0.5260824335769881, 0.5615687036012784, 0.5082806822547911], [0.5199749336034657, 0.54941254535977, 0.5264677795943207, 0.5243271107886658, 0.5401872957128717, 0.525558314127241, 0.5133127267335235, 0.5306185646853838, 0.5448813253122764, 0.5314537630275766], [0.5306562348444082, 0.5093274679339992, 0.4916921852081604, 0.501363411557203, 0.5228836878361556, 0.5170831672581779, 0.5253806533287051, 0.5271145913260202, 0.5515294909667621, 0.5041927634873182], [0.538108582572649, 0.5386914358694668, 0.5014027795655667, 0.5271336447678613, 0.5192723339727278, 0.4776226718649689, 0.5237195269209831, 0.5112992943523629, 0.5186291310310054, 0.5215940202617795], [0.48932083944897653, 0.4894941140910466, 0.499325782562852, 0.4849452698937615, 0.46495204228439535, 0.48152148111551807, 0.5053567072328169, 0.4766432746544387, 0.48203139593765987, 0.488428163090442], [0.47303349347746415, 0.49948915687121176, 0.4729960182241406, 0.4874696492182983, 0.46612324370865044, 0.5012274653330921, 0.48536010756879666, 0.486785565486214, -0.05336260639755719, 0.4589329859109218], [0.4286950422674076, 0.47212032600126064, 0.4738216598729905, 0.47746221887939155, -0.08023051647942459, 0.44381802425038686, 0.45846300364364967, 0.4745212734390918, -0.2783343381771637, 0.4691930963026597], [-0.12079422316204314, 0.41148222026951087, 0.42999039612322854, 0.38733334403224584, 0.39019657533009855, 0.28866990505404466, 0.39878571826657006, -0.12226363087425818, 0.41504534216039657, 0.41300696875144505], [-15.586261023257677, 0.28658008557054204, 0.3299359483728901, 0.24254343064608652, 0.22352930901244128, 0.3299037909466137, 0.024224736701983662, -567.3675272143224, 0.0682473661574764, -4.846320524734421], [-1188661.821222181, -0.9307448264729832, -99.17123266808007, -15.21792039294833, -0.07816292026035443, 0.13133157072106905, 0.13267755619808974, -2.7032089081133517, -3.808632155534461, 0.14283198640511452], [-0.17768235700969126, -28421.619551367272, -32494.20575735634, -3902.0031605461163, -1206782.4303194135, -4.664829858847253, -1775.8925601829337, -0.28610945794340736, -57523.119147280304, -1547531.237535557]], 'MSE': [[0.096760538665035423, 0.090324488184432963, 0.086316216141761201, 0.09639894270408271, 0.099378582071684374, 0.088851297131436011, 0.09318172025369989, 0.096236105311380979, 0.0885577668074983, 0.087216168812378383], [0.092155335788594417, 0.097798143248055414, 0.089822746851471014, 0.093560685394138768, 0.089975355210008739, 0.09934791027095502, 0.087023022204003778, 0.084208765073924441, 0.090857959005191252, 0.083108965030300186], [0.091113434243296806, 0.092752679383306558, 0.092069408614374654, 0.091211566681915851, 0.09134889949902246, 0.094833404794292933, 0.091405461632530119, 0.094599279254931126, 0.087516016532757313, 0.097165531291851931], [0.096287095130200132, 0.089683748662104906, 0.093589493118144088, 0.095244388962619997, 0.091044400578677395, 0.094229105246533648, 0.096578071431975124, 0.093733800203385467, 0.090326922571444965, 0.092895447209534118], [0.094009853102214283, 0.098209408117003807, 0.10148795096447902, 0.0998082078243199, 0.095052325040520053, 0.095766238893703753, 0.094377060712564409, 0.094530392822133644, 0.089077690412530997, 0.099003813827430079], [0.091984019577862397, 0.091942364919121777, 0.099596354082737676, 0.094798244498704914, 0.095787921952934549, 0.10479939503334078, 0.094295447297515975, 0.097633472947215749, 0.096090208503715427, 0.094883749700071879], [0.1019944897418615, 0.10144226838736421, 0.099588911856066165, 0.1024209085965252, 0.10649188092320717, 0.10383896574756574, 0.098695190286347365, 0.10409256037651406, 0.10372733057214543, 0.10167882864195951], [0.10511209250063071, 0.10017617263803127, 0.10498811278562427, 0.10267905478576936, 0.1063264169715642, 0.099497647142122794, 0.10246688508032635, 0.10281694451253477, 0.2108173758808948, 0.10811212299784881], [0.11369657949356118, 0.10605527809535809, 0.10498125277954119, 0.10462458276653122, 0.21558385704954192, 0.11088407217274315, 0.10749821427187763, 0.10502861531826606, 0.25603278128213802, 0.10553777222653252], [0.2244129572693376, 0.117544560032038, 0.1134249058784559, 0.12220792050062043, 0.121357557528417, 0.14080197410126366, 0.11983387593407878, 0.22406814853736512, 0.11684092732753446, 0.11686433879934108], [3.3047994172491286, 0.14216680618796254, 0.1335687067101429, 0.15116688223249158, 0.15470559120679581, 0.13332554624116352, 0.19507440763848435, 113.26023859056689, 0.18585341834616484, 1.1692745172032815], [237434.75629302333, 0.38580731994270689, 19.918137636333764, 3.2302457065538666, 0.21461866719342804, 0.17315837861905781, 0.17311674523923068, 0.73939416731584195, 0.95959115410932594, 0.17114335946849676], [0.23483483943512395, 5660.3399970662231, 6471.2825482423459, 777.43449043939904, 240758.34687214188, 1.1305497899600496, 354.69513419505415, 0.25658072898424977, 11475.777657530738, 308294.049490089]], 'Rp': [[0.71936774493401445, 0.73601788610757934, 0.7558103085462351, 0.72175443462117383, 0.71488333997081333, 0.75620751626722238, 0.73542856114543886, 0.72710324944228288, 0.74791265957935438, 0.74773224990154097], [0.73532579050929947, 0.72105867731621565, 0.74510011085101724, 0.73392044181579441, 0.74453219420196826, 0.71693432646959865, 0.75291020130832909, 0.76258153026675313, 0.741607917978652, 0.7649079795229603], [0.73988489974167526, 0.74066964916274924, 0.73690922692076644, 0.73973414766407564, 0.74035025240224794, 0.73350795305658445, 0.74015270355217611, 0.72966064218429305, 0.75100944921140877, 0.71826572210447603], [0.72678618043073806, 0.74402781107491023, 0.73303250924590868, 0.729702362725693, 0.73981588669015097, 0.73059280062328491, 0.72255324238049057, 0.73275946455891061, 0.74274389135903229, 0.73274352262972642], [0.73375684699666788, 0.7209571063582888, 0.71166272473410186, 0.71586576438512772, 0.72972613937233566, 0.72482147875456648, 0.73069472316210948, 0.73397198882758874, 0.74625415236094816, 0.7197409809858144], [0.73781326157856986, 0.73952713758763655, 0.71922970543752651, 0.73214862002733538, 0.72817286728340491, 0.70590737603396492, 0.72986192308613962, 0.72271809059891878, 0.72857152093410316, 0.72844919814905074], [0.7090030922591557, 0.71124066684141063, 0.7196460201647048, 0.70752265540125481, 0.70226122892012366, 0.70458381341803789, 0.71961433658583285, 0.70666099835355878, 0.7067652407499958, 0.71019218836891107], [0.70278043766541498, 0.71791032283735901, 0.70535447163171061, 0.71019389000639566, 0.69926174325538604, 0.71806839386349686, 0.70938963329904337, 0.71076921039046792, 0.54653432731718321, 0.69705302673219083], [0.68446388118227797, 0.70243049516425538, 0.70399575649984192, 0.70686373641365519, 0.53602519485722488, 0.68679951948732609, 0.69633473310859773, 0.70482050513513361, 0.50361525577634891, 0.70068933449250448], [0.51711941342211432, 0.67404256817611741, 0.67919988791866381, 0.66376288087402158, 0.6676404294667303, 0.62446674646254263, 0.6646425729679396, 0.50964386856596977, 0.6718736700598823, 0.67896154448486568], [0.16865969467316133, 0.61730645521328054, 0.64528336160044697, 0.61092086241950982, 0.59331726324419698, 0.64515944937029557, 0.55208083043186262, 0.050842322101870847, 0.54386367722875417, 0.25599369973762803], [0.017812336829178117, 0.42023736151618452, 0.1019380477580181, 0.15147683029764161, 0.11841864086602573, 0.57499480063689801, 0.57172941885038375, 0.28957928089971424, 0.28236882475112379, 0.57574772978988564], [0.10198214161157389, 0.012119784883604951, -0.0064491381963088191, 0.036109417980537052, 0.039182938294302284, 0.26633310110718644, 0.033367438935612156, 0.084046302464303044, 0.0082023116624770406, 0.034751568836944781]]} 
np_nmf_avr = {'R^2': [0.5343779794914005, 0.5452023879985173, 0.5375086980006734, 0.5306194358945093, 0.518122365374691, 0.517747342117937, 0.48620190703119076, 0.42780550794012323, 0.3339529790000251, 0.2891452615951239, -58.62951440949065, -118878.33242829393, -287843.56366533774], 'MSE': [0.092322182608339007, 0.090785888807664306, 0.092401568192827993, 0.09336124731146199, 0.096132294171689989, 0.096181117851322107, 0.10239713351295562, 0.11429928252953474, 0.13299230054560912, 0.14173571659084522, 11.883017388358251, 23746.072150615815, 57379.354815506304], 'Rp': [0.7362217950515656, 0.74188791702405887, 0.73701446460004527, 0.73347576717188445, 0.72674519059375497, 0.72723997007166508, 0.70974902410629859, 0.69173154569986484, 0.66260384121171656, 0.63513535823988465, 0.46834276160210064, 0.31043032721950536, 0.060964586758023284]}

bnmf_all = {'R^2': [[0.5923533943294081, 0.5991350843196055, 0.6007044498912247, 0.5744902174090325, 0.5501470878750272, 0.6186899830827047, 0.5820741952740597, 0.5565382957700464, 0.592445919147702, 0.6102212540751321], [0.5843584200471561, 0.5577209747229808, 0.5867989811984127, 0.5880021347153404, 0.5870678143732664, 0.5741903317303563, 0.5942733956215251, 0.6213643257799004, 0.6032580528387865, 0.6237180650482266], [0.5982749104309668, 0.6030913585516778, 0.5840712914869829, 0.611932135248803, 0.5952274456558648, 0.5725260293272678, 0.6011691992800176, 0.5729982350891835, 0.600374624877186, 0.557317627952185], [0.5719512931666189, 0.5884006829657022, 0.5851269371092542, 0.5765511168285826, 0.58231337582395, 0.5847597607117514, 0.5561614199833786, 0.5932868088607928, 0.5914669907387123, 0.5867235882178172], [0.5831027017288415, 0.56227589016256, 0.5568972815663149, 0.5869045476656923, 0.5765204541670509, 0.5629303559448242, 0.5797881630253932, 0.5807442736203889, 0.6062434442158906, 0.5857398024770943], [0.5805980010079161, 0.575207716305278, 0.5605719374054928, 0.5780837095027225, 0.5775776592156647, 0.5765878771950708, 0.5631313974080776, 0.5570709572597301, 0.5708044056153928, 0.566630256868627], [0.5658801441299577, 0.5551078793712377, 0.5681087323911298, 0.5517856961448194, 0.5543975658172542, 0.553179178667723, 0.5642047283299937, 0.5571100141228819, 0.540731518648598, 0.5622544836669048], [0.5491022290555071, 0.5525235753375504, 0.5449311684398249, 0.5587562654876947, 0.5470959428284891, 0.5584695000498993, 0.5438336271217057, 0.5527372596151212, 0.5434879943994753, 0.5452329142742753], [0.5360160971503218, 0.525707115705761, 0.5350982402990041, 0.5356828205948614, 0.5256106136094455, 0.5270553724185051, 0.524102670805259, 0.5429055514040031, 0.5371084505738861, 0.5431299134532274], [0.5289388446547849, 0.5336832860000369, 0.5189149004869333, 0.5149555246051865, 0.5116249439284463, 0.5070004243344017, 0.5198758476400127, 0.5190006730196616, 0.5011354537737912, 0.5289367962401653], [0.5015513776943872, 0.4716554627523245, 0.4961481781612942, 0.47355336027117734, 0.4809833940847442, 0.5000891774682077, 0.49197597287519645, 0.4895150790084094, 0.4989098407917405, 0.48014273522670126], [0.4840496017388276, 0.4326627484792339, 0.4494322967868375, 0.4584426795053915, 0.4465913505184592, 0.43959519010410697, 0.452278324729367, 0.46009668986368224, 0.43501290003661597, 0.4646169973079257], [0.4150869435002872, 0.3886654496639256, 0.39577072562226356, 0.4297009623319413, 0.3996643743582582, 0.4149680253058745, 0.400194075326325, 0.4517814299376899, 0.43729084905343696, 0.41118087150880533]], 'MSE': [[0.079852955138879259, 0.077583342029887481, 0.079429044433077398, 0.084360745128334413, 0.088955078075032806, 0.078243627202713911, 0.08337055361792442, 0.088748248776385083, 0.081278914580119932, 0.075914180679865981], [0.082435052016522792, 0.088934336591130717, 0.08261468376359879, 0.082825602427057027, 0.082708147913414562, 0.084539590904184406, 0.080864854369369077, 0.075245095521150385, 0.079411260286265814, 0.074741305445452086], [0.079800380362817322, 0.080651827664149023, 0.082695575967092455, 0.077034467764080988, 0.080780413206896995, 0.086636296709816207, 0.079684084464330993, 0.085234357329332752, 0.079769900605707572, 0.087475651904022261], [0.085861279838203228, 0.081923651709015458, 0.081996024750021698, 0.084787531619543263, 0.082703300655419296, 0.082471075741396574, 0.088075190044350493, 0.081219175131566304, 0.081081114768018367, 0.081937478234228145], [0.083504792603751654, 0.087611641036174623, 0.088469202424206222, 0.082686103895069266, 0.084366672051032862, 0.086674377673125039, 0.083558241627593649, 0.083809751327974025, 0.078210102710325247, 0.082720332523067389], [0.083522404250670659, 0.084664387785429701, 0.087777129760010772, 0.084583991273628062, 0.084170229986160847, 0.084944985032483961, 0.086492566082615144, 0.088489130897835444, 0.085675093388231954, 0.08595157246437847], [0.08670381837884196, 0.088404202870043747, 0.085907322333217406, 0.089129394535096593, 0.088689323406974038, 0.089487626336856849, 0.086953361932284243, 0.088088201340352515, 0.091972164360700381, 0.087005280847561192], [0.089938938473728011, 0.089561447436814226, 0.090657413350212449, 0.088397671514995849, 0.090199966684167646, 0.08807871892115815, 0.090824570723455761, 0.089604238049623766, 0.09136517899374158, 0.090868291407722762], [0.092338394722583844, 0.095289260451038207, 0.09275556485476566, 0.092967423451018549, 0.094674879205182291, 0.094289330659766676, 0.094468362105267364, 0.091360495828063354, 0.092710809130389815, 0.090837272076216766], [0.094319032647660991, 0.093137361130895491, 0.095730022372735049, 0.096751269407151078, 0.09719198280122876, 0.097585233603922655, 0.095698222505585351, 0.096035036402492807, 0.099644981727596796, 0.093783889943289483], [0.099315494565916471, 0.10528589671824491, 0.10043642253770242, 0.10506384182192544, 0.10340991848918447, 0.099464647890002464, 0.10156281869918748, 0.10172580448388654, 0.09995069035052373, 0.10397237881685086], [0.10306081327964041, 0.11336705996138068, 0.10947537530118041, 0.10786606217041005, 0.11016129801269951, 0.11170981352740612, 0.10932473199262316, 0.10779876813179515, 0.11274653701401414, 0.10689531600552432], [0.11663413558762122, 0.12174674472217376, 0.12032969994450937, 0.11359717722737113, 0.11976947078209615, 0.11675686518234596, 0.11973050465201732, 0.10937041126672135, 0.11225769638622908, 0.11730252148340431]], 'Rp': [[0.76978818999819942, 0.77418322299977649, 0.77512000934701486, 0.75824463203399994, 0.74612936676431174, 0.78682627886802581, 0.76441821017553047, 0.7470059190320224, 0.77203795875798231, 0.78135134075136958], [0.76474205576364407, 0.74721527739896154, 0.76622351022162871, 0.76699802956663143, 0.76625127176749408, 0.75882806754243237, 0.77091007200076656, 0.78920942816202655, 0.77675031750472878, 0.78981480432890605], [0.77422917968603322, 0.77676953903346546, 0.76546693907398511, 0.78261267704885784, 0.77168655608717396, 0.75715843764408775, 0.77545933944388556, 0.7572798571261049, 0.7756154980479335, 0.7477675770679304], [0.75660548028061791, 0.76758434809676879, 0.76587767123507156, 0.76009843635278351, 0.76367440463408975, 0.76481270707151872, 0.74660825896239913, 0.77124563296908055, 0.7691954705012698, 0.76611652797066865], [0.76441583784042355, 0.750932108450866, 0.74680254058915163, 0.76614090320645434, 0.76026410934947553, 0.75071729221909289, 0.76177200748695284, 0.76249402819933487, 0.77893372874086741, 0.76542678088324789], [0.76213286556481408, 0.75909129240504747, 0.74917061454460265, 0.76046059571736657, 0.76073900084542478, 0.76016347222171043, 0.75118220932124458, 0.7469941554069095, 0.75763291623944218, 0.75301962564125402], [0.75265056720158108, 0.74592561555851999, 0.75468733106531394, 0.74350405277597387, 0.7467011937434036, 0.74396887697459713, 0.75164164334504535, 0.74726927401446719, 0.73719475752002894, 0.7504683348430965], [0.74181541796304884, 0.74405963054750113, 0.73916294461731724, 0.74779927999884821, 0.74066837963424803, 0.74849513661424705, 0.73933806982543016, 0.7439066615316221, 0.73799781983427637, 0.73935311909117829], [0.73551762941742471, 0.72632605611831114, 0.73226013065303519, 0.73283704081901935, 0.72709722990795855, 0.72698186105774187, 0.7265171854800988, 0.73764160037607884, 0.73417085597847365, 0.73749633088253796], [0.72807375058215651, 0.73240494428804737, 0.72105277431038084, 0.72169650680681274, 0.71880505465620292, 0.71634423473219633, 0.72268765963910775, 0.72181570615749258, 0.71208716436466712, 0.72840023745625249], [0.7121358264919494, 0.69141912079910095, 0.70827945201841525, 0.69561110810939719, 0.69693750711151181, 0.71105115244602457, 0.70359899992735819, 0.70299447946037219, 0.70800257960340751, 0.69609156763467273], [0.7011077562079765, 0.67117224960623878, 0.68112015246844215, 0.68490883826420601, 0.68118868817967815, 0.67473072239543097, 0.67994682139467499, 0.68354169493301153, 0.67249602304764866, 0.68679050108907247], [0.66509722088394363, 0.64905893855434382, 0.6545135485967537, 0.67042849395764947, 0.65313568766361918, 0.65924106679421379, 0.65419563038120332, 0.67678802544474737, 0.67205575810274776, 0.66337126615297015]]} 
bnmf_avr = {'R^2': [0.5876799881173943, 0.5920752496075952, 0.5896982857900135, 0.581674197440656, 0.578114691457405, 0.5706263917783972, 0.55727599412905, 0.5496170476609543, 0.5332416846014273, 0.518406669468342, 0.4884524578334183, 0.45227787790704477, 0.4144303706608807], 'MSE': [0.081773668966222082, 0.081431992923814561, 0.081976295597824655, 0.083205582249176291, 0.084161121787232007, 0.0856271490921445, 0.088234069634192891, 0.089949643555562037, 0.09316917924842924, 0.095987703254255846, 0.10201879143734247, 0.1092405775396674, 0.11674952272344896], 'Rp': [0.76751051287282324, 0.7696942834257221, 0.7684045600259457, 0.76318189380742674, 0.76078993369658665, 0.75605867479078159, 0.74740116470420281, 0.74225964596577165, 0.731684592069068, 0.72233680329933159, 0.70261217936022091, 0.68170034475863805, 0.66178856365321936]}

np_nmtf_all = {'R^2': [[0.5741460515433148, 0.5686191260030459, 0.5649491534666086, 0.525572361142702, 0.5115320657279884, 0.5675076220285762, 0.5851169312502029, 0.5262619893231215, 0.5686970719143005, 0.5730023178421657], [0.5472946594510142, 0.5143617535648558, 0.5425717118879698, 0.5365181880099156, 0.5525264850314415, 0.5159555166095834, 0.5371438059237321, 0.5829319098108354, 0.5611493878084688, 0.5655455055046974], [0.5585804282455544, 0.5728510453377595, 0.5536929241995628, 0.5696514238315323, 0.5345815388641648, 0.5345520702065443, 0.5594741896318245, 0.5323285072053758, 0.5471383786270179, 0.5213829125503158], [0.5046172227486141, 0.5435022786199599, 0.503000264402141, 0.5213852087364605, 0.4236867910334373, 0.5244136764091856, 0.4709822944777762, 0.5481985816643684, 0.5236918224779579, 0.5332495938638928], [0.5111063614486924, 0.5074915830961142, 0.46660980720853207, 0.49147717827915993, 0.5103653069973269, 0.5012399723279444, 0.4920158005896934, 0.5111046276073463, 0.535223203510347, 0.42259572416833724], [0.47226747558795523, 0.494807265990191, 0.4504844109400884, 0.4111989883537077, 0.3986190749950832, 0.024706310907554818, 0.4657763823469212, 0.489210873965615, 0.496268815494157, 0.48454572078142677], [0.44622231282366065, 0.36726769169544493, 0.13060727414683493, 0.45200773065523936, -0.4283296420026952, 0.4055566181927702, 0.43293199813620553, 0.4474159212647212, 0.041152808842784716, 0.4607608262878281], [-269256.2240936693, 0.2873474829984338, -0.4629419112684814, 0.3420823203130765, -0.7523558861617183, -176.15396908525253, 0.38710282752064495, 0.40083239161268325, -659.141635090169, 0.20809308806829174], [0.04321166051766279, 0.13976418325208062, -24.243565490380863, -0.04320096667933271, -0.06833177397114198, 0.23393836500783116, -0.9550636788238067, -1.1202488886879731, 0.25785975611855794, -812.056100767108], [-0.7547810975798295, -296.6542550411777, 0.0014184980748567222, -2693.5875542822755, -130.92101419435372, -0.27363027230285986, -0.22159438564486367, -2.310272333845568, -938.4156437540988, -161.070345526955], [-180165.90872534286, -0.8862360036319812, -10952.937186505216, -2.560362797652484, -6.1732696861981236, -5111.803099979735, -57.87669372384709, -172.25017205338816, -284270.1734941804, -705980.3921641462], [-120974.49254056875, -488883.91858519014, -2817.08851777897, -39859.11803866698, 0.280079971462014, -5881.178417321092, -21023.72499231114, -25783.38953826947, -133225.83137252176, -587.792618124669], [0.12428869292374456, -109068050.03450751, -3135856.3820224903, -50052.06510868305, -498402.54153391893, -16361.297987445552, -3399135.0626703002, 0.0453593107576542, -72495.14560817298, -1234697.5169788094]], 'MSE': [[0.083419549602003457, 0.083489396510671846, 0.086541593089467433, 0.094059104539909552, 0.096590912405265364, 0.088746088192461645, 0.082763568885286062, 0.094807327048425566, 0.086015170739359603, 0.083163023977356698], [0.089785984117727757, 0.097653094091309914, 0.091457406074417366, 0.093175629115309591, 0.089626594757158645, 0.096101440748263961, 0.092251280354844686, 0.082882650584226267, 0.087839666163073607, 0.086296186606419648], [0.087685461128121756, 0.086796658678508221, 0.088735448975027553, 0.085427515466715065, 0.092883510013641937, 0.094332492069856388, 0.088014505947701771, 0.093352492671605142, 0.090396478236549435, 0.094576482780171264], [0.099367662103845747, 0.090860112698343681, 0.098227641816234459, 0.095833448523728756, 0.11411187678531387, 0.09445644232760271, 0.10497810926880495, 0.090223133451140039, 0.094532380814080622, 0.092539400152726617], [0.097925705112070771, 0.098576865334428429, 0.10649585970485761, 0.10178705825063157, 0.097546268706115671, 0.098908070131836237, 0.10101159163655619, 0.097730804870452395, 0.092316535323317822, 0.11529727930087977], [0.10509603994758659, 0.10068881940738354, 0.10976745745655879, 0.11804033348011889, 0.11982882030568751, 0.19566352345655924, 0.10576720615446442, 0.10204633580858267, 0.10055372617927925, 0.10223165445793174], [0.11060226654448652, 0.12572979549903648, 0.1729305654812652, 0.10897068379235207, 0.28428388140131383, 0.11905292835497555, 0.11314594813597979, 0.10990570827359339, 0.19201677241689971, 0.10717792416435377], [53707.759212561024, 0.14263587403581302, 0.29144278922051148, 0.13180559038907105, 0.34899762995661388, 35.339562387175782, 0.12203030713732382, 0.12003673046263878, 132.11910729903749, 0.15823314901157945], [0.19041242339329337, 0.17282830399907759, 5.0365074494759554, 0.20887382658991943, 0.21320920019173059, 0.15272705216445581, 0.38809140589735519, 0.42377891559265363, 0.14864048087241175, 161.65601647690414], [0.35135407314754619, 59.450435748095501, 0.19870544653544592, 537.48631234963318, 26.253726072405566, 0.25210469497849319, 0.24348787861303725, 0.66092010165332038, 187.64222746358374, 32.266556433731033], [35898.114356706632, 0.37587981906498941, 2183.5274103017518, 0.71054759508753418, 1.4292167631950561, 1017.2677548665315, 11.770472755245638, 34.524062130706888, 56702.570416450711, 141197.53578080321], [24164.78927074093, 97690.475516806968, 560.35124529699146, 7939.2407927417908, 0.14330698460058952, 1172.5399970352532, 4196.5153631491867, 5148.1911243589248, 26586.206792288394, 117.55915421236485], [0.17462053580470061, 21720807.631996911, 624492.71137374139, 9970.0096482254157, 99433.593236498768, 3265.4806964907834, 678519.93356985296, 0.19045222197145675, 14462.622989450861, 245972.39169956776]], 'Rp': [[0.76117721707319708, 0.76153765054803346, 0.76134166663594371, 0.73618873773536153, 0.73036406028392764, 0.76095654766549992, 0.77102500554847031, 0.73490767335123675, 0.7624543659854498, 0.76374776873289185], [0.74799003645625695, 0.72757394963710575, 0.74403896856989804, 0.73992804876075546, 0.75119602475709168, 0.73099810062628867, 0.74263081113763862, 0.77331170984925945, 0.75535525615844046, 0.75916846107387614], [0.75615842994897486, 0.76253478109683948, 0.75496246308036685, 0.76289321807860844, 0.74189494390976307, 0.73940627405954618, 0.75426504264411209, 0.74064627204030908, 0.75018058585599701, 0.73494935314241605], [0.72697513546204673, 0.7463495122791054, 0.7255170848047503, 0.73615634342216074, 0.69214997646883913, 0.73972432318182468, 0.70862710450688893, 0.74931587485234374, 0.73783199989243908, 0.74195115682126833], [0.73247069753645866, 0.72713950844960018, 0.70983026618053013, 0.72249967884246558, 0.7289024306594194, 0.72385832558307961, 0.72259462445110201, 0.73174198499294996, 0.74499962194212777, 0.69170137531520937], [0.71163882023223313, 0.72609941436298631, 0.70212736024925682, 0.68563434391901212, 0.68579459078061467, 0.56719802736626268, 0.71048353337812842, 0.72139797994580235, 0.72339136394418002, 0.71745616915887067], [0.69918762633784781, 0.66267791160756284, 0.58754283836982257, 0.70046040326899761, 0.49334584103653978, 0.67645659741182407, 0.69371728758369322, 0.7018772908787152, 0.56835647285936131, 0.70633176811618326], [-0.0081245389011495705, 0.6347684099806995, 0.48203378541374997, 0.65477820709665224, 0.44162054636025316, 0.073816296103459522, 0.67393998682167777, 0.68073183920167091, 0.053426062950854676, 0.61484015772514466], [0.56809582829268235, 0.590843001708797, 0.10895648552624776, 0.55600133819611097, 0.53661311453420768, 0.61104091807133309, 0.42238357337390131, 0.41375846513416442, 0.61749034398660285, 0.047123260969704477], [0.44212287429190444, 0.077629349925023822, 0.52943256023608831, -0.000133651474130291, 0.065820894986794165, 0.49370422746173692, 0.49880733011978501, 0.31608329490191178, 0.019066474039969156, 0.041194868400885473], [0.020192242817150534, 0.40498832399038714, 0.030575189832604828, 0.30779265596972938, 0.22529381395615117, 0.028107935991871072, 0.1083230835370312, 0.064924960886788508, 0.029762741491927563, 0.022136691774030486], [0.027083891376184471, 0.050811616504727319, 0.016240987226211288, 0.020663309504861831, 0.61577192068514952, 0.054646396284317195, 0.0029590128106269774, 0.0012385740471890885, 0.012196748394282189, 0.053384598758423912], [0.57412993483405983, 0.0098065044937355825, 0.025328846890367691, 0.010596237790628982, 0.0091499981425980075, -0.0083629642025421988, 0.032082793328605211, 0.54120639488405708, 0.026734541804985842, 0.044180878544260033]]} 
np_nmtf_avr = {'R^2': [0.5565404690242026, 0.5455998923602514, 0.5484233418699652, 0.5096727734433795, 0.49492295652334944, 0.41878853193627014, 0.27555935400427944, -27009.110953753163, -83.7811737600755, -422.4207672390159, -118672.0961404419, -83903.62545407817, -11747504.987676933], 'MSE': [0.087959573499020727, 0.090706993261275154, 0.090220104596789849, 0.097513020794182156, 0.10075960383711464, 0.11596839166541528, 0.14438164740642562, 5387.6533064317455, 16.859108553508101, 84.480583026237682, 23704.782589819217, 16757.60125636154, 2339692.4740283499], 'Rp': [0.75437006935600115, 0.74721913670266116, 0.74978913638569344, 0.73045985116916667, 0.7235738513952944, 0.69512216033373464, 0.64899540374705478, 0.43018307527530136, 0.44723063297937521, 0.24837282228899685, 0.12420976402476717, 0.085499705559197378, 0.1264853166510756]}

bnmtf_all = {'R^2': [[0.6056942861099961, 0.6141388200272883, 0.6067842422679758, 0.5722024151393201, 0.5659573322572442, 0.6275376252079007, 0.5842792492830786, 0.5701832256860475, 0.5961138581032752, 0.6027508911953992], [0.5922546710328855, 0.5598584729374989, 0.6009560761917756, 0.5939771667971747, 0.598078590163217, 0.5696803972472531, 0.6009082083010908, 0.627786271882117, 0.6005846406510957, 0.6268699213891397], [0.5963442272157937, 0.6094347196161924, 0.589894904219247, 0.6102150617837405, 0.6010703534424602, 0.5804251879216458, 0.5918035688436817, 0.5788253308687701, 0.5954947597060095, 0.5519789000141476], [0.5746611633110035, 0.5933962525605189, 0.5815482278962333, 0.5714920735524749, 0.5895967783237825, 0.5757961355628876, 0.5604598778336048, 0.5912125383780107, 0.5952213203161516, 0.587119884231147], [0.5904979522243624, 0.5672910537550448, 0.5634004539411592, 0.57967983688392, 0.5790000798059372, 0.5594677648505719, 0.5815176395079135, 0.5829772380345597, 0.5981504925869485, 0.5918263095314871], [0.5860161707859528, 0.5822784116199573, 0.5616262944777345, 0.5810091770487876, 0.5736122101892924, 0.579503298948669, 0.5669099709160959, 0.5645236021487847, 0.5734887437521501, 0.5685896122824796], [0.5585625414333979, 0.5675744587018816, 0.5677114617938179, 0.5568942090655038, 0.562638682056781, 0.5540396750965665, 0.5694445806654373, 0.5603209280827789, 0.5508979450000999, 0.5560198624899944], [0.547982468336409, 0.5536333851954183, 0.5546665310922354, 0.5564331279553969, 0.5543746425222422, 0.5587359631093394, 0.5464693902344706, 0.5518062761190321, 0.5609034796761156, 0.5580589150962035], [0.536124135292638, 0.5293760001105634, 0.542162364828791, 0.5426383291192327, 0.5435442203757485, 0.5484875907082298, 0.5367241879176892, 0.5537711982398842, 0.5468762826069493, 0.5637689553933687], [0.5387001646547449, 0.5431708948599574, 0.5354643289737095, 0.540981089531221, 0.5334855008306545, 0.5261333328452573, 0.5266331845773891, 0.5351332665034829, 0.5319691108239605, 0.5454405953836339], [0.5390221515515623, 0.4988266690773743, 0.5216191920645684, 0.4922771100375053, 0.5132051291210133, 0.5192986201507326, 0.5259505635901128, 0.5006601701945237, 0.5225566403289348, 0.5204431213903798], [0.5144850084892016, 0.5074045390243065, 0.49342703069564786, 0.5034640943106554, 0.5022451589770431, 0.4951689949124579, 0.4972613670516324, 0.5030553425570947, 0.504562818418993, 0.5063237833720282], [0.4911770176574246, 0.483277880044643, 0.4887142445484237, 0.489345253544093, 0.49221957394956406, 0.4846135763051671, 0.4830384075433042, 0.4838998229410586, 0.49441971015343966, 0.4955203013616106]], 'MSE': [[0.077239638560134619, 0.074679521032833041, 0.078219634263829857, 0.084814320374017427, 0.085828719468700715, 0.076428118610352411, 0.082930675124157124, 0.086017542554921431, 0.080547413876135635, 0.07736912526913696], [0.08086897226863525, 0.088504524244606197, 0.079784139131158005, 0.081624417485584119, 0.08050274735522249, 0.085434986299398358, 0.079542478278397666, 0.073968882050540988, 0.079946366373757308, 0.074115248662985078], [0.080183899488038501, 0.079362856828140371, 0.081537716460770848, 0.077375320105920006, 0.079614344756194499, 0.085035371519766784, 0.081555283191719813, 0.084071203439387426, 0.08074397878969268, 0.088530604023659823], [0.085317713381681343, 0.080929346600535884, 0.082703325260590821, 0.085800508176536547, 0.081261163436095282, 0.084251345904607533, 0.08722220540285737, 0.081633399556251013, 0.080335996942911062, 0.08185890734307448], [0.082023519250716867, 0.086607842747417688, 0.087170789100850105, 0.084132218062963823, 0.083872674725438842, 0.087361036955719659, 0.083214338859751324, 0.083363378910137495, 0.079817569478386599, 0.081504966213549995], [0.082443395167291225, 0.083255143519437219, 0.087566518637459553, 0.083997505928167682, 0.084960369910882683, 0.084360092810735074, 0.085744472681301157, 0.087000228600883675, 0.085139251633187807, 0.085562967395597336], [0.088165313600937906, 0.085926977589712517, 0.085986343271625645, 0.08811354417137765, 0.08704907423566427, 0.089315289285376243, 0.085907864639829537, 0.087449569525668777, 0.089936256665467396, 0.08824445965404952], [0.090162293071843008, 0.089339321372127661, 0.088717964337481969, 0.088863083105918964, 0.088750347367483162, 0.088025563533437601, 0.090299779622053225, 0.089790750493589158, 0.087879687024105438, 0.088305492082827078], [0.092316893828761848, 0.09455215202459788, 0.09134615556066833, 0.09157476400401976, 0.091095831901381194, 0.09001646360675436, 0.09196291822956329, 0.089188754549061056, 0.090754446754887891, 0.086733711078648287], [0.092364555507456592, 0.091242402562768374, 0.092436889492713212, 0.091559979594845756, 0.092841492652212199, 0.093798030858294412, 0.094351351845986864, 0.092814046027700187, 0.093486157219819635, 0.090498151490013196], [0.091849472450780109, 0.09987135256917147, 0.095359101381023367, 0.10132711157177869, 0.096989994818717673, 0.095642645311814628, 0.094770708458483316, 0.099504889976262084, 0.095233946477410264, 0.095912229809406252], [0.096981357225800119, 0.098431927414326228, 0.10072742300061141, 0.098898806914864537, 0.099082873805034041, 0.10063185833765206, 0.10034615899080687, 0.099221510400624227, 0.098867437035043776, 0.098568081010241518], [0.10146145320773989, 0.10290476138788758, 0.10182039194103777, 0.10171670282374545, 0.10130432095639304, 0.10285746043130467, 0.10319349943771447, 0.1029627446099619, 0.10086077075694574, 0.10050071036093378]], 'Rp': [[0.77939286778673988, 0.78379075372310014, 0.77903660050560442, 0.75691093708781843, 0.75690993883190572, 0.79281350511242199, 0.76548119282328986, 0.75540866070955459, 0.77566114237892325, 0.77718635034500816], [0.77077047902704154, 0.74838529774977014, 0.77592499238852597, 0.77108749825264966, 0.77344285646834765, 0.75632672530448497, 0.77531058389168894, 0.7942725305980507, 0.77516649898011347, 0.79213834022181684], [0.77343971286186985, 0.7811615284026463, 0.77002662705139213, 0.78186660257747442, 0.77592889108537455, 0.76274494268121895, 0.76959295957424056, 0.76137871102493382, 0.77323148286234344, 0.74483235174871509], [0.75885686151109177, 0.77136712590698997, 0.7637379965318023, 0.75712573362947666, 0.76860566929133478, 0.75918656580312649, 0.74968717936109908, 0.77072287126227668, 0.77181921702477563, 0.766773258630573], [0.76937810303238807, 0.75465386095098919, 0.75083393097032181, 0.76177797822911753, 0.76189133903150008, 0.74842864001507103, 0.76323916270541503, 0.76429477418517133, 0.77410203202827355, 0.76983965493359408], [0.76609473555281116, 0.76356112846241442, 0.74975864472915243, 0.76239433570706805, 0.75868577573000173, 0.76251451363034839, 0.7538088687563389, 0.75184881181604735, 0.7600995562692493, 0.75432912516623662], [0.74772064161289276, 0.75406561814751527, 0.75457074519872191, 0.74722768393668193, 0.75155659709284284, 0.74455252421997353, 0.75489649747184262, 0.74961295847986986, 0.74332859583971711, 0.74709104962198603], [0.74055353235155419, 0.74551803447654252, 0.74512979469545415, 0.74636136686091947, 0.74570582760017257, 0.74940858658178311, 0.74136979297401795, 0.74335121765377787, 0.74994994361601441, 0.74819281963882356], [0.73628102687328378, 0.72848571847169041, 0.73660169233998429, 0.73742334699607537, 0.73809454564390775, 0.74112553158811312, 0.73446549169338082, 0.74545629305295769, 0.74011017139833268, 0.75134303184403173], [0.73410683674958854, 0.73853467283533347, 0.73203184911821528, 0.73677663684107375, 0.73267123006938562, 0.72707721050496976, 0.72644560784832646, 0.73252613291918833, 0.73124916095655701, 0.73862344837162053], [0.73486322486452571, 0.70726438223338095, 0.72272980935754105, 0.70526165872053703, 0.71683703235539997, 0.72233785968541298, 0.7257846637957609, 0.71059687926256743, 0.72362060496899205, 0.72206167609673011], [0.71815121292888973, 0.71318854691019617, 0.70511992104336951, 0.71054317570035785, 0.71194125803719077, 0.70521787589059204, 0.70659400821092722, 0.71122173648366205, 0.71141006208491686, 0.7120169592243234], [0.70522181987704136, 0.69734574176085518, 0.70136859977962518, 0.70265674174297188, 0.70177949605188183, 0.6993303818327512, 0.6974907506804654, 0.69699722251559204, 0.70749368647236088, 0.70713972983920825]]} 
bnmtf_avr = {'R^2': [0.5945641945277526, 0.5970954416593247, 0.5905487013631688, 0.5820504251965815, 0.5793808821121904, 0.5737557492169904, 0.5604104344386258, 0.5543064179336862, 0.5443473264593095, 0.5357111468984013, 0.5153859367506708, 0.502739813780906, 0.4886225788048728], 'MSE': [0.08040747091342193, 0.080429276215028558, 0.081801057860329068, 0.083131391200514132, 0.083906833430493225, 0.085002994628494338, 0.087609469263970952, 0.089013428201086736, 0.09095420915383437, 0.092539305725181042, 0.096646145282484788, 0.099175743413500467, 0.10195828159136644], 'Rp': [0.77225919493043671, 0.77328258028824903, 0.76942038098702092, 0.76378824789525468, 0.76184394760818408, 0.75830954958196695, 0.74946229116220442, 0.74555409164490605, 0.73893868499017579, 0.73300427862142581, 0.71913577913408466, 0.7105404756514424, 0.70168241705527534]}

hmf_mf_all = {'R^2': [[0.6285846054495241, 0.6112818463550085, 0.6222427310329056, 0.60729815678096, 0.5725625945688264, 0.6543183337071596, 0.6077203908536533, 0.5965433374628939, 0.6051239456433379, 0.6218970862293878], [0.6028639978371785, 0.5764992791289012, 0.6126866624861947, 0.6073562373492517, 0.616103972784738, 0.6051178414139089, 0.6300842812791435, 0.6352995491894695, 0.6143622277442228, 0.6420690094615809], [0.6180325532998423, 0.6176768741823591, 0.6065646194573717, 0.6137008146216845, 0.6009445426167763, 0.5970288921165874, 0.6111593119775178, 0.5985755320595374, 0.6066311959193693, 0.5829181120635247], [0.5840812993676432, 0.6108135437711109, 0.5845141327051526, 0.6011780867765097, 0.6110172544078218, 0.6004437610359549, 0.5828320095756427, 0.6139890489069917, 0.6122909477650199, 0.6009221072963415], [0.5994065668143101, 0.5830976638789435, 0.5828501384586364, 0.5968508391316719, 0.5883398007518144, 0.5867389464041785, 0.5900100937821617, 0.5910092946450529, 0.618180912336137, 0.5997908970490191], [0.5905380525015538, 0.5873001889428373, 0.5844177736345011, 0.5951985771734194, 0.5935734143644638, 0.5827382272813539, 0.5726197916179825, 0.5786056867427315, 0.5914082301951218, 0.5837826765574516], [0.5744479416607986, 0.5764950134485586, 0.5781331348097767, 0.5579845168453363, 0.5669054957007363, 0.5655265377781176, 0.5823192496881391, 0.5743879598213257, 0.5729044835295647, 0.5771778642135977], [0.5612553601817363, 0.5692898366583445, 0.5789735257577181, 0.5582906558027227, 0.5590741937797035, 0.5682304122268985, 0.5543297478559837, 0.563030911322931, 0.5696916843911581, 0.567107540930207], [0.5423549145908022, 0.5335291060365621, 0.5431699963440146, 0.559785380334464, 0.5458934026630606, 0.5457148486189938, 0.5331114108925985, 0.5540637462554497, 0.5532762263110644, 0.554383784749012], [0.5427954191358515, 0.5489626530710738, 0.5341981093763186, 0.5320022335680819, 0.5300083403887528, 0.5352019274280833, 0.5362711649982042, 0.5393967663518726, 0.5406922950846337, 0.5308116950516226], [0.5353263655038982, 0.5096654766218539, 0.5226810403567106, 0.4875485673901714, 0.5173703155324931, 0.5174475407228739, 0.5265290466850104, 0.487670341681796, 0.5183149809311729, 0.5085434116820367], [0.5055303309528302, 0.48907552292676715, 0.4786363167074492, 0.48900553870538666, 0.49092855831115056, 0.497925806526461, 0.47269064541000794, 0.5012747742609978, 0.494663992602818, 0.4941013560152063], [0.4753032030546416, 0.4686851254220574, 0.492651344183476, 0.48068995855697705, 0.46585008431992014, 0.4973158238573725, 0.4783777584281319, 0.48043628743323463, 0.4965112699325369, 0.470472081631803]], 'MSE': [[0.072755706600669226, 0.075232459334282187, 0.075144586243276287, 0.077856306629439653, 0.084522577819294994, 0.070932800682486238, 0.078254483972341304, 0.080742196937858182, 0.078750523181294149, 0.073640169485020571], [0.078764802596603414, 0.085158358194685563, 0.077438746373207412, 0.078934768650573181, 0.076892357891892318, 0.078399291114943703, 0.073727432217874922, 0.072475791707606194, 0.077188665650157154, 0.071096236644084293], [0.075875638152415673, 0.077688051192198321, 0.078223418422165972, 0.076683371251045615, 0.0796394528085453, 0.0816702930780287, 0.077688117797366604, 0.080128841032591144, 0.07852101582201701, 0.082416902836742634], [0.083428150523153818, 0.07746265450509654, 0.082117140169604558, 0.079856452388645541, 0.077019839986355518, 0.079356068436510663, 0.082782686524612376, 0.077085011557431221, 0.076948206015730866, 0.07912243528769769], [0.080239118112102423, 0.08344410782614943, 0.083287495216429586, 0.080695232088373453, 0.082011991767212064, 0.081952945312385922, 0.081525632155609137, 0.081757760608890673, 0.075839016834874831, 0.079914580915134065], [0.081542878637728203, 0.082254264456996587, 0.083013849398371475, 0.081152875077566258, 0.080982978130170344, 0.083711101145166542, 0.084614025124649606, 0.084186885363694189, 0.081562202626727115, 0.082549679583784508], [0.084992630210468698, 0.084154380380249652, 0.083913372387101615, 0.087896731652371607, 0.086199840061528574, 0.087014742788092472, 0.083339007591428454, 0.084651720029044461, 0.085529272383231422, 0.084039144434476756], [0.087514797608415018, 0.08620571616420715, 0.083875599600843911, 0.088490950600379009, 0.087814388945072708, 0.086131563197716199, 0.088734750612566735, 0.087542016597345382, 0.086120837559090252, 0.086497460686246253], [0.091076893572870243, 0.093717759594586794, 0.091145116462816464, 0.088141513540823432, 0.09062700069296302, 0.090569255583741515, 0.092680075286925553, 0.089130282319005147, 0.089472626078029402, 0.088599719216206407], [0.091544576112592438, 0.090085615641140648, 0.092688851631032826, 0.093350981773667727, 0.093533485647482831, 0.09200297673552045, 0.092430312068500123, 0.09196280707542849, 0.091743757318209676, 0.093410616670435515], [0.092585854903671175, 0.097711448394479386, 0.095147435492129021, 0.10227079478533976, 0.096160114652275169, 0.096010944926885833, 0.09465505964946902, 0.10209341061855295, 0.096080015347946371, 0.098292192944375537], [0.09877004922539076, 0.10209448731391499, 0.1036684218194316, 0.10177862664731295, 0.10133555167628529, 0.10008232181353179, 0.10525045195494541, 0.099577024184833732, 0.10084280661666958, 0.10100842787985158], [0.1046267589298471, 0.10581089579637566, 0.10103633522974161, 0.10344074058931306, 0.10656514454046792, 0.10032242872514702, 0.10412383681454039, 0.10365372503932704, 0.10044351491125603, 0.10549073053997544]], 'Rp': [[0.79291488570093926, 0.78335655222240053, 0.79046467654108188, 0.78020102493973242, 0.76209717586077075, 0.80916521044262102, 0.7812221648401747, 0.77553598362287346, 0.77939456870583312, 0.78930249892332593], [0.77719762999472541, 0.76187569860517235, 0.78325518995318144, 0.77983538708381772, 0.7855510634282804, 0.77917407051076781, 0.79457966722037843, 0.79821432686857774, 0.78432904987076391, 0.8015509112545175], [0.78705007575113228, 0.78631587108203604, 0.77999809652302399, 0.78434383489478932, 0.77613975923733647, 0.7736361111740907, 0.78232507144739205, 0.77442805631721001, 0.77951353888888242, 0.76521290955239751], [0.76514905730445293, 0.78195288652830164, 0.76674079238425363, 0.77591775887947068, 0.78266626116619697, 0.77609385189254654, 0.76484792203055996, 0.78409170909760828, 0.78357879052134605, 0.77624950792384184], [0.77520730822840522, 0.76530122816507973, 0.76535135480531957, 0.77334408830049206, 0.7687605947873104, 0.76715335809383189, 0.76940083315163132, 0.77038655084434349, 0.78651210252264891, 0.77553744631942623], [0.7692102657850618, 0.76779139081712988, 0.76579368071547815, 0.77255147915186606, 0.77142280277642483, 0.76421396821148324, 0.75877164127914665, 0.762648354670319, 0.77020309786323848, 0.76569517460174796], [0.75888734545770276, 0.76036438549534746, 0.76143549616372741, 0.74906580864325878, 0.7559075925506461, 0.75392986603014978, 0.76532344178543843, 0.759502014692362, 0.75848108160574168, 0.76098120645082268], [0.75110920417901006, 0.75572164214580206, 0.76252987802807226, 0.74868505573760813, 0.74982719876191573, 0.75539813343196804, 0.74698680395554884, 0.75170413345689335, 0.75622093254238176, 0.75459333949081542], [0.73975648997696997, 0.73337353084418222, 0.73930910666470029, 0.74930579152533938, 0.74200602253789183, 0.74037208496959184, 0.73411322812521462, 0.74530017694045858, 0.74594666818035849, 0.74690259734263764], [0.73835628015585353, 0.74280575952095729, 0.73286840095233097, 0.73414122936384163, 0.73190199483987806, 0.73476303173027013, 0.73446139996963478, 0.73579131252636654, 0.73732510506829474, 0.7312572833227986], [0.73293289277509455, 0.7188894947194987, 0.72666597215141115, 0.70662646459942291, 0.72163100172937, 0.72269477688479977, 0.72737544269760956, 0.70652090611803431, 0.72181654692895891, 0.71617715384217262], [0.71480101040678057, 0.70369907361041051, 0.6990921115246902, 0.7059561080286364, 0.70470689754936022, 0.70967121155712976, 0.69710981711398878, 0.71083056490102769, 0.70720313551788994, 0.70754051962179021], [0.69266574127541769, 0.68926791342408678, 0.70444326781612765, 0.69821720183379798, 0.69233077328691539, 0.70731374689607229, 0.69740294983381124, 0.69988506283964924, 0.70629991856314411, 0.69233176072952962]]} 
hmf_mf_avr = {'R^2': [0.6127573028083656, 0.6142443058674589, 0.6053232448314569, 0.6002082191608189, 0.5936275153251925, 0.5860182619011416, 0.5726282197495951, 0.5649273868907404, 0.5465282816796022, 0.5370340604454495, 0.5131097087108017, 0.4913832842419075, 0.4806292936820151], 'MSE': [0.076783181088596289, 0.077007645104162817, 0.078853510239311683, 0.079517864539483868, 0.081066788083716174, 0.082557073954485485, 0.085173084191799364, 0.086892808157188278, 0.090516024234796807, 0.092275398067401065, 0.097100727171512427, 0.10144081691321678, 0.10355141111159913], 'Rp': [0.78436547417997526, 0.78455629947901828, 0.77889633248682921, 0.77572885377285794, 0.77169548652184905, 0.76683018558718963, 0.75838782388751969, 0.75327763217300159, 0.7416385697107345, 0.73536717974502264, 0.72013306524463716, 0.70606104498317035, 0.6980158336498552]}

hmf_mtf_all = {'R^2': [[0.622009207731547, 0.6210991446769469, 0.6249587426675756, 0.6095678627813437, 0.5741127708887146, 0.6600323141360378, 0.6312891690802458, 0.585387298236994, 0.6108606392620128, 0.6113525162994842], [0.5949191132502005, 0.5841299710515468, 0.6254229296910593, 0.6028109241455436, 0.6075037069383902, 0.6074710313798307, 0.6207179641086717, 0.6310929914510927, 0.6202340952447903, 0.6429267520237594], [0.6119001626923851, 0.6146339634924372, 0.608950054008828, 0.6265178716731654, 0.6188615417786957, 0.5965927549249095, 0.61265211636584, 0.5998113390503617, 0.6156976607027227, 0.5820454595182576], [0.583130524973754, 0.6093185665860616, 0.5934147645054679, 0.600334240852475, 0.61554479800929, 0.6040297248984594, 0.5748742707579988, 0.6197764205347593, 0.611944117987016, 0.596346265987099], [0.6102363566609345, 0.5870486935998158, 0.5835547179107443, 0.5990868447314681, 0.5912323629200694, 0.58710191798712, 0.5982828587969466, 0.6035233651794568, 0.6135854378441972, 0.611059115755767], [0.5930708990952416, 0.5987857317653871, 0.5832691067715057, 0.5993384451888422, 0.5946701239231404, 0.5922635074926579, 0.5859673019668503, 0.5812096676017506, 0.5926972280148519, 0.5877562986704514], [0.5880887318308359, 0.580555953447067, 0.5862019897978651, 0.5686360971816491, 0.5669455395866735, 0.5747374103323457, 0.5804978926885334, 0.5781700940671928, 0.5741650701233549, 0.5833152385921637], [0.5634002609820491, 0.5643736942882835, 0.5768582129401876, 0.5636161603107935, 0.574243402243068, 0.575257867658128, 0.5688018635043874, 0.5665398442433035, 0.591483248913673, 0.5771721051654435], [0.5606453562813629, 0.5594184645781246, 0.5468926536427694, 0.5705800725071566, 0.552535094789119, 0.5625294224636472, 0.5511888990635709, 0.5741942217283469, 0.5535833052067552, 0.5696074759787378], [0.5612894442654688, 0.5550198026362123, 0.5519530204632301, 0.5413663099398532, 0.5444949883178203, 0.5438225349841943, 0.5517999544924429, 0.5487240720068072, 0.559912682397353, 0.5547568882688918], [0.5425757793509585, 0.5272809040511495, 0.5267323846783135, 0.49508453043534484, 0.5237816563884536, 0.5290258124752439, 0.52977200315017, 0.5091416898070962, 0.5382761502694862, 0.5284067308975737], [0.5136323531755138, 0.5175277212976205, 0.49799859555365933, 0.5107513883176702, 0.5164726814437842, 0.5230061322260642, 0.5088629637142031, 0.520243421984163, 0.5134850206695487, 0.5177272375752429], [0.4876961918187199, 0.49644972414774036, 0.4661211438108206, 0.47922553685303615, 0.46598277827893064, 0.49845184276922927, 0.4981409372656206, 0.5120618866951203, 0.5091494402382551, 0.5000296117633491]], 'MSE': [[0.074043746122377421, 0.073332420733429299, 0.074604309226033824, 0.077406319115054634, 0.084216041945348263, 0.069760309704842399, 0.073552831031485827, 0.082974811242848737, 0.077606448682936757, 0.07569385351787053], [0.080340527946957202, 0.083623963649416919, 0.074892279545728885, 0.07984853140528228, 0.078614945969241665, 0.077932092430030603, 0.075594221000749473, 0.073311747906111155, 0.076013361647667699, 0.070925862270832571], [0.077093802304257511, 0.078306370580925794, 0.077749142710663105, 0.074139086454633213, 0.076063759298216654, 0.081758685152720237, 0.077389864124999652, 0.079882160050679982, 0.076711243371028415, 0.082589342163679982], [0.083618864114839764, 0.077760210854566122, 0.080358008303331355, 0.08002541637889217, 0.076123371729941089, 0.078643858324558488, 0.084361817745384246, 0.075929294064053354, 0.077017040955375399, 0.080029655944358236], [0.078069904354098218, 0.082653298752925486, 0.083146819974370997, 0.0802476682377187, 0.081435728176118424, 0.081880965168048755, 0.079880610199515395, 0.079256182040970291, 0.076751795369575257, 0.077664519712203034], [0.081038471320616395, 0.079965106935120933, 0.083243299196567921, 0.080322931868505101, 0.080764452055980138, 0.081800138417837634, 0.081971444691909701, 0.083666657560017926, 0.081304895678502381, 0.081761578719788508], [0.082268247583287366, 0.083347433826636078, 0.082308399611987659, 0.085778617843749738, 0.08619187003067165, 0.085170023200246261, 0.083702419323244001, 0.083899475874581644, 0.085276829896749826, 0.082819294175479632], [0.087086962046692251, 0.087189671524090614, 0.084297005716060386, 0.087424052282431455, 0.084793302963715442, 0.084729691137398311, 0.085853293825358154, 0.086839039952282912, 0.081759527957748726, 0.084486431778206972], [0.087436874998733274, 0.08851637894843141, 0.090402384964598875, 0.085980157548077654, 0.089301504343778454, 0.087216992293958392, 0.089091589717193997, 0.085106758895984833, 0.089411122399853257, 0.08557286623773426], [0.087841578019470762, 0.088875822147716346, 0.089155842528700832, 0.09148314011841141, 0.090650484112361249, 0.090296597980457485, 0.089335117742287973, 0.090100542228339797, 0.087904608681447671, 0.088643372386791347], [0.091141414916650107, 0.094201132791274567, 0.094339851769110361, 0.10076682995851168, 0.094882706130534122, 0.093707276610221199, 0.094006736377468647, 0.097814753068478658, 0.092098431158146074, 0.094319493724834058], [0.097151674664011256, 0.096409082257054274, 0.099818408949072082, 0.097447341522989117, 0.096250749038083991, 0.095082867030783308, 0.098030491192567265, 0.095789685194141258, 0.097086958496057682, 0.096291251461156524], [0.10215554459160794, 0.10028160007521764, 0.10631971222864153, 0.10373243698164504, 0.10653867154008638, 0.10009570948128757, 0.10017880179837588, 0.097344371458991677, 0.09792226235534815, 0.0996023810528648]], 'Rp': [[0.78879951381502633, 0.7898256617594841, 0.79163432540926604, 0.7816616393875091, 0.76180791094871214, 0.81253490889551216, 0.79526681464162186, 0.7680324032544168, 0.78283636726517769, 0.78354985930000387], [0.77282681466999481, 0.76601435682054853, 0.7910931720197959, 0.77674593920883972, 0.78010977101172396, 0.78046697034053047, 0.78839637234147519, 0.79568227346311249, 0.78787112155904948, 0.80210787178115817], [0.78309088304675001, 0.7844376121619846, 0.78181599890186382, 0.79226231065827613, 0.78705574795709021, 0.77372430529015224, 0.78321609016326221, 0.77507383560213261, 0.78508516125374805, 0.76443852305532367], [0.76483937748323605, 0.78112908823805438, 0.77200141334801886, 0.77552989103884162, 0.78542751574044067, 0.77824964801706031, 0.76034101766999707, 0.7878493390943605, 0.78305671679211164, 0.77355779759627707], [0.78138364452602027, 0.76729786782420262, 0.76544017788736995, 0.77475751266358439, 0.77094424561802288, 0.76729983475833419, 0.77423809375067443, 0.77795572004708236, 0.78350307008038489, 0.7822833875443419], [0.77079552835813503, 0.77515527302285292, 0.76513272927299036, 0.77508577386380717, 0.77191618164691722, 0.77044453641808563, 0.76699063881346741, 0.76375053313712238, 0.77139289431679225, 0.7681494279288934], [0.7676459557767461, 0.76286496470917742, 0.76645300043236264, 0.75564919115706564, 0.75649179382253862, 0.7599329158434841, 0.76396497925621709, 0.76232787249135814, 0.75885821401548548, 0.7649019960167065], [0.75203035701566923, 0.75276075541813503, 0.76124604823824438, 0.75276481315004662, 0.75928482201200276, 0.75998925334362533, 0.75609829304777276, 0.75414741269055896, 0.7699326704061904, 0.76063102373282709], [0.75085409678986448, 0.74895587247029816, 0.74249540166945582, 0.7559721765181393, 0.74601501746920418, 0.7512061302338201, 0.74485936097235972, 0.75840192002679219, 0.74661050516668537, 0.7559786351857708], [0.74957096176289295, 0.7460692861465682, 0.74470106529913471, 0.73927933474780816, 0.74058966625586775, 0.73950622973225089, 0.74414646303105636, 0.74223980975620862, 0.75009283869477716, 0.74686867394182255], [0.73787771356104248, 0.72877487655358275, 0.72902075693729818, 0.71143795422411593, 0.72569216613799004, 0.730386952769702, 0.73023899800517145, 0.71782079853054181, 0.73519277553575446, 0.72950979352941081], [0.72022565500195213, 0.72191583182736718, 0.71065821753683933, 0.71858460291980131, 0.72130332972371736, 0.72497771132980027, 0.71615170566377462, 0.72332540282516944, 0.72002601745100669, 0.72242671849493911], [0.70311235350138912, 0.70587530984858449, 0.68898124190831855, 0.69894381195844357, 0.68968300390926407, 0.70925524490900926, 0.70906021517588735, 0.71762354169942755, 0.71564960076412776, 0.71240517260643488]]} 
hmf_mtf_avr = {'R^2': [0.6150669665760902, 0.6137229479284885, 0.6087662924207603, 0.600871369509238, 0.5984711671386519, 0.5909028310490679, 0.5781314017647681, 0.5721746660249317, 0.560117496623959, 0.5513139697772274, 0.5250077641503791, 0.513970751595747, 0.4913309093640822], 'MSE': [0.07631910913222277, 0.077109753377201842, 0.078168345621180441, 0.079386753841530017, 0.080098749198554448, 0.081583897644484663, 0.084076261136663374, 0.085445897918398517, 0.087803663034834445, 0.089428710594598476, 0.094727862650522951, 0.096935850980591681, 0.10141714915640668], 'Rp': [0.78559494046767298, 0.78413146632162278, 0.78102004680905823, 0.77619818050183986, 0.7745103554700018, 0.76988135167790639, 0.76190908835211413, 0.75788854490550717, 0.75013491165023904, 0.74430643293683874, 0.72759527857846096, 0.71995951927743673, 0.70505894962808857]}


# Assemble the average performances and method names
methods = ['NP-NMF', 'NP-NMTF', 'BNMF', 'BNMTF', 'HMF D-MF', 'HMF D-MTF']
avr_performances = [
    np_nmf_avr,
    np_nmtf_avr,
    bnmf_avr,
    bnmtf_avr,
    hmf_mf_avr,
    hmf_mtf_avr
]
colours = ['#0000ff','#ff0000','#00ff00','#00ffff','#ff00ff','#ffff00']

# Also compute the median values
def compute_medians(all_performances):
    medians = {}
    for metric in ['MSE','R^2','Rp']:
        medians[metric] = []
        for performances in all_performances[metric]:
            medians[metric].append(numpy.median(performances))
    return medians
    
median_performances = [
    compute_medians(np_nmf_all),
    compute_medians(np_nmtf_all),
    compute_medians(bnmf_all),
    compute_medians(bnmtf_all),
    compute_medians(hmf_mf_all),
    compute_medians(hmf_mtf_all)
]

# What to plot - averages or medians
values_to_plot = avr_performances # median_performances # 

# Plot 
for metric in metrics:
    fig = plt.figure(figsize=(3.8,3.0))
    fig.subplots_adjust(left=0.12, right=0.965, bottom=0.14, top=0.97)
    plt.xlabel("Fraction missing", fontsize=10, labelpad=1) #fontsize=8
    plt.ylabel(metric, fontsize=10, labelpad=0) #fontsize=8, labelpad=-1
    plt.yticks(fontsize=8) #fontsize=6
    plt.xticks(fontsize=8) #fontsize=6
    
    x = fractions_unknown
    for method,performance,colour in zip(methods,values_to_plot,colours):
        y = performance[metric]
        #plt.plot(x,y,label=method)
        plt.plot(x,y,linestyle='-', linewidth=1.2, marker='o', label=method, c=colour, markersize=5) #linewidth=0.5, markersize=2)
     
    plt.xlim(fraction_min,fraction_max)
    plt.ylim(MSE_min,MSE_max)
    
    plt.legend(loc='upper left',fontsize=6,ncol=2)
        
    plt.savefig("./mse_missing_values_gdsc_average.png", dpi=600)