"""
Plot the performances of the many different algorithms in a single graph, as we 
vary the fraction of missing values on the GDSC dataset.

We plot the average performance across all 10 attempts for different fractions.

We have the following methods:
- Non-probabilistic NMF
- Bayesian NMF
- Non-probabilistic NMTF
- Bayesian NMTF
- HMF D-MF
- HMF D-MTF
"""

import matplotlib.pyplot as plt, numpy
metrics = ['MSE']

MSE_max, MSE_min = 0.13, 0.075
fraction_min, fraction_max = 0.25, 0.95

fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]

np_nmf_all = {'R^2': [[0.5060407585284845, 0.5333029308536477, 0.5660821396803861, 0.5137703787512382, 0.49743459828016856, 0.5669949001145442, 0.5328920856008045, 0.5191225983808463, 0.555947819431266, 0.5521915852926196], [0.5353482719877596, 0.5136404101319185, 0.5507475327656193, 0.534602809669845, 0.5507852488934213, 0.49960367369528125, 0.563375763464464, 0.5762588602197325, 0.5460698716923946, 0.5815914374647371], [0.5413235830967862, 0.5435399168135089, 0.5369243182516463, 0.540513760265547, 0.5422711283731333, 0.5320805062153848, 0.5425019475576691, 0.5260824335769881, 0.5615687036012784, 0.5082806822547911], [0.5199749336034657, 0.54941254535977, 0.5264677795943207, 0.5243271107886658, 0.5401872957128717, 0.525558314127241, 0.5133127267335235, 0.5306185646853838, 0.5448813253122764, 0.5314537630275766], [0.5306562348444082, 0.5093274679339992, 0.4916921852081604, 0.501363411557203, 0.5228836878361556, 0.5170831672581779, 0.5253806533287051, 0.5271145913260202, 0.5515294909667621, 0.5041927634873182], [0.538108582572649, 0.5386914358694668, 0.5014027795655667, 0.5271336447678613, 0.5192723339727278, 0.4776226718649689, 0.5237195269209831, 0.5112992943523629, 0.5186291310310054, 0.5215940202617795], [0.48932083944897653, 0.4894941140910466, 0.499325782562852, 0.4849452698937615, 0.46495204228439535, 0.48152148111551807, 0.5053567072328169, 0.4766432746544387, 0.48203139593765987, 0.488428163090442], [0.47303349347746415, 0.49948915687121176, 0.4729960182241406, 0.4874696492182983, 0.46612324370865044, 0.5012274653330921, 0.48536010756879666, 0.486785565486214, -0.05336260639755719, 0.4589329859109218], [0.4286950422674076, 0.47212032600126064, 0.4738216598729905, 0.47746221887939155, -0.08023051647942459, 0.44381802425038686, 0.45846300364364967, 0.4745212734390918, -0.2783343381771637, 0.4691930963026597], [-0.12079422316204314, 0.41148222026951087, 0.42999039612322854, 0.38733334403224584, 0.39019657533009855, 0.28866990505404466, 0.39878571826657006, -0.12226363087425818, 0.41504534216039657, 0.41300696875144505], [-15.586261023257677, 0.28658008557054204, 0.3299359483728901, 0.24254343064608652, 0.22352930901244128, 0.3299037909466137, 0.024224736701983662, -567.3675272143224, 0.0682473661574764, -4.846320524734421], [-1188661.821222181, -0.9307448264729832, -99.17123266808007, -15.21792039294833, -0.07816292026035443, 0.13133157072106905, 0.13267755619808974, -2.7032089081133517, -3.808632155534461, 0.14283198640511452], [-0.17768235700969126, -28421.619551367272, -32494.20575735634, -3902.0031605461163, -1206782.4303194135, -4.664829858847253, -1775.8925601829337, -0.28610945794340736, -57523.119147280304, -1547531.237535557]], 'MSE': [[0.096760538665035423, 0.090324488184432963, 0.086316216141761201, 0.09639894270408271, 0.099378582071684374, 0.088851297131436011, 0.09318172025369989, 0.096236105311380979, 0.0885577668074983, 0.087216168812378383], [0.092155335788594417, 0.097798143248055414, 0.089822746851471014, 0.093560685394138768, 0.089975355210008739, 0.09934791027095502, 0.087023022204003778, 0.084208765073924441, 0.090857959005191252, 0.083108965030300186], [0.091113434243296806, 0.092752679383306558, 0.092069408614374654, 0.091211566681915851, 0.09134889949902246, 0.094833404794292933, 0.091405461632530119, 0.094599279254931126, 0.087516016532757313, 0.097165531291851931], [0.096287095130200132, 0.089683748662104906, 0.093589493118144088, 0.095244388962619997, 0.091044400578677395, 0.094229105246533648, 0.096578071431975124, 0.093733800203385467, 0.090326922571444965, 0.092895447209534118], [0.094009853102214283, 0.098209408117003807, 0.10148795096447902, 0.0998082078243199, 0.095052325040520053, 0.095766238893703753, 0.094377060712564409, 0.094530392822133644, 0.089077690412530997, 0.099003813827430079], [0.091984019577862397, 0.091942364919121777, 0.099596354082737676, 0.094798244498704914, 0.095787921952934549, 0.10479939503334078, 0.094295447297515975, 0.097633472947215749, 0.096090208503715427, 0.094883749700071879], [0.1019944897418615, 0.10144226838736421, 0.099588911856066165, 0.1024209085965252, 0.10649188092320717, 0.10383896574756574, 0.098695190286347365, 0.10409256037651406, 0.10372733057214543, 0.10167882864195951], [0.10511209250063071, 0.10017617263803127, 0.10498811278562427, 0.10267905478576936, 0.1063264169715642, 0.099497647142122794, 0.10246688508032635, 0.10281694451253477, 0.2108173758808948, 0.10811212299784881], [0.11369657949356118, 0.10605527809535809, 0.10498125277954119, 0.10462458276653122, 0.21558385704954192, 0.11088407217274315, 0.10749821427187763, 0.10502861531826606, 0.25603278128213802, 0.10553777222653252], [0.2244129572693376, 0.117544560032038, 0.1134249058784559, 0.12220792050062043, 0.121357557528417, 0.14080197410126366, 0.11983387593407878, 0.22406814853736512, 0.11684092732753446, 0.11686433879934108], [3.3047994172491286, 0.14216680618796254, 0.1335687067101429, 0.15116688223249158, 0.15470559120679581, 0.13332554624116352, 0.19507440763848435, 113.26023859056689, 0.18585341834616484, 1.1692745172032815], [237434.75629302333, 0.38580731994270689, 19.918137636333764, 3.2302457065538666, 0.21461866719342804, 0.17315837861905781, 0.17311674523923068, 0.73939416731584195, 0.95959115410932594, 0.17114335946849676], [0.23483483943512395, 5660.3399970662231, 6471.2825482423459, 777.43449043939904, 240758.34687214188, 1.1305497899600496, 354.69513419505415, 0.25658072898424977, 11475.777657530738, 308294.049490089]], 'Rp': [[0.71936774493401445, 0.73601788610757934, 0.7558103085462351, 0.72175443462117383, 0.71488333997081333, 0.75620751626722238, 0.73542856114543886, 0.72710324944228288, 0.74791265957935438, 0.74773224990154097], [0.73532579050929947, 0.72105867731621565, 0.74510011085101724, 0.73392044181579441, 0.74453219420196826, 0.71693432646959865, 0.75291020130832909, 0.76258153026675313, 0.741607917978652, 0.7649079795229603], [0.73988489974167526, 0.74066964916274924, 0.73690922692076644, 0.73973414766407564, 0.74035025240224794, 0.73350795305658445, 0.74015270355217611, 0.72966064218429305, 0.75100944921140877, 0.71826572210447603], [0.72678618043073806, 0.74402781107491023, 0.73303250924590868, 0.729702362725693, 0.73981588669015097, 0.73059280062328491, 0.72255324238049057, 0.73275946455891061, 0.74274389135903229, 0.73274352262972642], [0.73375684699666788, 0.7209571063582888, 0.71166272473410186, 0.71586576438512772, 0.72972613937233566, 0.72482147875456648, 0.73069472316210948, 0.73397198882758874, 0.74625415236094816, 0.7197409809858144], [0.73781326157856986, 0.73952713758763655, 0.71922970543752651, 0.73214862002733538, 0.72817286728340491, 0.70590737603396492, 0.72986192308613962, 0.72271809059891878, 0.72857152093410316, 0.72844919814905074], [0.7090030922591557, 0.71124066684141063, 0.7196460201647048, 0.70752265540125481, 0.70226122892012366, 0.70458381341803789, 0.71961433658583285, 0.70666099835355878, 0.7067652407499958, 0.71019218836891107], [0.70278043766541498, 0.71791032283735901, 0.70535447163171061, 0.71019389000639566, 0.69926174325538604, 0.71806839386349686, 0.70938963329904337, 0.71076921039046792, 0.54653432731718321, 0.69705302673219083], [0.68446388118227797, 0.70243049516425538, 0.70399575649984192, 0.70686373641365519, 0.53602519485722488, 0.68679951948732609, 0.69633473310859773, 0.70482050513513361, 0.50361525577634891, 0.70068933449250448], [0.51711941342211432, 0.67404256817611741, 0.67919988791866381, 0.66376288087402158, 0.6676404294667303, 0.62446674646254263, 0.6646425729679396, 0.50964386856596977, 0.6718736700598823, 0.67896154448486568], [0.16865969467316133, 0.61730645521328054, 0.64528336160044697, 0.61092086241950982, 0.59331726324419698, 0.64515944937029557, 0.55208083043186262, 0.050842322101870847, 0.54386367722875417, 0.25599369973762803], [0.017812336829178117, 0.42023736151618452, 0.1019380477580181, 0.15147683029764161, 0.11841864086602573, 0.57499480063689801, 0.57172941885038375, 0.28957928089971424, 0.28236882475112379, 0.57574772978988564], [0.10198214161157389, 0.012119784883604951, -0.0064491381963088191, 0.036109417980537052, 0.039182938294302284, 0.26633310110718644, 0.033367438935612156, 0.084046302464303044, 0.0082023116624770406, 0.034751568836944781]]} 
np_nmf_avr = {'R^2': [0.5343779794914005, 0.5452023879985173, 0.5375086980006734, 0.5306194358945093, 0.518122365374691, 0.517747342117937, 0.48620190703119076, 0.42780550794012323, 0.3339529790000251, 0.2891452615951239, -58.62951440949065, -118878.33242829393, -287843.56366533774], 'MSE': [0.092322182608339007, 0.090785888807664306, 0.092401568192827993, 0.09336124731146199, 0.096132294171689989, 0.096181117851322107, 0.10239713351295562, 0.11429928252953474, 0.13299230054560912, 0.14173571659084522, 11.883017388358251, 23746.072150615815, 57379.354815506304], 'Rp': [0.7362217950515656, 0.74188791702405887, 0.73701446460004527, 0.73347576717188445, 0.72674519059375497, 0.72723997007166508, 0.70974902410629859, 0.69173154569986484, 0.66260384121171656, 0.63513535823988465, 0.46834276160210064, 0.31043032721950536, 0.060964586758023284]}

bnmf_all = {'R^2': [[0.5846345522300793, 0.5942845369204632, 0.5967828084841125, 0.575695253016793, 0.544815805245646, 0.6198404010787207, 0.5756607200910788, 0.5554006218554062, 0.5968725914028101, 0.6177972382789085], [0.5848045488077691, 0.5528571632595023, 0.5791212963665022, 0.5832191421562236, 0.583993343354057, 0.5689999266090211, 0.5871910437005814, 0.6207451989438963, 0.5950782498168863, 0.6187414847726322], [0.5953312125837116, 0.5939134205718626, 0.5823924111133445, 0.6032876828049853, 0.5883807060448685, 0.5678237341118515, 0.5954472016308366, 0.57077148779742, 0.5901596061768271, 0.5503170086487094], [0.5648838074552875, 0.5833633437389492, 0.5754860322906525, 0.569870169026388, 0.5689639519895772, 0.57700720913542, 0.5523546378582265, 0.5649454371445362, 0.5823217661149727, 0.5813343998072851], [0.5791535127955474, 0.5587723098629243, 0.5514246094828226, 0.5765186685736767, 0.5658519543990794, 0.5549905823589746, 0.5645006240818444, 0.5769584649696412, 0.5985086556816717, 0.5773754986749559], [0.5704486714303144, 0.5665484630956028, 0.5518884579463543, 0.5671689104588351, 0.5680230128345231, 0.5651978275856776, 0.5539240299017227, 0.5540543414163626, 0.5597465571434659, 0.5629678489377115], [0.555812595652813, 0.5361015272889333, 0.562052743569791, 0.5346868192974649, 0.5508481980926457, 0.5431242969272196, 0.5618237326004156, 0.5514326555148268, 0.5306195645348329, 0.5506720422538041], [0.5276748350983613, 0.5416412852686505, 0.5363537643592209, 0.544598726698976, 0.5337493315875541, 0.5412648077252527, 0.5351989118763438, 0.5368353410029902, 0.5333529945704704, 0.5358146339158685], [0.5253806042705447, 0.5106966545691362, 0.5138607719592024, 0.5156148497105983, 0.5115145656961946, 0.513067334430612, 0.5096015186048631, 0.5356057678016655, 0.5226983654401478, 0.5294301943848521], [0.5103497314192051, 0.521498377234753, 0.5107484151968089, 0.4878350191601686, 0.502061174491781, 0.49310443997340014, 0.4947357919974972, 0.5035924525128428, 0.502164156821484, 0.5180257579408031], [0.4836674773477043, 0.45017660915627555, 0.48354408326392806, 0.4545770241509475, 0.4498748129668815, 0.48286147496938836, 0.47773527508332925, 0.456063643289931, 0.4622365291651098, 0.45502561128619134], [0.43968734830350564, 0.4243162689639731, 0.4318276162775032, 0.4508208048899912, 0.4215516035776887, 0.42918908440280157, 0.4199568628085425, 0.43392453902126593, 0.42111199358927864, 0.4440182816481033], [0.38335516212462817, 0.36213864310641763, 0.362736189461766, 0.40995498394197816, 0.3474867051109478, 0.36392903749187233, 0.36728373475700216, 0.4037044985496594, 0.40361886568035077, 0.3854475647439505]], 'MSE': [[0.081364981348119605, 0.078522116323120658, 0.080209148868228913, 0.084121837103334721, 0.090009299687818359, 0.078007565014955815, 0.084649955297776566, 0.088975926987693604, 0.08039609894165374, 0.074438665045198305], [0.082346570379071213, 0.089912361369804891, 0.084149746543125584, 0.083787146826903053, 0.083323948310340124, 0.085570085884178124, 0.08227642893830095, 0.075368132680844274, 0.081048517126663763, 0.075729809202614073], [0.080385129022992302, 0.082516784470227242, 0.083029373506517484, 0.07875045832554721, 0.082146816262046063, 0.087589312498961985, 0.080827306460122025, 0.085678841146367854, 0.081808937856939809, 0.088858999821109105], [0.087278930116607936, 0.08292627053580591, 0.083901465090280292, 0.086125263505348687, 0.085346529691370951, 0.084010813964591466, 0.08883060670758347, 0.086878846081613267, 0.082896157837946891, 0.083005955639420273], [0.084295817645639232, 0.088312891921503031, 0.08956186765557117, 0.08476496453803041, 0.086492077705349946, 0.088248897761123074, 0.086598136653238733, 0.084566539277739966, 0.079746429145574713, 0.084390533995412798], [0.085543606843626677, 0.086390243926929275, 0.089511681938478596, 0.086772143966176274, 0.086074051601854523, 0.087230057994447552, 0.088315468524597721, 0.089091795632983029, 0.087882437109603653, 0.08667794924923114], [0.08871454164542264, 0.092180941830780655, 0.087111916690036553, 0.092529581739133948, 0.089395762595519804, 0.091501380972042773, 0.087428437264423231, 0.08921739442237106, 0.093997163557297717, 0.089307379967819081], [0.094212982815813029, 0.091739514472933853, 0.092366177416828801, 0.091233957597764176, 0.09285806583390209, 0.091510797247703696, 0.092543777469299121, 0.092790014936696863, 0.093393572687923782, 0.092750184515271672], [0.09445498612493744, 0.098304982988951489, 0.096992789883146829, 0.096985512011493955, 0.097488056885255428, 0.097078077295639109, 0.097346924376941757, 0.092819519999972691, 0.095596950936268521, 0.093561121032465611], [0.09804106992087408, 0.095571050968612403, 0.097355052581156606, 0.1021609657584665, 0.099095277621566794, 0.10033583004854234, 0.10070913192735588, 0.099111400410233863, 0.09943950491597349, 0.095956166629022968], [0.10287884759412361, 0.10956609685643583, 0.10294888780218728, 0.10885098115578558, 0.10960805512113191, 0.10289235396429897, 0.1044097813048164, 0.10839176868708639, 0.10726578674018998, 0.10899584833837676], [0.11192214943398809, 0.11503487895464549, 0.1129759057437926, 0.1093841685093087, 0.1151456997337225, 0.11378414284598436, 0.11577606543740233, 0.1130243808798623, 0.11552054559473154, 0.11100808426430875], [0.12296158690757167, 0.1270295352081294, 0.12690838785745831, 0.11753035483865457, 0.13017913425278108, 0.12694289342867984, 0.12629991572740565, 0.11896182980942632, 0.11897509076280822, 0.12242902234515163]], 'Rp': [[0.76476437931452734, 0.77097947475549422, 0.77263661675526341, 0.75908460441375536, 0.7421714401152234, 0.78755075185068701, 0.7605384231262089, 0.7461119425562226, 0.77474140091897714, 0.78621451407986276], [0.76496255134698599, 0.74420764816633478, 0.76131677234053963, 0.76380128224902355, 0.76426174628415744, 0.7556994345867577, 0.76639633218401593, 0.78865527620937936, 0.77143394466927673, 0.78662050667044392], [0.77233112680802507, 0.7707939510570474, 0.76468390400146269, 0.77718179037570234, 0.76715349425863399, 0.75411044605894317, 0.77171666337323364, 0.75587731024967875, 0.76888050874970804, 0.74324358730657802], [0.75230449803589317, 0.76425019917535875, 0.7594680210134408, 0.75570678865923102, 0.75527548601961347, 0.75988084364100184, 0.7442198776468929, 0.75341591940905905, 0.76334799776923135, 0.76269501022598274], [0.76171770700445796, 0.74879581600480483, 0.74341203322836136, 0.75940853513227213, 0.75320960765003686, 0.74570297278325792, 0.75215936831619712, 0.7601773437606878, 0.77388253686256714, 0.76005918915146531], [0.75551271489481331, 0.75361039296696064, 0.7437329419354054, 0.75342423909068912, 0.75446057801780619, 0.75322803146405404, 0.74515455383659635, 0.74504890651010969, 0.75027193650000035, 0.7507942025164962], [0.74612492060178348, 0.73350302710297854, 0.75069517301240862, 0.73258960440385146, 0.74448268944866969, 0.73723754875991943, 0.75022124103878485, 0.74370803750386516, 0.73066250236026364, 0.74321665504306356], [0.72822868567007237, 0.73758556570105238, 0.73378159290564415, 0.73879602404029809, 0.73223626717491097, 0.73720372979240423, 0.73397396721057617, 0.73348960376861094, 0.73180409826496551, 0.7338948367804532], [0.73021951586101563, 0.71766049752279482, 0.7185353986360915, 0.72074323656237282, 0.71874308078915172, 0.7184598417474376, 0.71805779214177101, 0.73269551744302552, 0.72542842876752545, 0.72892718473810247], [0.71603617016968724, 0.72405592711795164, 0.71677295008700226, 0.70693145150066261, 0.71285759473431853, 0.70812982640779054, 0.7079887403195031, 0.7123777123674917, 0.71302446994431068, 0.72212097597834235], [0.70006376536728032, 0.67929161181227804, 0.70134848737315902, 0.6867790467151057, 0.68000023635116735, 0.70033058133606152, 0.69511972739435035, 0.6837599587549702, 0.6863299436080843, 0.68087626819734204], [0.67711051836399105, 0.66607613447126224, 0.67304473478184801, 0.67976118624770521, 0.66460142294545643, 0.67065974529707173, 0.66083810307959445, 0.66846106566106356, 0.66240057682203846, 0.67501117637551544], [0.65306995219664954, 0.63182597878439306, 0.63657096549245984, 0.65771020223449794, 0.62913174895304957, 0.63272481876287112, 0.63712119751600371, 0.65082171760271357, 0.6516713055838691, 0.64915606869247233]]} 
bnmf_avr = {'R^2': [0.5861784528604019, 0.5874751397787072, 0.5837824471484417, 0.5720530754561295, 0.5704054880881138, 0.561996812075057, 0.5477174175732745, 0.5366484632103689, 0.5187470626867816, 0.5044115316748744, 0.4655762540679687, 0.4316404403482654, 0.37896553849685727], 'MSE': [0.082069559461790037, 0.082351274726184601, 0.083159195937083097, 0.085120083917056916, 0.085697815629918295, 0.08734894367879284, 0.090138450068484754, 0.092539904499413711, 0.096062892153507301, 0.098777545078180484, 0.10658084075644325, 0.11335760213977468, 0.12382177511380665], 'Rp': [0.76647935478862217, 0.76673554947069156, 0.76459727822390133, 0.75705646415957051, 0.75585251098941086, 0.75052384977329312, 0.74124413992755889, 0.73409943713089876, 0.72294704942092891, 0.71402958186270604, 0.68938996269097974, 0.6697964664045547, 0.64298039558189801]}

np_nmtf_all = {'R^2': [[0.5741460515433148, 0.5686191260030459, 0.5649491534666086, 0.525572361142702, 0.5115320657279884, 0.5675076220285762, 0.5851169312502029, 0.5262619893231215, 0.5686970719143005, 0.5730023178421657], [0.5472946594510142, 0.5143617535648558, 0.5425717118879698, 0.5365181880099156, 0.5525264850314415, 0.5159555166095834, 0.5371438059237321, 0.5829319098108354, 0.5611493878084688, 0.5655455055046974], [0.5585804282455544, 0.5728510453377595, 0.5536929241995628, 0.5696514238315323, 0.5345815388641648, 0.5345520702065443, 0.5594741896318245, 0.5323285072053758, 0.5471383786270179, 0.5213829125503158], [0.5046172227486141, 0.5435022786199599, 0.503000264402141, 0.5213852087364605, 0.4236867910334373, 0.5244136764091856, 0.4709822944777762, 0.5481985816643684, 0.5236918224779579, 0.5332495938638928], [0.5111063614486924, 0.5074915830961142, 0.46660980720853207, 0.49147717827915993, 0.5103653069973269, 0.5012399723279444, 0.4920158005896934, 0.5111046276073463, 0.535223203510347, 0.42259572416833724], [0.47226747558795523, 0.494807265990191, 0.4504844109400884, 0.4111989883537077, 0.3986190749950832, 0.024706310907554818, 0.4657763823469212, 0.489210873965615, 0.496268815494157, 0.48454572078142677], [0.44622231282366065, 0.36726769169544493, 0.13060727414683493, 0.45200773065523936, -0.4283296420026952, 0.4055566181927702, 0.43293199813620553, 0.4474159212647212, 0.041152808842784716, 0.4607608262878281], [-269256.2240936693, 0.2873474829984338, -0.4629419112684814, 0.3420823203130765, -0.7523558861617183, -176.15396908525253, 0.38710282752064495, 0.40083239161268325, -659.141635090169, 0.20809308806829174], [0.04321166051766279, 0.13976418325208062, -24.243565490380863, -0.04320096667933271, -0.06833177397114198, 0.23393836500783116, -0.9550636788238067, -1.1202488886879731, 0.25785975611855794, -812.056100767108], [-0.7547810975798295, -296.6542550411777, 0.0014184980748567222, -2693.5875542822755, -130.92101419435372, -0.27363027230285986, -0.22159438564486367, -2.310272333845568, -938.4156437540988, -161.070345526955], [-180165.90872534286, -0.8862360036319812, -10952.937186505216, -2.560362797652484, -6.1732696861981236, -5111.803099979735, -57.87669372384709, -172.25017205338816, -284270.1734941804, -705980.3921641462], [-120974.49254056875, -488883.91858519014, -2817.08851777897, -39859.11803866698, 0.280079971462014, -5881.178417321092, -21023.72499231114, -25783.38953826947, -133225.83137252176, -587.792618124669], [0.12428869292374456, -109068050.03450751, -3135856.3820224903, -50052.06510868305, -498402.54153391893, -16361.297987445552, -3399135.0626703002, 0.0453593107576542, -72495.14560817298, -1234697.5169788094]], 'MSE': [[0.083419549602003457, 0.083489396510671846, 0.086541593089467433, 0.094059104539909552, 0.096590912405265364, 0.088746088192461645, 0.082763568885286062, 0.094807327048425566, 0.086015170739359603, 0.083163023977356698], [0.089785984117727757, 0.097653094091309914, 0.091457406074417366, 0.093175629115309591, 0.089626594757158645, 0.096101440748263961, 0.092251280354844686, 0.082882650584226267, 0.087839666163073607, 0.086296186606419648], [0.087685461128121756, 0.086796658678508221, 0.088735448975027553, 0.085427515466715065, 0.092883510013641937, 0.094332492069856388, 0.088014505947701771, 0.093352492671605142, 0.090396478236549435, 0.094576482780171264], [0.099367662103845747, 0.090860112698343681, 0.098227641816234459, 0.095833448523728756, 0.11411187678531387, 0.09445644232760271, 0.10497810926880495, 0.090223133451140039, 0.094532380814080622, 0.092539400152726617], [0.097925705112070771, 0.098576865334428429, 0.10649585970485761, 0.10178705825063157, 0.097546268706115671, 0.098908070131836237, 0.10101159163655619, 0.097730804870452395, 0.092316535323317822, 0.11529727930087977], [0.10509603994758659, 0.10068881940738354, 0.10976745745655879, 0.11804033348011889, 0.11982882030568751, 0.19566352345655924, 0.10576720615446442, 0.10204633580858267, 0.10055372617927925, 0.10223165445793174], [0.11060226654448652, 0.12572979549903648, 0.1729305654812652, 0.10897068379235207, 0.28428388140131383, 0.11905292835497555, 0.11314594813597979, 0.10990570827359339, 0.19201677241689971, 0.10717792416435377], [53707.759212561024, 0.14263587403581302, 0.29144278922051148, 0.13180559038907105, 0.34899762995661388, 35.339562387175782, 0.12203030713732382, 0.12003673046263878, 132.11910729903749, 0.15823314901157945], [0.19041242339329337, 0.17282830399907759, 5.0365074494759554, 0.20887382658991943, 0.21320920019173059, 0.15272705216445581, 0.38809140589735519, 0.42377891559265363, 0.14864048087241175, 161.65601647690414], [0.35135407314754619, 59.450435748095501, 0.19870544653544592, 537.48631234963318, 26.253726072405566, 0.25210469497849319, 0.24348787861303725, 0.66092010165332038, 187.64222746358374, 32.266556433731033], [35898.114356706632, 0.37587981906498941, 2183.5274103017518, 0.71054759508753418, 1.4292167631950561, 1017.2677548665315, 11.770472755245638, 34.524062130706888, 56702.570416450711, 141197.53578080321], [24164.78927074093, 97690.475516806968, 560.35124529699146, 7939.2407927417908, 0.14330698460058952, 1172.5399970352532, 4196.5153631491867, 5148.1911243589248, 26586.206792288394, 117.55915421236485], [0.17462053580470061, 21720807.631996911, 624492.71137374139, 9970.0096482254157, 99433.593236498768, 3265.4806964907834, 678519.93356985296, 0.19045222197145675, 14462.622989450861, 245972.39169956776]], 'Rp': [[0.76117721707319708, 0.76153765054803346, 0.76134166663594371, 0.73618873773536153, 0.73036406028392764, 0.76095654766549992, 0.77102500554847031, 0.73490767335123675, 0.7624543659854498, 0.76374776873289185], [0.74799003645625695, 0.72757394963710575, 0.74403896856989804, 0.73992804876075546, 0.75119602475709168, 0.73099810062628867, 0.74263081113763862, 0.77331170984925945, 0.75535525615844046, 0.75916846107387614], [0.75615842994897486, 0.76253478109683948, 0.75496246308036685, 0.76289321807860844, 0.74189494390976307, 0.73940627405954618, 0.75426504264411209, 0.74064627204030908, 0.75018058585599701, 0.73494935314241605], [0.72697513546204673, 0.7463495122791054, 0.7255170848047503, 0.73615634342216074, 0.69214997646883913, 0.73972432318182468, 0.70862710450688893, 0.74931587485234374, 0.73783199989243908, 0.74195115682126833], [0.73247069753645866, 0.72713950844960018, 0.70983026618053013, 0.72249967884246558, 0.7289024306594194, 0.72385832558307961, 0.72259462445110201, 0.73174198499294996, 0.74499962194212777, 0.69170137531520937], [0.71163882023223313, 0.72609941436298631, 0.70212736024925682, 0.68563434391901212, 0.68579459078061467, 0.56719802736626268, 0.71048353337812842, 0.72139797994580235, 0.72339136394418002, 0.71745616915887067], [0.69918762633784781, 0.66267791160756284, 0.58754283836982257, 0.70046040326899761, 0.49334584103653978, 0.67645659741182407, 0.69371728758369322, 0.7018772908787152, 0.56835647285936131, 0.70633176811618326], [-0.0081245389011495705, 0.6347684099806995, 0.48203378541374997, 0.65477820709665224, 0.44162054636025316, 0.073816296103459522, 0.67393998682167777, 0.68073183920167091, 0.053426062950854676, 0.61484015772514466], [0.56809582829268235, 0.590843001708797, 0.10895648552624776, 0.55600133819611097, 0.53661311453420768, 0.61104091807133309, 0.42238357337390131, 0.41375846513416442, 0.61749034398660285, 0.047123260969704477], [0.44212287429190444, 0.077629349925023822, 0.52943256023608831, -0.000133651474130291, 0.065820894986794165, 0.49370422746173692, 0.49880733011978501, 0.31608329490191178, 0.019066474039969156, 0.041194868400885473], [0.020192242817150534, 0.40498832399038714, 0.030575189832604828, 0.30779265596972938, 0.22529381395615117, 0.028107935991871072, 0.1083230835370312, 0.064924960886788508, 0.029762741491927563, 0.022136691774030486], [0.027083891376184471, 0.050811616504727319, 0.016240987226211288, 0.020663309504861831, 0.61577192068514952, 0.054646396284317195, 0.0029590128106269774, 0.0012385740471890885, 0.012196748394282189, 0.053384598758423912], [0.57412993483405983, 0.0098065044937355825, 0.025328846890367691, 0.010596237790628982, 0.0091499981425980075, -0.0083629642025421988, 0.032082793328605211, 0.54120639488405708, 0.026734541804985842, 0.044180878544260033]]} 
np_nmtf_avr = {'R^2': [0.5565404690242026, 0.5455998923602514, 0.5484233418699652, 0.5096727734433795, 0.49492295652334944, 0.41878853193627014, 0.27555935400427944, -27009.110953753163, -83.7811737600755, -422.4207672390159, -118672.0961404419, -83903.62545407817, -11747504.987676933], 'MSE': [0.087959573499020727, 0.090706993261275154, 0.090220104596789849, 0.097513020794182156, 0.10075960383711464, 0.11596839166541528, 0.14438164740642562, 5387.6533064317455, 16.859108553508101, 84.480583026237682, 23704.782589819217, 16757.60125636154, 2339692.4740283499], 'Rp': [0.75437006935600115, 0.74721913670266116, 0.74978913638569344, 0.73045985116916667, 0.7235738513952944, 0.69512216033373464, 0.64899540374705478, 0.43018307527530136, 0.44723063297937521, 0.24837282228899685, 0.12420976402476717, 0.085499705559197378, 0.1264853166510756]}

bnmtf_all = {'R^2': [[0.5941929599474387, 0.5968491052848404, 0.6106399966584322, 0.5747983319636255, 0.5569201486639157, 0.6080661505915745, 0.5660788382623474, 0.543287325070379, 0.5797668208719176, 0.6068486259434914], [0.5854150873567245, 0.5473538645539486, 0.5860857495459351, 0.5809250055909023, 0.583538936506822, 0.5671182607151077, 0.5928974813762868, 0.6100612533373422, 0.5920062566668283, 0.6154231900517017], [0.584426987583068, 0.6007306547456885, 0.5840749948347832, 0.6060098519262915, 0.5903258100679247, 0.5712475102433576, 0.5947353926389474, 0.5702207240438959, 0.5943648884675565, 0.5489544600772971], [0.5623650277470954, 0.5849070871787971, 0.5804924711174851, 0.5732629781164881, 0.578603128551517, 0.5787610098537443, 0.5569165734195822, 0.5733106425345196, 0.5872824789307423, 0.5790127020644471], [0.5841364713098784, 0.5625071342284721, 0.553414885900496, 0.5789165174394189, 0.5731507797660512, 0.556302254502138, 0.5751077406587155, 0.5816281033350199, 0.5968467946061626, 0.5795110715580771], [0.5791164622681151, 0.5702055831101803, 0.5561989288056723, 0.5677443893662977, 0.5682371781538549, 0.5763462915449601, 0.5648514179437465, 0.5552940932707378, 0.5711211870692408, 0.5642903260837506], [0.5600743545506364, 0.5531882003202768, 0.5707508378847957, 0.5450334261949854, 0.5526317038021961, 0.5547612246382561, 0.5674035439388387, 0.5516553926888992, 0.546266197179326, 0.5620688066302071], [0.5374947546511608, 0.5472602739400619, 0.544514115223371, 0.5592133260017639, 0.5454578297502141, 0.5603233356008892, 0.5365616005592324, 0.5528884464324122, 0.5509226613333051, 0.5529627836090476], [0.5332495218213473, 0.537312822063635, 0.5308552044036863, 0.5383632208944443, 0.539039104119168, 0.5434649358327914, 0.5242858140533704, 0.5482011544720105, 0.5410834425727185, 0.5559596533852306], [0.5310201375727599, 0.5391145317818341, 0.5362529507763594, 0.5255449871656166, 0.5184708235663289, 0.507319207737583, 0.5065748947322809, 0.5297866171158615, 0.5218270142007155, 0.5285019575594061], [0.5156442765541576, 0.49901073383771577, 0.5091546922445104, 0.49783560565235696, 0.5028484505684676, 0.5132254799405133, 0.5152478868972215, 0.5070112619323204, 0.515729813807532, 0.5126529638284281], [0.5124783202879708, 0.501225727361974, 0.4819650222593641, 0.498130277460641, 0.4908021400994358, 0.49502563542967537, 0.4810226828612414, 0.5023141072004862, 0.49998294123226794, 0.5010983459337773], [0.4857096319886841, 0.47611234976930217, 0.4858708348221581, 0.48312670336859953, 0.48841534632113137, 0.4795168869786578, 0.476013811327178, 0.4856878567658217, 0.490825844994085, 0.48134637581178863]], 'MSE': [[0.079492606864839346, 0.078025770105755177, 0.077452636267685976, 0.084299658933671431, 0.087615755520830604, 0.080423604523058898, 0.086561411311570038, 0.091400113487509871, 0.083807519725123764, 0.076571041280984325], [0.082225481009121873, 0.091018975501313132, 0.082757286043696074, 0.084248346408462502, 0.083414963615133911, 0.0859436689113936, 0.081139086090595211, 0.077491320120495408, 0.081663402568907556, 0.076388925828361459], [0.08255119065371247, 0.081131522628289876, 0.082694839661872133, 0.078210086734722267, 0.081758632070636453, 0.086895414612430208, 0.080969521774811329, 0.085788779789318745, 0.080969514308704568, 0.089128244390265593], [0.087784166193538918, 0.082619007878507483, 0.08291198633479277, 0.085445918442843272, 0.083437941598933557, 0.083662490709301568, 0.087925337630881201, 0.0852083443708683, 0.081911610405968519, 0.083466262719250686], [0.08329772790263093, 0.087565356923330201, 0.089164492148831584, 0.084285005779547215, 0.085037987154454764, 0.087988782769688176, 0.08448893378955119, 0.083633072647305434, 0.080076517174577894, 0.083964098387851765], [0.083817447378352616, 0.085661351621261678, 0.088650651903866881, 0.086656774391729183, 0.086031377854652258, 0.084993451971259265, 0.08615203121935841, 0.08884411586142428, 0.085611858161689161, 0.086415658233183437], [0.087863369407030698, 0.088785660954818726, 0.085381782167658238, 0.09047211324619038, 0.089040787167787669, 0.089170780004054678, 0.086315108629707898, 0.089173093314508317, 0.090863800986810878, 0.087042185583582621], [0.09225423917725796, 0.090614885932062031, 0.090740497409613902, 0.088306105149232456, 0.090526211818751076, 0.087708906506296314, 0.092272460638397877, 0.089573949410881246, 0.089877223218570543, 0.08932376445908749], [0.092888976592316055, 0.092957580570368431, 0.0936021204613144, 0.092430743093878179, 0.091994927348356278, 0.091017812895278605, 0.094432007115192104, 0.090302051728626542, 0.091914672918883111, 0.088286396868607467], [0.093902302181876826, 0.092052579297898729, 0.092279963445974902, 0.094639001363633679, 0.095829577805821117, 0.097522133036692979, 0.098349365016629137, 0.093881543713809371, 0.095511975731774001, 0.093870461899353816], [0.096507495591716563, 0.099834673050447312, 0.097843740150572608, 0.10021779324780293, 0.099053480404210331, 0.096850986330592345, 0.096910359251592582, 0.09823928958375025, 0.096595669534984566, 0.097470275196013312], [0.097382192109762761, 0.099666596405893579, 0.10300653902566025, 0.099961183505811152, 0.10136071643348232, 0.10066043528918109, 0.10358738510469066, 0.09936950774910866, 0.099781378774220122, 0.099611399127216158], [0.10255167301786651, 0.10433177051856955, 0.10238664494083358, 0.10295536833030379, 0.10206328029568754, 0.10387462443996022, 0.10459571708068126, 0.10260602923136587, 0.10157772910609153, 0.10332439105651946]], 'Rp': [[0.77098364527170316, 0.77270381234441532, 0.78144431662644653, 0.75850064237860004, 0.75032334428968694, 0.78010032436497845, 0.75399946431626097, 0.73813375574884565, 0.76380049571423614, 0.77945695492600831], [0.76548948478687462, 0.7402504787587898, 0.76603619334825035, 0.76228039945261727, 0.7639584803230145, 0.75411874600076678, 0.77009380114819559, 0.78224153616485115, 0.76948656223674838, 0.78452930498316353], [0.76516126871301304, 0.77526043970083947, 0.76531768174913162, 0.77877144576975499, 0.76872236853369247, 0.75623102463665126, 0.77140972580145839, 0.75544782122099752, 0.77219219796840588, 0.74233475022403828], [0.75024670658669734, 0.76527893130743474, 0.76275707448322505, 0.75814066074045394, 0.76093384221364613, 0.76097488518179002, 0.74689075479450295, 0.75870827078570824, 0.76641377712589587, 0.76118281886246431], [0.76492038016648556, 0.75070734999194699, 0.74441022103270083, 0.76089069911196028, 0.7579259006188579, 0.74630560117451639, 0.75846164616751066, 0.76293750629590606, 0.7729596881439974, 0.76139651499790295], [0.76122877013832846, 0.75563975656120452, 0.74601459717076768, 0.7535421313476689, 0.75451763599841559, 0.76002905597467341, 0.7523093614047951, 0.74537831380185804, 0.75776983067886072, 0.75140575686027955], [0.74863262493518068, 0.74419392651742322, 0.7558206804249783, 0.73891975329170689, 0.74470854169661593, 0.74487002733490515, 0.75338787336342272, 0.74314428227535279, 0.73992005453826126, 0.75007834758715486], [0.73336796285058115, 0.74006513175696731, 0.73823088304914075, 0.74796431258817264, 0.73905275881335841, 0.74974709735615508, 0.73308976311057827, 0.74366059901479609, 0.74249373388167961, 0.7445877677413858], [0.73245996146080805, 0.73321894140068189, 0.72879082311278875, 0.734254442766619, 0.73465772539407126, 0.73771384595342293, 0.72605102041892411, 0.74120136791494196, 0.73573732928075619, 0.74570983005180214], [0.72891658521309133, 0.73490391845968939, 0.73263239337125885, 0.72597732088028677, 0.72218445032472822, 0.7141828347088689, 0.7132261520509845, 0.72844360061386049, 0.72400013910688665, 0.72711022263458036], [0.71857933591613854, 0.70767278808980139, 0.71434287484692949, 0.70811754700214236, 0.70950338911936783, 0.7173928745414162, 0.71860226854198128, 0.71246953131685131, 0.7184403770470551, 0.71639754022127722], [0.71638834192477951, 0.70829503378686187, 0.69740019716259738, 0.70624291713075049, 0.70316287083305917, 0.70441687613303128, 0.69471567118152611, 0.70980131273825953, 0.70760100226464473, 0.70802099948480901], [0.69903226639966975, 0.69201108037973835, 0.69760963564088074, 0.69648939697131418, 0.69921080039451666, 0.69355475664661959, 0.69145838856496844, 0.69739307385914362, 0.70311582416355245, 0.69595202705071812]]} 
bnmtf_avr = {'R^2': [0.5837448303257962, 0.58608250857016, 0.5845091274628811, 0.5754914099514419, 0.574152175330443, 0.5673405857616557, 0.5563833687828418, 0.5487599127101459, 0.5391814873618402, 0.5244413122208746, 0.5088361165263223, 0.49640452001268337, 0.48326256421474073], 'MSE': [0.082565011802102947, 0.082629145609748073, 0.08300977466247636, 0.084437306628488626, 0.084950197467776906, 0.086283471859677718, 0.088410868146215016, 0.0901198243720151, 0.091982728959282112, 0.094783890349346464, 0.097952376234168276, 0.10043873335250268, 0.10302672280178793], 'Rp': [0.76494467559811807, 0.76584849872032712, 0.76508487243179812, 0.75915277220818178, 0.75809155077017853, 0.75378352099368517, 0.74636761119650008, 0.74122600101628155, 0.73497952877548167, 0.72515776173642355, 0.71415185266429604, 0.70560452226403192, 0.69658272500711227]}

hmf_mf_all = {'R^2': [[0.6155217345820396, 0.6029498611141813, 0.618376221687865, 0.6248497907423864, 0.5723037817812888, 0.6561889466111129, 0.6121430520802655, 0.5860120900347748, 0.5921202651013384, 0.6211203078561853], [0.6037588304444947, 0.5719666737156777, 0.6121558910568417, 0.6018774314230521, 0.608902418697885, 0.598099809223715, 0.6165600567810603, 0.632352203962586, 0.6089776144458043, 0.6396062614167726], [0.6160457623611293, 0.6053642313098477, 0.6005668600236748, 0.6094387401334875, 0.5951711910028724, 0.594674200204578, 0.6059703317981122, 0.6011711899950352, 0.605015629057321, 0.5761822607438258], [0.5866234676222457, 0.5980630488909577, 0.5788456614145225, 0.6020120493090307, 0.6082277619732639, 0.5916523141352645, 0.5758781101705368, 0.6020158104074156, 0.6084957898815206, 0.5876036580537315], [0.5964374223004856, 0.5718533822294047, 0.5771113287104903, 0.5895080421885486, 0.5851621842669961, 0.5819714835374896, 0.588438371693885, 0.5869877633650976, 0.6112218536383482, 0.5998453381198467], [0.5913507608528265, 0.5869400303437347, 0.5775652433641448, 0.5915992068771347, 0.577090229897032, 0.5854005498509167, 0.5737564837890272, 0.5751283975367986, 0.5864050356399952, 0.5823069714868042], [0.563330131334747, 0.5747108861380663, 0.564952342395863, 0.5436806071742466, 0.56193628130273, 0.567754089020831, 0.5799288778400382, 0.5671705518448158, 0.556133928557055, 0.572482708909241], [0.5606984081989055, 0.5558255073934613, 0.5586348535994112, 0.5607562339613129, 0.5485030621854614, 0.5561267502400722, 0.5398987241910195, 0.5558481063139156, 0.561441730250055, 0.5645380335672416], [0.5210152769060946, 0.5317151329964115, 0.5254015981926959, 0.5411023085309937, 0.535083338878233, 0.5511963004729511, 0.5357051768557527, 0.5487390802391244, 0.5445585444190105, 0.5580809621028884], [0.5388934604599305, 0.541128375976007, 0.5304830159050804, 0.5218071336578574, 0.5222141046577278, 0.5123925901486185, 0.5230141434323636, 0.5294010786299599, 0.5374351691136248, 0.5184244078789321], [0.5196546073668701, 0.5013219412175736, 0.5124512657229601, 0.4783349443416156, 0.5043822145903394, 0.5013235677127079, 0.5123671499516211, 0.47453652630968346, 0.5049548458253623, 0.4863046817988018], [0.49606425452006697, 0.4713196696125672, 0.47069340058821174, 0.4795833128078606, 0.49193459522081284, 0.49131747870100806, 0.4762822736087925, 0.4805614132390952, 0.497187263195388, 0.4912775789035556], [0.4755655445656879, 0.436477149883567, 0.4610393068900206, 0.46477368854216206, 0.453840202790172, 0.47603777947434744, 0.4627557593770587, 0.46480185079769076, 0.48625555585136804, 0.45620813847531816]], 'MSE': [[0.075314562302779789, 0.076845030640578432, 0.075913723646596903, 0.074376553684184721, 0.084573756129141822, 0.070548956743948274, 0.077372222789237319, 0.082849774114785599, 0.081343860089588771, 0.073791456579014314], [0.07858732859956355, 0.086069783409123274, 0.077544867877733084, 0.080036195234676671, 0.078334791350349611, 0.079792640337666573, 0.076422928230938866, 0.07306150850142773, 0.078266441598077885, 0.07158541506790575], [0.076270302754471733, 0.08018997996709322, 0.079415902039502301, 0.077529425948152833, 0.080791639941676263, 0.082147519297973759, 0.078724845989254166, 0.079610718499713212, 0.078843501870276222, 0.083747931634192904], [0.082918222992899207, 0.080000479662838977, 0.083237463839217443, 0.07968946735832487, 0.077572168498062949, 0.081102142190022777, 0.084162616163967002, 0.079476024624563921, 0.077701426991610312, 0.081762992826958342], [0.080833839636721722, 0.085694680608066537, 0.084433297081688785, 0.082164982644785167, 0.082645044604159182, 0.082898371018953212, 0.081838165793331419, 0.082561669811136232, 0.077221263523917033, 0.079903710009580714], [0.081381030683698383, 0.082326046851520035, 0.084382663750313544, 0.081874461592684369, 0.0842673532533042, 0.083176985708591417, 0.084388979373738723, 0.084881584220670853, 0.082560929469122996, 0.082842360771906487], [0.087213115162368654, 0.0845089030732563, 0.086535158626907638, 0.090741127285226889, 0.087188874745846814, 0.0865686170398344, 0.083815953721807904, 0.086087219830944847, 0.088887709334561554, 0.084972342584169802], [0.087625890794818931, 0.088900572811992457, 0.087927407329640786, 0.087997002808919714, 0.089919726052383048, 0.088546062404848816, 0.091608025819593222, 0.088981013660543659, 0.087771962891052782, 0.087010881184696867], [0.095323738938981689, 0.094082201388250394, 0.094690204801802166, 0.091882312125842969, 0.092784387667439502, 0.089476437532299932, 0.092165197797198561, 0.090194535295309131, 0.091218657827703151, 0.087864627304747409], [0.092325852521330312, 0.091650354525886671, 0.093428109574125229, 0.095384586748230249, 0.095084623887859127, 0.096517898485224005, 0.095072698195782318, 0.093958519294545753, 0.092394347263558302, 0.095876799483330027], [0.095708440342661655, 0.099374107028968636, 0.097186610350783686, 0.10410957304229462, 0.098747890157817889, 0.099219047703940771, 0.097486268556083361, 0.10471062393814677, 0.098744914473309242, 0.10273997852804653], [0.10066089287822184, 0.10564251607800666, 0.10524779837578341, 0.10365532255000698, 0.10113529038307834, 0.10139961077335791, 0.10453356633953635, 0.10371271803984355, 0.10033927295850288, 0.10157222715095521], [0.10457444692376411, 0.11222508615049022, 0.10733173852027818, 0.10661108321002775, 0.10896116618825197, 0.1045689620204797, 0.10724222853612259, 0.10677281814950493, 0.10248947921734772, 0.1083323442335371]], 'Rp': [[0.7849220985010229, 0.77853142066266967, 0.78822580233215944, 0.79126554936309967, 0.76210890292398881, 0.81057833855206818, 0.78364111845221573, 0.76904071955320608, 0.77170656368793467, 0.78898784521011733], [0.77799507224551134, 0.75926962990463776, 0.78303264111505533, 0.77684133202197181, 0.78158378554022701, 0.77501765752164087, 0.78615478269248795, 0.79638631735474952, 0.78130181906623053, 0.80030363807638527], [0.78591409679749202, 0.77886071793182698, 0.77681994060558346, 0.78181486696269298, 0.77305761438453779, 0.77239104697967187, 0.77948948338699997, 0.776439015088631, 0.7788685771636138, 0.7614514362817586], [0.76726081425838955, 0.77399142696479606, 0.76327532611214355, 0.77658043794511056, 0.78102489115495433, 0.77117356732756148, 0.76135156263834469, 0.77672770376783007, 0.78101607818247054, 0.76904671239065048], [0.77366261253665125, 0.75875551010516473, 0.76202032277264187, 0.76901392476684749, 0.76741944600978251, 0.76444290757690581, 0.76868673044158342, 0.7684389120653643, 0.78248240364572708, 0.77577813933250483], [0.76994534723604291, 0.7678941915812203, 0.76161925800378183, 0.77071405976126506, 0.76122346286957632, 0.76602704371126229, 0.76022933124834857, 0.76099409215864366, 0.76787110752195631, 0.76482451919132233], [0.7519966990860697, 0.75931870497967091, 0.75402590214472398, 0.74034290553726068, 0.75359173637202526, 0.75552937076497384, 0.76387983964488038, 0.75493557489735863, 0.74851707630830766, 0.75855247898634648], [0.75125543941149031, 0.74814390389002317, 0.75048726547181221, 0.75092360825865201, 0.74373216206077819, 0.7479414448841365, 0.73859707455018153, 0.74831505913324825, 0.75137302318888599, 0.75320188663134435], [0.72833352658570205, 0.73345615062426306, 0.72871495142602971, 0.73748003364584891, 0.73594163358480025, 0.74425470010093409, 0.73577616244276356, 0.74196088949582517, 0.74145179856332288, 0.74976378372977903], [0.73590400234434294, 0.73814652414206394, 0.73100462342487027, 0.72792606795560921, 0.72690420485828422, 0.72168010867067123, 0.72727283382105956, 0.73031564903032242, 0.73632171740777475, 0.72405747332212078], [0.72376724352152599, 0.7150087941786557, 0.72085334075787155, 0.70115083842789117, 0.71358217301890892, 0.71287755069255376, 0.7193472873216552, 0.69850345681720938, 0.71408861492766995, 0.70305476273493839], [0.71069597261543571, 0.69385134721928299, 0.6948476280915743, 0.70115025187649316, 0.7070910787608955, 0.70662445641610949, 0.69898258612974906, 0.7006878993524196, 0.7090161492807836, 0.70654401764679076], [0.6940666764619764, 0.67303802749098529, 0.68509075301866984, 0.68938950679273392, 0.68595591807156786, 0.69514911915389588, 0.68943109988550799, 0.68935020689128623, 0.70077231801165063, 0.68366515604834988]]} 
hmf_mf_avr = {'R^2': [0.6101586051591438, 0.6094257191167889, 0.6009600396629884, 0.5939417671858489, 0.5888537170050592, 0.5827542909638413, 0.5652080404517635, 0.5562271409900857, 0.5392597719594155, 0.5275193479860102, 0.49956317448375354, 0.48462212403973587, 0.46377549766473936], 'MSE': [0.077292989671985585, 0.077970190020746288, 0.079727176794230664, 0.080762300514846591, 0.082019502473234002, 0.083208239567555103, 0.086651902140492482, 0.088628854575849042, 0.091968230067957485, 0.094169378997987205, 0.09980274541220531, 0.1027899215527293, 0.10691093531498042], 'Rp': [0.78290083592384818, 0.78178866755388976, 0.77651067955828068, 0.77214485207422512, 0.76907009092531731, 0.76513424132834196, 0.75406902887216165, 0.74839708674805516, 0.73771336301992674, 0.729953320497712, 0.712223406239888, 0.70294913873895348, 0.6885908781826624]}

hmf_mtf_all = {'R^2': [[0.6123144865842867, 0.6125188293386558, 0.6234420861379597, 0.5897001480892428, 0.5657820540915737, 0.642063540936501, 0.5992776161373643, 0.5731961796458944, 0.5900610439307158, 0.6130150471233395], [0.5822176635672656, 0.5762035828863449, 0.6128619826279479, 0.6012243686712244, 0.6075750865441238, 0.5934297913584454, 0.6257330876121867, 0.6285518636565669, 0.6110447259028822, 0.6336228874115334], [0.606256758027161, 0.6107986035987734, 0.6053196283112867, 0.6169323559664224, 0.5978730833609667, 0.5969008596108992, 0.6096064566854381, 0.5880589260302564, 0.6016033532102711, 0.5841875810707443], [0.5731194697102961, 0.5962476956863648, 0.5948496769170497, 0.6018046038017162, 0.6043276362071539, 0.5865892878976798, 0.571845835634052, 0.6059872565353512, 0.5995962314322325, 0.5880918938304296], [0.6032308851241087, 0.570105970493081, 0.5809474017870717, 0.594430790509267, 0.5868971615080747, 0.5783369800523106, 0.5850779258679574, 0.5908337695813846, 0.6225963978238405, 0.6002252930901983], [0.5892235903304789, 0.5907793845223979, 0.5707115315928675, 0.589761097073096, 0.58935164663409, 0.5878912954337202, 0.5713429109299861, 0.581339368698712, 0.5885664711496015, 0.5671878754441224], [0.5700448866480712, 0.5770283411229065, 0.569712211180172, 0.5634429963042455, 0.556890439469129, 0.5661968236140221, 0.5845566997790406, 0.5650257201047006, 0.5751238274188786, 0.5676163647140509], [0.5540434811868222, 0.5602314952177019, 0.564047156325445, 0.5553810254682923, 0.5744274612069734, 0.5689066095883383, 0.5619760331875249, 0.5606761104236199, 0.5614949377867791, 0.569442586215989], [0.5523493559586798, 0.5472838871873997, 0.5433070568609351, 0.5544386175777517, 0.5527323575263589, 0.5630444492504367, 0.5469478156594952, 0.5547241121718416, 0.5544209952261778, 0.5606071936079463], [0.548835641071592, 0.5395039978312355, 0.5414213047182206, 0.5321902613713463, 0.5261295092496957, 0.5305026900274954, 0.5356529959294345, 0.5494464936583147, 0.5469241233825712, 0.5339799327990468], [0.5294187707817815, 0.5104765439856005, 0.5142961219459762, 0.4932679678710845, 0.5107229554633513, 0.513251241215378, 0.5203250509717339, 0.5031323156243284, 0.5125820398418535, 0.513726482374532], [0.48681955687213885, 0.4873294158927164, 0.47143217157667827, 0.47872970770478696, 0.4885265521626041, 0.4867753217334243, 0.4877950774355082, 0.49359173844045157, 0.48440166635260284, 0.5040481493006133], [0.4876016009902988, 0.4590634196433452, 0.45672181984142746, 0.4634005932344578, 0.4389922063605243, 0.48000231396187054, 0.4835017277365605, 0.456961795358244, 0.48768156553712194, 0.4789953776353756]], 'MSE': [[0.075942822729632889, 0.074993053813490806, 0.074906007000646521, 0.08134525373887723, 0.085863379426415379, 0.073447445969661851, 0.079938703501762312, 0.085414571914999779, 0.081754532610100877, 0.075370055294731036], [0.082859632665538974, 0.085217817376924118, 0.077403693172926516, 0.08016748308930044, 0.07860064900912446, 0.080719818439210098, 0.074594663102944422, 0.07381673836699254, 0.07785269173589851, 0.072773899399945982], [0.078214832208835558, 0.079085715631325854, 0.07847094944801776, 0.07604188534056161, 0.080252423587244645, 0.081696241470006453, 0.077998369292566053, 0.082228073939459259, 0.079524632053950814, 0.082166051129084205], [0.085626958062396188, 0.080361802817438682, 0.080074410441386856, 0.079731004349470141, 0.078344405996605873, 0.082107712413747327, 0.084962779471308592, 0.078682940983271388, 0.079467712955420655, 0.08166619366981831], [0.079473104735103398, 0.086044429699662264, 0.083667392673054647, 0.081179634399491982, 0.082299398026055431, 0.083619121892443138, 0.08250638339120045, 0.081792848291687287, 0.074961988710678787, 0.079827839815728607], [0.081804649065834359, 0.081560833867421773, 0.08575171411075963, 0.082242958062544641, 0.081824191121305984, 0.08267729206531696, 0.084866825821772046, 0.083640745650345891, 0.082129468402045477, 0.08584097823356561], [0.085872022564846204, 0.084048403210205319, 0.085588374997358149, 0.086811288896372393, 0.088193160772832832, 0.086880500412718234, 0.082892573634460495, 0.086513814191145316, 0.085084831126648164, 0.085939565839704524], [0.088953324882224502, 0.088018723791173883, 0.086849185022636596, 0.089073858699498715, 0.08475664594519397, 0.085996671956136708, 0.08721234426226003, 0.088013775412219566, 0.087761314066800683, 0.086030888715365683], [0.089087879155795108, 0.09095431327917447, 0.091117770630280981, 0.08921206354272565, 0.089262136207906018, 0.087114313189119913, 0.089933469211270586, 0.088998293497581399, 0.089243344613463768, 0.087362348899332573], [0.090335162253071963, 0.091974791307457254, 0.09125152452948096, 0.093313476081772442, 0.094305415508906532, 0.09293315234242143, 0.09255352536822356, 0.089956305457706415, 0.090498989732348947, 0.092779852777507693], [0.093762938489153125, 0.097549822885610094, 0.096818861836031916, 0.10112936440646522, 0.097484548119497319, 0.096845860744151469, 0.095895346049709021, 0.099012258416921309, 0.097223544928574601, 0.097255569574863421], [0.10250751623839524, 0.10244339974703587, 0.10510090049065141, 0.10382534152608328, 0.10181369403167902, 0.10230503395835029, 0.10223562150794385, 0.10111104292748269, 0.10289071487244171, 0.09902243727847132], [0.10217440640258106, 0.10772705014523223, 0.10819154777332461, 0.10688458840768186, 0.11192340364109742, 0.10377774608922653, 0.10310101358808865, 0.10833692074396598, 0.10220499732811969, 0.10379274882676172]], 'Rp': [[0.78278513827449325, 0.78478329344033293, 0.79108498936183058, 0.76986101675394347, 0.75663671318384207, 0.80158853037092093, 0.77589717021800109, 0.7608855233527374, 0.770796766288811, 0.78386593976434837], [0.7647379518183548, 0.76075985507508592, 0.78319413965153051, 0.77603469442833228, 0.7803393138925564, 0.77215176318807188, 0.79171252894006083, 0.79474256078132455, 0.78196618551751951, 0.79645037923547513], [0.77984357405265892, 0.78172598182250808, 0.77954854916556648, 0.78639750695936039, 0.77381575735516572, 0.7739820348562727, 0.78148093695283982, 0.7680012400669739, 0.77660969454910556, 0.76647691681744567], [0.75857953669066225, 0.77289516993594631, 0.77347437265558572, 0.7764367319345421, 0.77870293948353264, 0.76792372529984454, 0.75825757764395363, 0.77922041827258803, 0.77572460180101666, 0.76842546950341095], [0.7775948075182566, 0.75772949746028584, 0.7645016456383692, 0.77177738940426233, 0.7675274826418611, 0.76225867645310452, 0.76612402141367775, 0.77075689022182858, 0.78933855759681459, 0.77598461429857224], [0.76848297403058174, 0.77006129749817021, 0.75725194154003661, 0.76928615243476184, 0.76836896202312621, 0.76777569076890895, 0.75783589533016482, 0.76413946660637466, 0.76853864814873463, 0.75603563654874517], [0.7566606936998318, 0.76085494540348919, 0.7570701610134023, 0.75237542591796536, 0.75057092069111098, 0.75383123359618776, 0.76625746534257921, 0.75424913101440216, 0.75957911434155911, 0.7556970671506793], [0.74677443282084599, 0.75043738139036742, 0.75332382525440444, 0.74814853359282407, 0.75890813476502883, 0.75673792688201102, 0.75178519473811578, 0.75024469452474496, 0.7518352526921851, 0.7562126449943839], [0.74608092152501349, 0.74127990530278132, 0.73927377359389612, 0.74580175119849323, 0.74613834531133094, 0.75190140087366297, 0.74312606898958367, 0.74632692412083801, 0.74794723621345816, 0.75074070551324479], [0.7422519456566814, 0.7367503180286652, 0.73896114162424642, 0.73400324556206131, 0.72907247607122883, 0.73185484015969193, 0.73473360414910149, 0.74265048517375964, 0.74155767845211906, 0.73333829398522565], [0.7306540399531537, 0.72002576365172766, 0.72274567168508752, 0.70995592473446323, 0.71734963915766514, 0.72107567182992138, 0.72451225370843386, 0.71466052537772373, 0.71984944283200769, 0.72066824836152898], [0.70407854605039211, 0.70399297309196418, 0.69763090253365989, 0.70174825908951877, 0.70730866392385039, 0.70295427292974966, 0.70478586105502827, 0.70682020179616478, 0.70317493030130984, 0.71329416509512433], [0.70109411131445853, 0.68557449434504847, 0.68520146108698299, 0.69180526373455253, 0.67697012546263546, 0.69887452820150298, 0.70233321758059775, 0.68431905982690411, 0.70232210971130127, 0.69887761991627684]]} 
hmf_mtf_avr = {'R^2': [0.6021371032015532, 0.6072465040238522, 0.6017537605872219, 0.5922459587652327, 0.5912682575837295, 0.5826155171809072, 0.5695638310355218, 0.5630626896607486, 0.5529855841027024, 0.5384586950038953, 0.512119949007562, 0.48694493574715236, 0.4692922420299227], 'MSE': [0.078897582600031879, 0.078400708635880598, 0.079567917410105229, 0.081102592116086406, 0.081537214163510605, 0.083233965640091237, 0.085782453564629157, 0.087266673275351023, 0.089228593222665048, 0.09199021953588972, 0.097297811545097757, 0.10232557025785347, 0.10581144229460797], 'Rp': [0.77781850810092612, 0.78020893725283114, 0.7767882192597898, 0.77096405432210824, 0.77035935826470325, 0.76477766649296053, 0.75671461581712074, 0.75244080216549114, 0.74586170326423029, 0.73651740288627809, 0.72014971812917117, 0.70457887758667626, 0.692737199118026]}


# Assemble the average performances and method names
methods = ['NP-NMF', 'BNMF', 'NP-NMTF', 'BNMTF', 'HMF D-MF', 'HMF D-MTF']
avr_performances = [
    np_nmf_avr,
    bnmf_avr,
    np_nmtf_avr,
    bnmtf_avr
]
colours = ['#0000ff','#00ff00','#ff0000','#00ffff','#ff00ff','#ffff00']

# Also compute the median values
def compute_medians(all_performances):
    medians = {}
    for metric in ['MSE','R^2','Rp']:
        medians[metric] = []
        for performances in all_performances[metric]:
            medians[metric].append(numpy.median(performances))
    return medians
    
median_performances = [
    compute_medians(np_nmf_all),
    compute_medians(bnmf_all),
    compute_medians(np_nmtf_all),
    compute_medians(bnmtf_all),
    compute_medians(hmf_mf_all),
    compute_medians(hmf_mtf_all)
]

# What to plot - averages or medians
values_to_plot = median_performances # avr_performances # 

# Plot 
for metric in metrics:
    fig = plt.figure(figsize=(3.8,3.0))
    fig.subplots_adjust(left=0.12, right=0.965, bottom=0.14, top=0.97)
    plt.xlabel("Fraction missing", fontsize=10, labelpad=1) #fontsize=8
    plt.ylabel(metric, fontsize=10, labelpad=0) #fontsize=8, labelpad=-1
    plt.yticks(fontsize=8) #fontsize=6
    plt.xticks(fontsize=8) #fontsize=6
    
    x = fractions_unknown
    for method,performance,colour in zip(methods,values_to_plot,colours):
        y = performance[metric]
        #plt.plot(x,y,label=method)
        plt.plot(x,y,linestyle='-', linewidth=1.2, marker='o', label=method, c=colour, markersize=5) #linewidth=0.5, markersize=2)
     
    plt.xlim(fraction_min,fraction_max)
    plt.ylim(MSE_min,MSE_max)
    
    plt.legend(loc='upper left',fontsize=6,ncol=2)
        
    plt.savefig("./mse_missing_values_gdsc_median.png", dpi=600)