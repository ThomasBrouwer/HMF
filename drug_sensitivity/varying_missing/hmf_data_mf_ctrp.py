"""
Test the performance of HMF for recovering the CTRP dataset, where we vary the 
fraction of entries that are missing.
We repeat this 10 times per fraction and average that.

GDSC has 0.7356934001670844 observed entries
"""

project_location = "/home/tab43/Documents/Projects/libraries/"
import sys
sys.path.append(project_location)

from HMF.code.models.hmf_Gibbs import HMF_Gibbs
from HMF.code.generate_mask.mask import try_generate_M_from_M
from HMF.drug_sensitivity.load_dataset import load_data_without_empty,load_data_filter

import numpy, random


''' Settings '''
metrics = ['MSE', 'R^2', 'Rp']

fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]
repeats = 10

iterations, burn_in, thinning = 500, 450, 2
settings = {
    'priorF'  : 'exponential',
    'orderG'  : 'normal',
    'priorSn' : 'normal',
    'priorSm' : 'normal',
    'orderF'  : 'columns',
    'orderG'  : 'rows',
    'orderSn' : 'rows',
    'orderSm' : 'rows',
    'ARD'     : True
}
hyperparameters = {
    'alphatau' : 1.,
    'betatau'  : 1.,
    'alpha0'   : 0.001,
    'beta0'    : 0.001,
    'lambdaF'  : 0.1,
    'lambdaG'  : 0.1,
    'lambdaSn' : 0.1,
    'lambdaSm' : 0.1,
}
init = {
    'F'       : 'kmeans',
    'Sn'      : 'least',
    'Sm'      : 'least',
    'G'       : 'least',
    'lambdat' : 'exp',
    'tau'     : 'exp'
}

K = {'Cell_lines':10, 'Drugs':10}
alpha_l = [1., 1., 1., 1.] # GDSC, CTRP, CCLE IC, CCLE EC


''' Load data '''
location = project_location+"HMF/drug_sensitivity/data/overlap/"
location_data = location+"data_row_01/"

R_ctrp,     M_ctrp,   cell_lines, drugs   = load_data_without_empty(location_data+"ctrp_ec50_row_01.txt")
R_ccle_ec,  M_ccle_ec                     = load_data_filter(location_data+"ccle_ec50_row_01.txt",cell_lines,drugs)
R_gdsc,     M_gdsc                        = load_data_filter(location_data+"gdsc_ic50_row_01.txt",cell_lines,drugs)
R_ccle_ic,  M_ccle_ic                     = load_data_filter(location_data+"ccle_ic50_row_01.txt",cell_lines,drugs)


''' Seed all of the methods the same '''
numpy.random.seed(0)
random.seed(0)

''' Generate matrices M - one list of (M_train,M_test)'s for each fraction '''
M_attempts = 1000
all_Ms_train_test = [ 
    [try_generate_M_from_M(M=M_ctrp,fraction=fraction,attempts=M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]

''' Make sure each M has no empty rows or columns '''
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms_train_test,fraction in zip(all_Ms_train_test,fractions_unknown):
    for (M_train,M_test) in Ms_train_test:
        check_empty_rows_columns(M_train,fraction)

''' Run the method on each of the M's for each fraction '''
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms_train_test) in zip(fractions_unknown,all_Ms_train_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for repeat,(M_train,M_test) in zip(range(0,repeats),Ms_train_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
     
        D = [(R_ctrp,    M_train,   'Cell_lines', alpha_l[0]), 
             (R_gdsc,    M_gdsc,    'Cell_lines', alpha_l[1]), 
             (R_ccle_ic, M_ccle_ic, 'Cell_lines', alpha_l[2]),
             (R_ccle_ec, M_ccle_ec, 'Cell_lines', alpha_l[3])]
        R, C = [], []

        HMF = HMF_Gibbs(R,C,D,K,settings,hyperparameters)
        HMF.initialise(init)
        HMF.run(iterations)
        
        # Measure the performances
        performances = HMF.predict_Dl(l=0,M_pred=M_test,burn_in=burn_in,thinning=thinning)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
 
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)

'''
200 iterations
repeats=10 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.4613831479115331, 0.37514804479062, 0.47277655260949125, 0.45332797028919014, 0.4372671612907343, 0.4193870381172182, 0.44609155895509667, 0.3823508072973548, 0.444203681457947, 0.5486045088199711], [0.4245091834740865, 0.3958501774227826, 0.4183254570133078, 0.43113486873257234, 0.4393636867565629, 0.46031885618844737, 0.45869270089765457, 0.4346289623243622, 0.4582830956901225, 0.49090242865332867], [0.4413941377812871, 0.41828905478831524, 0.38969740002215913, 0.4144907369374128, 0.4539304672119835, 0.45640437092190766, 0.4225378726240694, 0.4106577908377478, 0.42084249312929456, 0.4462900130516938], [0.4243613145322912, 0.3914676019577493, 0.4087788070646874, 0.4341639675170741, 0.405573919550281, 0.39886694637094344, 0.40070092656415535, 0.43512763652693387, 0.4265537152440565, 0.39262304305033113], [0.4071111319573322, 0.41637619819634963, 0.39476010977496934, 0.43017492211498054, 0.41466345021553197, 0.4137339953667746, 0.4197459288845281, 0.40470476910398734, 0.4332210685981984, 0.4068941385093142], [0.3807434383525008, 0.4143876342623045, 0.39194997008356613, 0.40101540333271757, 0.4305280719146497, 0.41892282810608583, 0.41411545999146027, 0.41302336995985456, 0.4197985363195973, 0.41642672452046514], [0.3866643006062891, 0.37655747297531506, 0.4212267948006233, 0.3820242772963367, 0.40531371628843627, 0.3883744643470829, 0.37424214838445624, 0.4217386117160654, 0.3876680431181707, 0.38798945620299086], [0.3973360484247642, 0.4104608821054071, 0.3824818760064337, 0.3706209054901214, 0.3858755190451535, 0.3990325961921939, 0.404102637009063, 0.39618507621000265, 0.3819755135348385, 0.3744605063854298], [0.3926620581853516, 0.3749291385495406, 0.38280351398412105, 0.3746396772936912, 0.4021498609523, 0.3763769657427194, 0.3795295048627879, 0.3844479656550318, 0.40153134031508575, 0.39494051176462586], [0.38133866702560326, 0.386799761947326, 0.3590280858803543, 0.3734739708301321, 0.37522174084996385, 0.3659652701694135, 0.3767548212249957, 0.3938572219985459, 0.3827498770893596, 0.3860578930652726], [0.37385924125177117, 0.3469614086680223, 0.36637358907190964, 0.3786417106844915, 0.3766024997484301, 0.36467814065427673, 0.35862725978300125, 0.35431156929204866, 0.3583970053539983, 0.38693003579668217], [0.3466214734399369, 0.3572829454275762, 0.35204686926472795, 0.36026944075322165, 0.3478913362381395, 0.3588760774710782, 0.36540755943839287, 0.3519141134033076, 0.35491400709011445, 0.3561067340993419], [0.33596825466074, 0.34005906691558363, 0.34059593079913275, 0.35359651706243767, 0.31440182998954636, 0.3395194747955691, 0.33206074693898013, 0.3449462199097827, 0.3258955516299282, 0.32286970886322863], [0.3032673968803209, 0.30481956460541104, 0.3243692755718748, 0.3301917321468404, 0.3085800517841273, 0.3261291749173827, 0.3168399845888411, 0.31674927451749446, 0.2973547423332914, 0.31800678323872145], [0.3006880657960189, 0.29007628965669274, 0.3030881154538856, 0.2663305810076495, 0.31249392775488594, 0.3211984065670308, 0.31161917424420327, 0.30424307299898634, 0.30051656524610504, 0.30360887463119746], [0.2839954633582106, 0.28771207052544645, 0.26773995330221567, 0.29690751126023207, 0.3016038178128073, 0.29211541009878117, 0.2708779432838655, 0.2987209557558451, 0.29601147698052266, 0.3140807514099534]], 'MSE': [[0.089345130486071789, 0.089485481628775496, 0.082590175007456398, 0.089818364369539813, 0.096954835207966425, 0.095773440379089719, 0.087356079699563466, 0.1050119885045426, 0.089176159336870897, 0.069945115198864066], [0.089304358246954887, 0.096201527969059175, 0.09255599001087314, 0.0933272302301765, 0.090755497164209775, 0.086645471660286008, 0.082189775396350528, 0.091749924002450148, 0.089477286736105319, 0.081983491158273761], [0.090346233831696099, 0.094140285542759147, 0.096892784516284164, 0.091877479886421989, 0.085968333134592553, 0.085609398652795932, 0.093642969429736822, 0.091397842729869436, 0.091558009189706399, 0.089330524327367378], [0.09309976098828654, 0.094416568579833979, 0.097237354276792823, 0.089248588853071145, 0.095480135027383006, 0.096230346271494585, 0.09613233395180415, 0.091739744007507423, 0.092052950369098455, 0.097417958976761324], [0.092527586043420776, 0.091920803502911819, 0.095248451450179475, 0.090542677720429718, 0.094882620131292117, 0.092341274977450663, 0.091175985792617875, 0.094194355763436419, 0.091838530493747725, 0.092511211089207401], [0.098138824781584047, 0.093477477907411954, 0.096211493918092514, 0.095605226563563808, 0.090024549217481251, 0.091828360914744986, 0.094891544312022555, 0.092517927001351169, 0.093183278660585053, 0.092876304160790193], [0.097580514289489412, 0.098427272948462249, 0.091786244229805303, 0.098134926074477491, 0.095010575534995104, 0.096804574168926169, 0.1003042372618395, 0.092087416388007451, 0.095502983718695061, 0.097886353595234843], [0.096438446165120664, 0.093309244687748621, 0.098604911323037336, 0.098380083413842176, 0.097160862711316812, 0.095682156923924178, 0.094898602983694638, 0.095582697969766109, 0.097756498760307203, 0.099174320686700332], [0.096288124816306206, 0.098097001157533864, 0.098870033249358932, 0.099543451843196365, 0.094671551553243194, 0.099349527271032467, 0.099136841478860038, 0.09735776883450338, 0.096777590890502821, 0.096220096745032013], [0.098836004250587639, 0.098089493237958431, 0.10113185225826411, 0.099738083305848338, 0.10025678313116029, 0.10009360689807073, 0.098420738079116554, 0.096948218809805781, 0.09817583761577002, 0.097922757386939827], [0.099943873093766733, 0.10423371962706442, 0.1005773627096177, 0.098774485437605156, 0.09897754887416059, 0.10123301985295695, 0.10135091355721165, 0.10350342263399662, 0.10218614831052948, 0.09829047364334513], [0.10361240428015739, 0.10118071336491585, 0.10325668986877204, 0.1009039001007818, 0.10456182421513739, 0.10124373546825055, 0.10107218768974088, 0.10393032762060637, 0.10270676254431772, 0.10177808376866464], [0.10608829508305469, 0.10447000167445573, 0.10435009255700128, 0.10280451208624515, 0.10847453624182533, 0.10415001644775423, 0.1075863494881077, 0.10355627926598014, 0.10700357854141333, 0.10736565140993402], [0.1114765805150407, 0.11079109927694332, 0.10785997276820886, 0.10665024645728501, 0.11058373558644768, 0.10756336119235893, 0.1085284234848183, 0.10918234112698268, 0.11144312155429413, 0.10884971773300146], [0.11061028756648089, 0.11238034529259668, 0.11031047828256967, 0.11718303385964744, 0.10931152490312908, 0.10779387854094394, 0.10940022778162427, 0.11040414911375244, 0.11190874924599291, 0.11028053251306479], [0.11386162505832415, 0.1136421391441932, 0.11623888079424216, 0.11188427469815365, 0.11085208829500731, 0.11247729604933127, 0.11623771653825132, 0.11164086190644601, 0.1119160721491408, 0.10882470469531512]], 'Rp': [[0.68180100525841902, 0.61957682771001132, 0.68885275785191158, 0.67466472975794578, 0.66871772655147987, 0.65607522033871501, 0.66918015256433994, 0.62881200039059526, 0.66893961443696304, 0.74090320488767736], [0.65414958613128282, 0.63366481130888896, 0.64955646869247596, 0.65835892738810053, 0.66477961778215977, 0.67981294324894048, 0.67987432528827385, 0.66094798697651169, 0.67741154648893032, 0.70108234027379068], [0.66550780965800904, 0.64931723102600847, 0.62965126459685195, 0.64641986963096332, 0.67467233074675925, 0.67690295237945719, 0.65423525495886437, 0.64562055787016415, 0.65247116706442265, 0.6699915166142143], [0.65340790856227449, 0.63224146592953745, 0.64478710776874737, 0.66157573660739488, 0.64196642336366483, 0.63934993436946042, 0.63758037593883443, 0.66250823802606984, 0.65511748192666119, 0.63295703695107441], [0.64416772320135929, 0.64989973641915899, 0.63274733709737829, 0.65802394720973834, 0.6461092582494794, 0.64890090307148296, 0.64999552215545686, 0.64017978048333779, 0.66012120917523054, 0.64254171684253203], [0.62401793442444176, 0.64665305587331046, 0.63212046907233355, 0.6380268342893064, 0.65822851411605787, 0.64862865595033647, 0.64719299498295801, 0.64617216074010608, 0.65047287957602584, 0.64899684370906452], [0.63013295680648773, 0.62195351588708969, 0.65150218438751695, 0.62394017425792714, 0.64014924648072169, 0.62907990373545619, 0.61904847049185907, 0.65173263440728557, 0.6274793281829244, 0.62781067156902071], [0.63535496603138286, 0.64350204830780444, 0.62362527802739942, 0.61927224485532328, 0.62807198638555639, 0.63644314538787716, 0.6379188312289179, 0.63330997452408555, 0.62485968591540908, 0.61992738125985281], [0.63193234726591851, 0.61974047260947562, 0.62329153222290712, 0.62128624485701078, 0.63740177121983166, 0.61943463310715041, 0.62311646402969401, 0.62673929643465776, 0.63586041617147859, 0.63183129313434094], [0.62323262618518649, 0.62536349343497533, 0.60906355741926754, 0.61671817167107501, 0.61986240400722747, 0.61237751391236117, 0.61990786805523612, 0.63106616969917351, 0.62320240966267493, 0.62595151572485574], [0.61697244416472052, 0.59835564118612727, 0.61294981976814411, 0.61926102920544057, 0.61869250243094509, 0.60933565651117116, 0.60782085369991845, 0.60198456956749613, 0.60789955744132185, 0.62620240514618941], [0.59790095480070049, 0.60461758283736533, 0.60180281694910376, 0.60755368335887672, 0.59881815764278457, 0.61018393215404676, 0.61134997680982539, 0.60203633258128741, 0.60500246856706241, 0.60348818475894839], [0.59107818312016946, 0.5946658154277934, 0.59575422798748046, 0.59997700301336976, 0.57808888030936778, 0.59602272432343106, 0.58870111125896196, 0.5998421428734938, 0.58804782387308696, 0.58704305719629613], [0.57158503263975702, 0.57150166435997385, 0.5824398023164763, 0.5844724716862727, 0.57588476769885333, 0.58785893298246372, 0.57793472598276807, 0.5770517930018253, 0.56879387005067605, 0.57745518341241731], [0.57118411666069069, 0.56283519494777812, 0.56895679519630604, 0.55021731830698228, 0.57444942795192622, 0.57923633534821828, 0.57217247111641656, 0.56871436092724492, 0.56389640440964039, 0.57064221684680672], [0.56040920699808772, 0.56074449702300599, 0.55032425831865406, 0.56376145812756118, 0.5694679464989354, 0.5614129368043328, 0.54706436805627912, 0.56348631731749099, 0.56706120585820974, 0.56907985696246155]]} 
average_performances = {'R^2': [0.44405404715391567, 0.44120094171532276, 0.42745343373058703, 0.4118217878378503, 0.41413857127219666, 0.41009114368432015, 0.39317992857357664, 0.3902531560403408, 0.38640105373052547, 0.3781247310080967, 0.36653824603046314, 0.3551330556625837, 0.33499133015649285, 0.3146307980584305, 0.30138630733566557, 0.290976535378788], 'MSE': [0.089545676981874073, 0.089419055257473928, 0.091076386124122985, 0.094305574130203323, 0.092718349696469388, 0.093875498743762747, 0.096352509820993235, 0.096698782562545813, 0.097631198783956943, 0.098961337497352156, 0.10090709677402546, 0.10242466289213448, 0.10558493127957716, 0.10929285996953812, 0.1109583207099802, 0.11275756593284048], 'Rp': [0.66975232397480577, 0.66596385535793545, 0.65647899545457145, 0.64614917094437196, 0.64726871339051539, 0.64405103427339405, 0.63228290862062908, 0.6302285541923609, 0.62706344710524653, 0.6206745729772033, 0.61194744791214739, 0.60427540904600019, 0.59192209693834508, 0.57749782441314834, 0.56823046417120104, 0.56128120519650182]}

500 iterations
repeats=10 
fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.44179048561337186, 0.34746540805777026, 0.48131762823805946, 0.44388060779886385, 0.4261174843386485, 0.4528935998287017, 0.43686184117297777, 0.3214582894044855, 0.4696715059730475, 0.5599067778828846], [0.42705027468189916, 0.4071337780027453, 0.42310219079135913, 0.4346953296621011, 0.425249347569835, 0.4757420802266873, 0.45628759329510704, 0.4390563112094287, 0.4728415517398108, 0.48601998458349105], [0.4459865187635633, 0.427665713069757, 0.40620707732380223, 0.42329374951642695, 0.4592703722864131, 0.4611092018315882, 0.4285404662444694, 0.4169821776268712, 0.41543088478153045, 0.4617233126772313], [0.39969140649035684, 0.3753706016466737, 0.44688724443252936, 0.4202436667566417, 0.411415045713616, 0.4237400264526492, 0.4240368051392278, 0.4533302168658633, 0.41257269337285474, 0.4000085015532182], [0.42902519434401365, 0.42198702917311115, 0.41469039255060214, 0.39767193715140137, 0.41876361453549094, 0.4357816828826695, 0.41904248964457036, 0.4140216135373118, 0.4006120190791108, 0.4230024121146253], [0.4199450807996109, 0.39059156186264754, 0.42394063252026226, 0.3943527939521241, 0.4420227334652116, 0.41303608522082713, 0.42151894447813987, 0.4337585552363511, 0.4420365158271834, 0.4130374522187741], [0.4206464186829486, 0.435266129651126, 0.40308003225500555, 0.4135274802490142, 0.40908913490675947, 0.3906319661074876, 0.41309426109088543, 0.40113074710333674, 0.4112324505239182, 0.4175174785776762], [0.3876914614366789, 0.39718148184395696, 0.4164366844929469, 0.3936644118259027, 0.4026100460691736, 0.4155487219678884, 0.4202531815944399, 0.40401891070435003, 0.37817806477731186, 0.3968890321135581], [0.3913705733896494, 0.3746085307079531, 0.4075096948075214, 0.38760629013435033, 0.3937729799831452, 0.39869071539127277, 0.40506037182638477, 0.39135178289152184, 0.37604106949308724, 0.38889154531129033], [0.39216639094133976, 0.3787893701330064, 0.37098590704210976, 0.38772171093226726, 0.37136628460753285, 0.37778421810030427, 0.3844742146044857, 0.38380839021505586, 0.37623045630002805, 0.36002035559629353], [0.3696379397039965, 0.3720737118194265, 0.37694290540496944, 0.38453696990427577, 0.37289837005081594, 0.369528102091385, 0.36536201859955375, 0.3640792954342327, 0.3725808142662922, 0.36857774234799556], [0.35406854784619857, 0.35750059170646464, 0.36158432501053994, 0.3515205149802094, 0.3553207895258801, 0.36772455189854236, 0.3590177427330965, 0.38434712317324016, 0.33950427499832625, 0.36673991964150754], [0.3556086997142105, 0.3289906490587199, 0.3599980304667785, 0.3469090641315994, 0.34372697436111965, 0.3466957185216857, 0.337185503743497, 0.33783324774654744, 0.344894638218848, 0.34217805742764384], [0.3463028950326994, 0.34677513750802347, 0.32654541332037734, 0.3296804235847929, 0.31738107662791304, 0.34475680609760717, 0.3232888588963365, 0.33126935378030287, 0.3533895421790495, 0.3459711603666097], [0.31768675644234345, 0.2992089765929128, 0.3149629857428675, 0.3176506968798445, 0.303391150275954, 0.3015243446027519, 0.3210705351695562, 0.3089085949580064, 0.31794521856792657, 0.3293041023928325], [0.3109875544664219, 0.2988948706672837, 0.2954689722303411, 0.31666724297589266, 0.30051963905634993, 0.2615409790597578, 0.30228022677467425, 0.2900495534431915, 0.29975294078827397, 0.3273722944431241]], 'MSE': [[0.092595138284400455, 0.093449931223821434, 0.081252205434200905, 0.091370568617004488, 0.098875844641130209, 0.090246456138198941, 0.088811684818449699, 0.11536486270000379, 0.085089909210422393, 0.068193793958265428], [0.088910033067396671, 0.094404788855316848, 0.09179591665167848, 0.092743105912070828, 0.093040318606875699, 0.084169282642679366, 0.082554956604853055, 0.091031441985035169, 0.087072615336654599, 0.082769744781860041], [0.089603484150514778, 0.092622828642011684, 0.094271677207746443, 0.090496120679673053, 0.085127665947024214, 0.084868447616041051, 0.092669571064291606, 0.09041702835728814, 0.092413520999460583, 0.086840656381786424], [0.096527213621149577, 0.099623601073042578, 0.087353899273555982, 0.091445255234924958, 0.093094599847533724, 0.091599273963354572, 0.093122464722910483, 0.086898437260176875, 0.091186240359538137, 0.09598965895129305], [0.090340318371250006, 0.091965009262974962, 0.093524408604821335, 0.094740650643585916, 0.092166273822307757, 0.089754565570556374, 0.094046804520904526, 0.092570729991306597, 0.093615952017628137, 0.091051484164769894], [0.091714047915249092, 0.095806285415738865, 0.092258278790774792, 0.095403286068958426, 0.088776791319171072, 0.094778108862603627, 0.091935192503405122, 0.090545365945314107, 0.091096336744599354, 0.093919854407465475], [0.093172482513513219, 0.090213558551029957, 0.095103134554411203, 0.0936621795187524, 0.095081081861782865, 0.096133975754687948, 0.092033442901585549, 0.096585400910066968, 0.093677278375707856, 0.09324588878597477], [0.097816742950542712, 0.0963987484779711, 0.093679633183126221, 0.09571131907289504, 0.095124479772878925, 0.092697854181436723, 0.092184709441426635, 0.094476292587384283, 0.098269835870786096, 0.096092824475421584], [0.096908708386474557, 0.099452724873294707, 0.095104091923199074, 0.098114390558663903, 0.095318311161515221, 0.095810391863377489, 0.094380945773528277, 0.098341613453503743, 0.098017891891813674, 0.097196125413096329], [0.09708993222154097, 0.098355800294946283, 0.098450577217519486, 0.097652256433891568, 0.099465981043201077, 0.10004847866194012, 0.097209297252486504, 0.09732834900776012, 0.099511661712688118, 0.10194218385223468], [0.10015287115643927, 0.098642487579175805, 0.10054085306902383, 0.09768318896752988, 0.098994518033211645, 0.099433286813587721, 0.10143893965488973, 0.10055884114160749, 0.10050054031790508, 0.10018847314513848], [0.10338027230585818, 0.10131381744608302, 0.10235509103802666, 0.10303070959726877, 0.10206259619152874, 0.10004615221047471, 0.10206976480953742, 0.097938211489628293, 0.1046634525397183, 0.10110740885777084], [0.10263036490373817, 0.10609406538751937, 0.10187130000597654, 0.1035822771248726, 0.10512120289963189, 0.10449526334789831, 0.10497852312019539, 0.10519917856690202, 0.10448506072646195, 0.10530409247554409], [0.10432957432172674, 0.10433938371282704, 0.10667491030296587, 0.10624170429756524, 0.10840012881697578, 0.10414815201419211, 0.10773215009425531, 0.10603855976171127, 0.10282616455816473, 0.10416388971373093], [0.1082708776019385, 0.11211794735339124, 0.10848249492471333, 0.10856080942646079, 0.11130860705563339, 0.11056502993998479, 0.10739487595829295, 0.11028204100920298, 0.10841832886394849, 0.10657868461028856], [0.10956924533162855, 0.1118579767610431, 0.11183717932184446, 0.10873987579382251, 0.11102417325524007, 0.11733533276968984, 0.11123151806512034, 0.11302131500292432, 0.11132127561516364, 0.10671593132512154]], 'Rp': [[0.66788035189638162, 0.60030986174850642, 0.69503737924150522, 0.66766024066192931, 0.66186367285050429, 0.67603091499585277, 0.66222456880107594, 0.58520045376968277, 0.68743265331287873, 0.74836060083771183], [0.65478944252343507, 0.64131078694584909, 0.65251983753504461, 0.6603997363748404, 0.65442102880333208, 0.6904761699965678, 0.67835475670881784, 0.66398289874277294, 0.68828796957224858, 0.69739394288219136], [0.66887444281132136, 0.65602599702623066, 0.64112269006708589, 0.65240361615648379, 0.6779988919756248, 0.67998325814862415, 0.65740943379019823, 0.64918944965950587, 0.64872732362122998, 0.68061864567780406], [0.63755572416487405, 0.61865900125244422, 0.66977735761647073, 0.65061863268510478, 0.6438027311691692, 0.65265494660868595, 0.65315260362678929, 0.67427114312363623, 0.64481553780087852, 0.63672925363720145], [0.65743357913814626, 0.65123825789058376, 0.64619313387956756, 0.63565021617971906, 0.64930056981469053, 0.66182019391741242, 0.64950814142900193, 0.64717369285291559, 0.6368081877654731, 0.6519207794041858], [0.65007316484058586, 0.62918494782694145, 0.65219633943848365, 0.63405427248332402, 0.66636725638476768, 0.64529767534863747, 0.65110785641868585, 0.65990706966923152, 0.66557990916127141, 0.64569650911954257], [0.65017884436203843, 0.66009861253728863, 0.63822134432604494, 0.64448202061312931, 0.64295398720997232, 0.62884170359601754, 0.64596402579734591, 0.63724994174055261, 0.64369457815527187, 0.6479627568168872], [0.62715807326923068, 0.63341605099785181, 0.64672865018006875, 0.63229489393360383, 0.63751346524728636, 0.64581138550705686, 0.64992500010088261, 0.63914440010152684, 0.61970742942297685, 0.63384195138512744], [0.62958809266258875, 0.61801737327564543, 0.64044668639601543, 0.62590445534105099, 0.63021516384781984, 0.63392082224424462, 0.63873427456401177, 0.62871042542286537, 0.62044644786313974, 0.62869914181513342], [0.63011654416839091, 0.62145060777996375, 0.61630386822068584, 0.62657165948993909, 0.6151035761452972, 0.6203950173041396, 0.62455471480452085, 0.6242438967928341, 0.61976163740505474, 0.60664147748897124], [0.61423379987230065, 0.61712768134283191, 0.62041940256522077, 0.6250871781811882, 0.61599288715267309, 0.61488259280649304, 0.6125200611877063, 0.6108624266453706, 0.61735962936193156, 0.61437781097413957], [0.60132392999898221, 0.60676916370477718, 0.60741859359880879, 0.60184656854602481, 0.60609764686979184, 0.61337524510888708, 0.6051445054671335, 0.62288797109071503, 0.59261323540916822, 0.60910425715448846], [0.60309335200087388, 0.5860235697910493, 0.60736253954049724, 0.59586910988851838, 0.59679837761809951, 0.59715099450683529, 0.59114452197524325, 0.59192415510964302, 0.5978592154638771, 0.59368867146408866], [0.59691344684821601, 0.59844509271487778, 0.58751339117078616, 0.58790258465010059, 0.57911461003507103, 0.59515487658293331, 0.58225314397795092, 0.58671946362609928, 0.60119589783544602, 0.59709844971014692], [0.5779484746839999, 0.56333692913153133, 0.57704488406351118, 0.57474816801577877, 0.56288556804479606, 0.56919564786181176, 0.57839071638734563, 0.57279152372063769, 0.57837837001063297, 0.58531893821505587], [0.57309865436144225, 0.56567718633944186, 0.56625638942776813, 0.57731957743239271, 0.56563988328059045, 0.54208568647766542, 0.56641659999317906, 0.55355254424297096, 0.56943973362327149, 0.57766725000638464]]} 
average_performances = {'R^2': [0.43813636283088114, 0.4447178441762465, 0.4346209474121654, 0.4167296208423631, 0.41745983850129076, 0.41942403555811325, 0.41152160991481573, 0.4012471996826207, 0.39149035539361765, 0.37833472984724237, 0.3716217869622943, 0.35973283815140056, 0.34440205833906495, 0.3365360667393712, 0.3131653361624995, 0.30035342739053106], 'MSE': [0.090525039502589763, 0.088849220444442073, 0.089933100104583802, 0.092684064430748003, 0.092377619697010555, 0.092623354797328, 0.093890842372751263, 0.095245244001386925, 0.09686451952984669, 0.098705451769820887, 0.099813399987850895, 0.10179674764858951, 0.10437613285587403, 0.10548946175941151, 0.10919796967438551, 0.11126538232415986], 'Rp': [0.66520006981160296, 0.66819365700851008, 0.66123537489341078, 0.64820369316852555, 0.64870467522716957, 0.64994650006914723, 0.64396478151545489, 0.63655413001456129, 0.62946828834325153, 0.62051429995997975, 0.61628634700898555, 0.60665811169487771, 0.59609145073587255, 0.59123109571516286, 0.57400392201351003, 0.56571535051851063]}
'''