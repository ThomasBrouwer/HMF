"""
Plot the performances of the many different algorithms in a single graph, as we 
vary the fraction of missing values on the CTRP dataset.

We plot the average performance across all 10 attempts for different fractions.

We have the following methods:
- Non-probabilistic NMF
- Bayesian NMF
- Non-probabilistic NMTF
- Bayesian NMTF
- HMF D-MF
- HMF D-MTF
"""

import matplotlib.pyplot as plt, numpy
metrics = ['MSE']

MSE_max, MSE_min = 0.13, 0.075
fraction_min, fraction_max = 0.25, 0.95

fractions_unknown = [0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]

np_nmf_all = {'R^2': [[0.40910052374279404, 0.35518063968665603, 0.4686793129653376, 0.4393414112764209, 0.38251912379572095, 0.4598033960502821, 0.44334112553808325, 0.31575325349258365, 0.32376810471832984, 0.43495486108472525], [0.3543986105405853, 0.3790020142559063, 0.39477881499777434, 0.42013413772960784, 0.41594077100518934, 0.41429581470583476, 0.4307775761629682, 0.3942632521993852, 0.45409466900520434, 0.44720119683374127], [0.4127250290274379, 0.40416075951674113, 0.36980350140923257, 0.40049902579448826, 0.4139963786758305, 0.430496597388229, 0.3783455276958, 0.3951636892354451, 0.3689790975945141, 0.4214692372214668], [0.3922440460418496, 0.2910067731504383, 0.42036534455078756, 0.342078473010053, 0.3553777520235559, 0.38739044522662214, 0.377930565920481, 0.41148792922342303, 0.38310793989083847, 0.34740889364530414], [0.38156797354241945, 0.3859727331384495, 0.3540849801708852, 0.3326402921775321, 0.35501629679290636, 0.3996594843554212, 0.3809525615952577, 0.40292705623126845, 0.3713826801813629, 0.3662942143617859], [0.35788577881575157, 0.3545117352972038, 0.37872829305603184, 0.3233766334681665, 0.3994647868841774, 0.3711742350027697, 0.3361289100149071, 0.39335924295796676, 0.3845512803236364, 0.3231809018230447], [0.3411178703759222, 0.3679640435865563, 0.3460910071553812, 0.3809415381774579, 0.3672832644471624, 0.35642220987503026, 0.37484305485535274, 0.33973651406297367, 0.36471836896248666, 0.3741289497832446], [0.3243558432441491, 0.35132027419486844, 0.37060655752463634, 0.33074616044773775, 0.3456986049306341, 0.3682473157854794, 0.36709578066616944, 0.2963518466226287, 0.2932360711246065, 0.3339675558181716], [0.3062507405122401, 0.32686849144449803, 0.3581712994191586, 0.3403530560198933, 0.3215314863610258, 0.29879521526713104, 0.33837997118664065, 0.3352161842397512, 0.269319898719509, 0.002574276080036464], [0.3140431109650058, 0.26661478686635653, 0.2893194871187945, 0.3093693406958036, 0.2868972418659754, 0.2864919540951312, 0.22983027464898498, 0.2558340991651171, -0.017238883421321516, 0.31517798565910593], [0.2743512861790267, 0.2748610069566235, 0.29816601649212615, 0.26251032993988554, 0.2656682955727244, 0.18300628875101188, 0.2514031239925377, 0.2987174684972195, -2697.349999039004, 0.2898668661945413], [0.0731089617928723, 0.022467711904366694, 0.24849441309296338, 0.24584119838315477, 0.20812196742214206, 0.05129985435007356, -0.03226266773959785, 0.09518929337875504, 0.18395438621287352, -0.969831389604261], [0.15380714667583661, -0.30559832735200887, 0.1727670112689873, 0.14192184345260528, -0.1259421105544436, 0.13733866379422255, -0.19509322639278093, -0.024060381991551028, -1466.130621886647, -0.04513455518465137], [-0.07965462377587462, -2498066.7334870696, 0.003999599219638217, -0.05145894423688824, 0.009417515796176668, -0.04748687554091546, -0.265332076734492, -13.894119744741673, -0.6529570288538076, -0.08694700631141772], [-698904.8520928668, -0.7110508601313961, -0.15558957578799726, -38953.14735768874, -478.2151869399507, -65.9903594485196, -0.14636794967929911, -6.730612076835128, -3.941768592681374, -0.8184798637957209], [-0.22998983119788075, -0.7571614793980153, -186643.10126030404, -0.28224478488368265, -0.3892265446608527, -0.2838681864105672, -0.4728708379566795, -1151948.0057564627, -0.33186243626972645, -8817631757.968481]], 'MSE': [[0.098017710744928974, 0.092345027554348161, 0.083232012431290664, 0.092116359850211355, 0.10638752970907939, 0.089106669395730739, 0.087789846479379499, 0.11633482618846425, 0.10849975293197209, 0.087555476530501108], [0.10018407959498569, 0.098884337728418759, 0.096302729127199199, 0.095131995012870244, 0.094547185846937457, 0.094034442318661121, 0.086428288041403914, 0.09830057939416896, 0.090169103905696907, 0.089021001753756657], [0.094983038022998068, 0.096426716221168329, 0.10005117714243565, 0.094073044056297919, 0.09225520105262934, 0.089689543514174908, 0.10080933101253246, 0.093800737753290384, 0.09975700374412369, 0.093334882152564455], [0.097724719305224389, 0.11307898504513893, 0.091542541367763464, 0.10377429018079039, 0.10195783937586965, 0.097377213438622462, 0.10057698034728417, 0.093549672648884433, 0.095760049004172759, 0.10440480889445553], [0.097849056749478622, 0.097695079755491854, 0.10320831824670154, 0.10496952878701674, 0.1022746443397613, 0.095500802688186753, 0.10021289404314414, 0.094323407722221878, 0.09818116265724508, 0.10000016207628146], [0.10152641155071428, 0.10147846509911268, 0.099499221052200368, 0.10658365456584874, 0.095547959553426251, 0.10153761638471381, 0.10550581712682987, 0.097005455626160725, 0.10048170786621879, 0.10829779753624837], [0.10596237890047705, 0.1009647477404471, 0.10418280220675828, 0.098866294380587139, 0.10180789571186298, 0.10153091109311914, 0.098031663691755436, 0.10648703901068381, 0.10107801330190748, 0.10019167991576432], [0.10793465490860323, 0.10373256933434381, 0.10103676028320273, 0.10564309439767618, 0.10418668645346743, 0.10020017134230867, 0.10063719146230431, 0.11154392313960693, 0.11169367202381499, 0.10611801502795919], [0.11046187013246961, 0.10704457289719461, 0.10302368697688294, 0.10568504680868146, 0.10667698858842097, 0.11172737045869383, 0.1049590935029989, 0.10741165619480954, 0.11478275199399068, 0.15863946081674832], [0.10956864982581006, 0.11611631561694859, 0.11123265359824214, 0.11014867495329451, 0.11283115061388455, 0.1147277143756915, 0.12163204132610868, 0.11754207192371509, 0.16228290186720717, 0.10908511278830418], [0.11529215782120664, 0.11391387088079276, 0.11325284316131055, 0.11705064200343415, 0.1159219011473079, 0.1288501046358978, 0.11965384290992349, 0.11089457879646569, 432.22400436019888, 0.1126776155631697], [0.14834739446144268, 0.15414415407294207, 0.12048642565789962, 0.1198210865178535, 0.12536642497358869, 0.15011463668056549, 0.16437710486262899, 0.14393751037094113, 0.12931219406247899, 0.3145067151190718], [0.1347707228155908, 0.20642966318965869, 0.13167350099144218, 0.13609389523697496, 0.18035236011964662, 0.13798168183268639, 0.18928240496585633, 0.16269362758217129, 233.99782853966042, 0.167305069542349], [0.17231207918330238, 399015.50408017577, 0.1577660253808737, 0.16665004896925661, 0.15730485226089055, 0.16649363680831666, 0.20144037378712829, 2.3617147136576895, 0.2628587728526367, 0.17311259263973325], [110903.82706433718, 0.27374709984512419, 0.18299922147479461, 6197.5497715480897, 76.572060431505051, 10.604222267279175, 0.18133554387585388, 1.2336250630001209, 0.78553557138902597, 0.28897029572583066], [0.19559742127090676, 0.28034672648162501, 29627.864493198209, 0.20404574083751892, 0.22050330101781138, 0.2039965612351731, 0.23480724713080361, 183385.74484788184, 0.21173187862633547, 1398963761.7755308]], 'Rp': [[0.6460887411923949, 0.60350183189859452, 0.68525578884937566, 0.66576644394297269, 0.63157466431652187, 0.68135467442537589, 0.67142202759439262, 0.57597492568757291, 0.58428759878490999, 0.67072331385434059], [0.60625945296754946, 0.62029920745417066, 0.63286730300959027, 0.65052685251951636, 0.64823603545801178, 0.64951147470308845, 0.66112207292451353, 0.63326734483477976, 0.67479464929232025, 0.6692521143981599], [0.64835655098554978, 0.64084219456878877, 0.61722642991190657, 0.63637881669478324, 0.647354295081632, 0.65857398055693828, 0.62611872636874955, 0.63429765611035915, 0.61888848481548686, 0.65382069642111584], [0.63392587184053117, 0.56565379323957432, 0.65300603090099441, 0.5973774697481764, 0.60782468917040833, 0.62867034716835146, 0.62315211819213268, 0.64542305220818708, 0.62537388666763949, 0.60346223995414805], [0.62774747400020314, 0.62663721055455956, 0.60592200073113189, 0.59386940910612229, 0.610048172052849, 0.63801691428894025, 0.62341278678844914, 0.64083516692140019, 0.61788961007185239, 0.61431087074889568], [0.61176142774660747, 0.60687399990872093, 0.62470812686998478, 0.59067833640275202, 0.63869361746544584, 0.61809176362458307, 0.59772015188830996, 0.63337977692969816, 0.62726593907220152, 0.58586215245484519], [0.60203296644595461, 0.61805855637360951, 0.60053887560031183, 0.62585750333300383, 0.61675411407144709, 0.61056944614062436, 0.62400651709737054, 0.59787973286131002, 0.6170938885910987, 0.62214449115125259], [0.59216736210849219, 0.60867910057355212, 0.61849907913216962, 0.59850305525716962, 0.6024479149588452, 0.61687589663418518, 0.61663832778536032, 0.57807025228348996, 0.56925804484656617, 0.59457482907833814], [0.58353622960904428, 0.58821622238450233, 0.60989193722292534, 0.59935893778640037, 0.58900791354284121, 0.57668789517605878, 0.59977724855112791, 0.59733044264939972, 0.56671302221766617, 0.13818216862378688], [0.58743819523414564, 0.55871727454596087, 0.57382910742330351, 0.58681029999712664, 0.57065927199320177, 0.57206236245769593, 0.54952792958711516, 0.55498024292985204, 0.4578659236961955, 0.58586427287141518], [0.56349614379922308, 0.57758519910653128, 0.57835426367067355, 0.55967679931389047, 0.5607016635401838, 0.53266066987121108, 0.55082283261538956, 0.57822440167241518, -0.0071375911594636727, 0.58077865403558271], [0.49231915464041975, 0.47713065075967731, 0.55041365696450462, 0.55456824572011398, 0.53105327984738304, 0.48029728198511129, 0.47446658018923155, 0.48716878825832072, 0.52035919815600895, 0.33124092879600292], [0.51128731965464247, 0.39726578069516194, 0.51432628172778183, 0.51031800344010692, 0.4276479500132781, 0.51866739202007794, 0.42816715673001621, 0.11994638897281641, -0.0039379711931879771, 0.10580092118146546], [0.45158500896285225, 0.016471274210462464, 0.46720376037304934, 0.10678946444282525, 0.47581122848108459, 0.11420532880436292, 0.42217449787587674, 0.12365207726699656, 0.35771941800121937, 0.086475302964942574], [0.0070173182614290831, 0.34722420734205772, 0.072291531393121805, 0.0051712913090783174, 0.030187609652587537, 0.045751631535116251, 0.084528063748147045, 0.16251656914508655, 0.21123847214064501, 0.34444858544873325], [0.080301299221851377, 0.053994446978643529, -0.0090309934356583455, 0.066760539111871187, 0.050090809159141922, 0.061909028370914998, 0.055096358615357839, 0.015556015643312941, 0.061288584098040506, 0.0037076502877853067]]} 
np_nmf_avr = {'R^2': [0.40324417523509337, 0.41048868574361974, 0.3995638843559185, 0.37083981626833534, 0.37304982725472885, 0.36223617976436556, 0.36132468212815677, 0.3381626010359081, 0.2897460619249884, 0.2536339397658954, -269.49514483564286, 0.012638372919334251, -146.62206158229307, -249808.17980262544, -73841.47088658628, -881897035.1822722], 'MSE': [0.096138521181590636, 0.094300374272409893, 0.09551806746722151, 0.099974709960820626, 0.099421505706552935, 0.10174641063614738, 0.10191034259533627, 0.10527267383732875, 0.1130412498370891, 0.11851672868892067, 43.327151191711835, 0.1570413646779413, 23.54444114659368, 39901.93237332713, 11719.149933137936, 139917677.69359007], 'Rp': [0.64159500105464518, 0.64461365075616994, 0.63818578315153096, 0.61838694990901433, 0.61986896152644033, 0.61350352923631479, 0.61349360916659834, 0.59957138626581685, 0.54487020177637535, 0.55977548807360122, 0.50751630364656364, 0.48990177653167744, 0.35294892232421593, 0.2622087361383672, 0.13103752799760024, 0.043967373805126123]}

bnmf_all = {'R^2': [[0.40782149920348054, 0.3653120142973486, 0.49934841033677646, 0.45435635423440257, 0.4327143347966125, 0.4294260743940749, 0.4491906480122979, 0.3382706775616051, 0.36107141122674447, 0.48157576924943146], [0.38606824760635006, 0.37979288555123036, 0.3944617668173269, 0.422362269764444, 0.4310007472222208, 0.4527801029904158, 0.4475401170771387, 0.4225353893646312, 0.4508746341867641, 0.4637126138280966], [0.42880241254517937, 0.4089208005163698, 0.36535622978169613, 0.4108171428708386, 0.4496412492163069, 0.4324078110644658, 0.3947735047164893, 0.40377987913150515, 0.3853355878043945, 0.4490511759995456], [0.3934087422386793, 0.35573178512470505, 0.44537304274757195, 0.3901054313613992, 0.38444212896291297, 0.40362699750528874, 0.4001597233970928, 0.42769366022269395, 0.41003465146923, 0.3702533305490556], [0.409486584423831, 0.39507337404827214, 0.3927325129140281, 0.37480540755503533, 0.4045812085450067, 0.4265735873001443, 0.4125524077825258, 0.40014689386353297, 0.40012632565239403, 0.3929501509337592], [0.40724033514998337, 0.38567820847495626, 0.40322680534465205, 0.38234413368367504, 0.4084864764660041, 0.39985078590518297, 0.4031811018726136, 0.4047056073811316, 0.41705452414652133, 0.39167783935658607], [0.3926242280031701, 0.41331214983484776, 0.3854637701969227, 0.4020156985736574, 0.4105722299893425, 0.3812537704341662, 0.3887629342306661, 0.3961923554284813, 0.3983225835479377, 0.393620546755613], [0.37121248604994095, 0.3786820926735275, 0.39299005531740816, 0.3793111719157092, 0.39884462692333045, 0.38964987531995876, 0.38315397233753334, 0.3826683958790609, 0.3583518221298553, 0.37797033142638403], [0.36366858569785876, 0.35643553871537625, 0.3955036817084451, 0.3616728333701622, 0.38005122228606725, 0.37605383704388673, 0.3937782493391865, 0.36456938743497624, 0.3579222018488092, 0.37844534849949785], [0.3629894976399378, 0.3431107092410439, 0.34566006396184124, 0.3626405152461266, 0.352678527165486, 0.3654892267916292, 0.34880061199998513, 0.3451325417079405, 0.3357788683343115, 0.33872641033989326], [0.33306418054018494, 0.3463778818635176, 0.33100311092699897, 0.34682399424163424, 0.340737342526633, 0.32049414308167234, 0.33318143473763984, 0.347915402066153, 0.3043032349048279, 0.3388472572855752], [0.3475982934830978, 0.32894970562084347, 0.30295887281899847, 0.3130982441717667, 0.3264327153732155, 0.3269143895719716, 0.3354838072506465, 0.3476816779897943, 0.29401067636856304, 0.3120994337872328], [0.27806604901656373, 0.296385361355452, 0.28341069427180243, 0.3048494197466115, 0.28805162042460153, 0.3077771513238543, 0.28466332417876405, 0.27746783673034714, 0.31100145295781034, 0.29248807529722454], [0.23145412333267057, 0.2536783712489342, 0.2860408706558111, 0.2491683135199364, 0.26273879293376023, 0.28365156099189814, 0.25316814886238737, 0.24393780832803424, 0.24402210275663472, 0.267684994423803], [0.21438355049235558, 0.2604381101939731, 0.22530599455393263, 0.1778543728212385, 0.1881804300696942, 0.22741791872227235, 0.18845396782090706, 0.18996485943048513, 0.1623666495010334, 0.20764109190660263], [0.16993940191500223, -0.03375256413449934, 0.13512571282579822, 0.0714635269107794, 0.10763664486276525, 0.12947784398485074, 0.05337446786201494, 0.13462174147976413, 0.08820476691064993, 0.19282574399745844]], 'MSE': [[0.098229873832505532, 0.090894106373673303, 0.0784276621472417, 0.089649400605376253, 0.097739254584451568, 0.094117478308922975, 0.086867326955217816, 0.11250644026094248, 0.10251452867983481, 0.08033142388493425], [0.095269602190905772, 0.098758403689884283, 0.096353177799186424, 0.094766450738896058, 0.092109285203379965, 0.087855813792976897, 0.083883135823629495, 0.09371250136498209, 0.090700968384094291, 0.086362054460830923], [0.092382759098379466, 0.095656382393708342, 0.10075723432047802, 0.092453936291564245, 0.086643589488223177, 0.089388551665147142, 0.098145321587479128, 0.092464500238298525, 0.097171234478972995, 0.088885063454890959], [0.0975374408291029, 0.1027558417711094, 0.087593039340633089, 0.096198974116494029, 0.097360819827064085, 0.094796335937728834, 0.096982941784739943, 0.090973615325171148, 0.091580220170240742, 0.10075004093023922], [0.093431740660352661, 0.096247118260140735, 0.097032975149927925, 0.098337344912943048, 0.094415168672435698, 0.091219368455659866, 0.095097434643288098, 0.09476260764123122, 0.093691810483226584, 0.095793796854591315], [0.093722829519699985, 0.096578723254716475, 0.0955756834720876, 0.097294924698601862, 0.094112566569898262, 0.096907162629723695, 0.094849537016407914, 0.095191104648596411, 0.095175040801848187, 0.097337605229557506], [0.097679051826792707, 0.093720602749318302, 0.097909811883676465, 0.095500660480001456, 0.094842443019131639, 0.097613481054174708, 0.09584886952438873, 0.097381862804645405, 0.095731333840514701, 0.097071395243344544], [0.10044927148472738, 0.099357048380720112, 0.097443529168665957, 0.097977007499515809, 0.09572406055762149, 0.096805583260446915, 0.098083801454144137, 0.097860825287757719, 0.10140308270647741, 0.099107114516948314], [0.10131954317292358, 0.10234268046352413, 0.097031247462115028, 0.10226930799904062, 0.097475811118901842, 0.099417268125795308, 0.096170736435050364, 0.10266894721923639, 0.10086419013858465, 0.098857581489540339], [0.1017503895421806, 0.10400477517844485, 0.10241446912023983, 0.10165245601069002, 0.10242286369514425, 0.10202543779955488, 0.10284318931993203, 0.10343725477975781, 0.105965014201667, 0.10533409061247227], [0.10596376495851838, 0.10267910881159258, 0.10795401980237575, 0.10366880231559517, 0.10407147090202708, 0.10716655411065791, 0.10658260328690934, 0.10311485539583831, 0.11143730121628503, 0.10490584233536092], [0.10441582593266355, 0.10581592160908174, 0.11175431748451042, 0.10913525710752882, 0.10663602092601954, 0.10650362216936375, 0.10581729952286766, 0.10377095955254062, 0.1118724577169057, 0.1098314041241832], [0.1149803617661618, 0.11124932517744159, 0.11406196796261943, 0.11025306904861364, 0.11403922931397675, 0.11072024310657644, 0.11329714148611843, 0.11478949948100162, 0.10989080417906369, 0.11325846148444084], [0.1226593533153733, 0.11920969832405295, 0.11309081204462373, 0.1190023994806419, 0.11707734298214946, 0.11386057392922518, 0.11889533982063216, 0.11988645405797572, 0.12021814173288027, 0.11663213432500576], [0.12466324411820391, 0.11832080928022928, 0.12268058041381057, 0.13080220694126657, 0.12971771108742275, 0.12229568817110167, 0.12837251875949271, 0.12926268209883834, 0.13314884747399477, 0.12591186328278559], [0.13199923151063192, 0.16493028713922098, 0.13729005101699673, 0.14775955011065534, 0.14163929293701077, 0.1383191266718794, 0.15091244224335029, 0.13776481052621106, 0.14495199531661551, 0.1280624508317843]], 'Rp': [[0.64047248427964398, 0.60862708702244239, 0.70806365491494649, 0.67429787709274003, 0.66287655182560656, 0.65930531986848695, 0.6722514776352827, 0.59297498378995783, 0.60639697628695455, 0.69575851922926635], [0.62397566743231758, 0.61907457587281811, 0.62962658784136361, 0.65044075081856689, 0.65694018896134831, 0.67339133933446327, 0.67324923061697184, 0.65052998405280094, 0.67166241983865871, 0.68112894903287113], [0.65582189477365027, 0.64128780591663692, 0.6103582922556483, 0.64150597453986424, 0.67061024992566032, 0.65847277428854922, 0.63293784562650957, 0.63716621525424977, 0.62531493941214378, 0.67039181914750445], [0.63009234035330131, 0.60135702562663695, 0.66751825663989328, 0.62697249691830281, 0.62330557569417033, 0.63698628108195088, 0.63467370863236106, 0.6542668053043329, 0.6421340171677582, 0.61410170567640299], [0.64166926230280408, 0.62974652802416931, 0.62852654407216568, 0.6171799692853166, 0.63831810725294702, 0.65363071828112462, 0.64299305753137503, 0.63493362458572666, 0.63399882542908892, 0.62917490615996485], [0.63987770741336314, 0.62304507815578825, 0.636917795639666, 0.62382144869327483, 0.64229386979127379, 0.63415949277150707, 0.63693802352841278, 0.63759882276808477, 0.64640359987929186, 0.62812908444049131], [0.62878993404804739, 0.64429943878640306, 0.62432001589029484, 0.63536954599153128, 0.64198765189243112, 0.6212413877158538, 0.62754881764092296, 0.63099093366842818, 0.6335269502116222, 0.62994402337793398], [0.61384688589290937, 0.6205372619368138, 0.6285251060293281, 0.62107434315703902, 0.63346355311329705, 0.62612759194678524, 0.62257717661882817, 0.62358362267019429, 0.60380319350837675, 0.61844392271297655], [0.60960970697617045, 0.60122327780333329, 0.63100575640279322, 0.60771074613117915, 0.62022762659243003, 0.61689382889900535, 0.62970342916815092, 0.60931334941078874, 0.60722481954621266, 0.61879712735566161], [0.60878725417285695, 0.59847273881832264, 0.59836813494209573, 0.60781149312794791, 0.60073252168561031, 0.61095123350844993, 0.60053367273829672, 0.59601211170979751, 0.5893017714937695, 0.59156326878106702], [0.58860285407538859, 0.60238255183975642, 0.58624133224481667, 0.59596187395706057, 0.59242933354329086, 0.58025617789045991, 0.58812429494414464, 0.5997970979589079, 0.56878555133841724, 0.59400492389503334], [0.59665952714312032, 0.58756696831218647, 0.56880916324306141, 0.57457378833949602, 0.58440505734705162, 0.58627160768197084, 0.59104309726545845, 0.596595126473492, 0.56295489782000085, 0.57087978118017912], [0.55100017482390262, 0.56777606401232161, 0.55634068802470638, 0.56786331213053498, 0.55647651946798593, 0.57223228813962501, 0.56212556531780145, 0.55998943505895526, 0.5695432272718185, 0.56359900139496255], [0.53504724979487328, 0.54131421363272281, 0.56440931697537411, 0.54056044083128674, 0.5467651754210503, 0.55908868216546526, 0.54664955515360891, 0.5426831853360693, 0.54852048462625436, 0.54349650719693876], [0.53105809586595232, 0.53823971923504277, 0.52775992376692149, 0.51144194783768715, 0.5079256199353327, 0.54176400202222186, 0.51178883300621592, 0.51592645755208644, 0.50984750976651516, 0.5288570761476038], [0.50281960343983867, 0.43675375804309235, 0.50184768932772394, 0.47091016432299254, 0.50337051654263398, 0.49266395193050039, 0.4645180421671562, 0.48817343214388609, 0.48750907000076238, 0.51209914082676022]]} 
bnmf_avr = {'R^2': [0.4219087193312774, 0.42511287744086185, 0.41288857936467915, 0.398082949357863, 0.400902845301853, 0.4003445817781307, 0.3962140266994805, 0.38128348299727083, 0.3728100885944266, 0.3501006972428195, 0.33427479821748374, 0.323522781643613, 0.29241609853030315, 0.257554508705387, 0.20420069455124948, 0.10489172866145839], 'MSE': [0.093127749563310075, 0.091977139344876613, 0.093394857301714207, 0.095652927003252328, 0.095002936573379729, 0.095674517784113788, 0.096329951242598869, 0.098421132431702529, 0.099841731362471223, 0.10318499402600836, 0.10575443231351604, 0.1075553086145665, 0.11265401030060143, 0.11805322500125606, 0.12651761516271462, 0.14236292383043564], 'Rp': [0.65210249319453273, 0.65300196938021804, 0.64438678111404157, 0.6331408213095111, 0.6350171542924683, 0.63491849230811537, 0.63180186992234699, 0.62119826575865489, 0.61517096682857253, 0.60025342009782146, 0.58965859916872765, 0.58197590148060174, 0.56269462756426136, 0.5468534811133644, 0.52246091851355803, 0.4860665368745346]}

np_nmtf_all = {'R^2': [[0.409102042727287, 0.35524471904624544, 0.4686013687222099, 0.4393369917901906, 0.3820908666623054, 0.4590424858299418, 0.443256434097969, 0.31587870796576134, 0.3243142425805057, 0.4350164087809526], [0.3545312839337411, 0.37903462135464483, 0.3948336713190106, 0.4202634407007363, 0.4159716904530002, 0.41432095931532475, 0.4311983669550433, 0.4093199214934139, 0.4540337906837829, 0.4469645348407638], [0.41184787143095736, 0.40433642620123733, 0.3636821241434829, 0.4002559217833104, 0.41923909835671425, 0.43021287288464993, 0.3783231970687043, 0.3953699094340759, 0.3682666529319244, 0.4278018282863837], [0.39692124574654397, 0.3321584347986458, 0.4203296589692439, 0.3734796445050286, 0.38135912119881876, 0.3873928924890828, 0.37508958395697645, 0.4114564246180116, 0.3833925504133927, 0.35565290848581177], [0.4034402568548797, 0.38653545136872447, 0.3786309095218259, 0.33869984741578973, 0.35529679334046504, 0.3993183686632421, 0.38130013161978393, 0.4029355360092136, 0.3719764196033494, 0.36607134529602225], [0.372765483990646, 0.35724870121630126, 0.37606528681183027, 0.36746287162235336, 0.39946701486226843, 0.37114102882879907, 0.3883444134268046, 0.38907902609238365, 0.38456088492684526, 0.3875107821647187], [0.36671312432723024, 0.38834088563608915, 0.3472759753633603, 0.38394129408682653, 0.3806223061393148, 0.3580029936817106, 0.34145742075694796, 0.3888884265598259, 0.3644398598616203, 0.37398403004338454], [0.3420583357827879, 0.35547879089180356, 0.34723873743330835, 0.31910423335058247, 0.3834798701199733, 0.35033565080395934, 0.3645101178041742, 0.3470611963761455, 0.31621997027788673, 0.33554220984545224], [0.3063086773187026, 0.3206233188116362, 0.3582104801997782, 0.35643657252671535, 0.3595556486472795, 0.34569322212894926, 0.37032209267487814, 0.33308845309969703, 0.31715821628782115, -0.009222925028883111], [0.2746228273836754, 0.2766541850819967, 0.26333176589625007, 0.2905281739347392, 0.30211411650915254, 0.3112180881636605, 0.32623038477734, 0.3052215242427334, -0.004398284459765867, 0.30128360562063283], [0.25596332855473225, 0.2902557003912557, 0.2982998490683465, 0.2983108095900525, 0.29222066064633145, 0.1971836204965436, 0.28265975606568006, 0.29814733984556463, 0.11688029036943204, 0.25966160083395196], [0.24554518739460773, -9.028210141113982, 0.20148863418923635, 0.18057329326410965, 0.18493469575039578, 0.19730349418453996, 0.13573893716203078, 0.28773764716303085, 0.11009253259800467, 0.25202497507958543], [0.12888309181847435, 0.17106642364257085, 0.14354407406915182, 0.21948972549172985, -2.866085001683973, -0.02711949273391312, 0.1165881558040609, -0.04548225265333716, -0.2978239275967818, -0.05692985164069331], [-0.029325053052584815, -0.03014305933929351, -0.09202319692929417, -0.07735421568907008, -0.031192135514548358, -0.05831166817793898, -23.280991294906233, -0.20375738479214722, -0.8924120726325806, -0.09055079384910258], [-112198.06659312532, -1.6426854499663617, -0.13769121968524334, -231.09764170933107, -41389.41294991291, -451.0318363592854, -0.3411953930905989, -1.483810411252437, -277075.13510746026, -8.663594340910661], [-0.2317213795239481, -0.3822814408184816, -112517.5427750996, -0.21150733824361811, -0.37397816175571763, -0.2484553000552978, -0.3605895972093711, -5232334.253380354, -0.32064953424051956, -1990273830.8017478]], 'MSE': [[0.098017458777566263, 0.092335850704844014, 0.08324422248892864, 0.092117085973010743, 0.10646131534400373, 0.089232183282615535, 0.087803203040941413, 0.11631349656664845, 0.10841212644832598, 0.087545939526284269], [0.10016349140853337, 0.098879145551571124, 0.096294000395330842, 0.09511078174544943, 0.094542180623779698, 0.094030405367261274, 0.086364396974819624, 0.095857142834106387, 0.090179159392203792, 0.0890591130658131], [0.095124905286982961, 0.096398287476660516, 0.10102301846897548, 0.094111191674630154, 0.091429833869522886, 0.089734226515352941, 0.10081295221318154, 0.093768756196583342, 0.099869632889374699, 0.092313239607705252], [0.096972644355898252, 0.1065156104515934, 0.091548177243386125, 0.098821367759107479, 0.097848449305247359, 0.097376824434570672, 0.10103631393845025, 0.093554680609926402, 0.095715868961424158, 0.10308588991813954], [0.094388397858087267, 0.097605548222686203, 0.099286217025424534, 0.1040164166189264, 0.10223016618551112, 0.095555066596025251, 0.10015662856835246, 0.094322068117805261, 0.098088428930495589, 0.1000353313033948], [0.099173741228986326, 0.10104818136556337, 0.099925712463274877, 0.099639063806858857, 0.095547605071697503, 0.10154297824477412, 0.097207460055301537, 0.09768988769308809, 0.10048013976329981, 0.098004375888515544], [0.10184611306884822, 0.09770964382364998, 0.10399400940870218, 0.09838722048192429, 0.099661564361382321, 0.10128152644592311, 0.10326690786442244, 0.09855983762065991, 0.10112232616289181, 0.10021487918689934], [0.10510666860238768, 0.1030675668617331, 0.10478800501753427, 0.10748079652295417, 0.098170644213973673, 0.10304108036417667, 0.10104833400259813, 0.10350536042297573, 0.1080614038944273, 0.10586712761070122], [0.11045264517416686, 0.10803770994197288, 0.10301739784011731, 0.10310823324138789, 0.10069837197651819, 0.10425481593466718, 0.09989181021355388, 0.10775544182898464, 0.10726781661853632, 0.16051579263593438], [0.1158652951643141, 0.11452678543426262, 0.1153001398176626, 0.11315365239723854, 0.11042345066439951, 0.11075190378278965, 0.10640768000285683, 0.10974125726116808, 0.16023440598766928, 0.11129834481338612], [0.11821366415347426, 0.11149548056254217, 0.11323124700022301, 0.11136857037964942, 0.11173033401118579, 0.12661416248148763, 0.11465786140927965, 0.11098473386784552, 0.1414588683313438, 0.11747031867229739], [0.12074925862417867, 1.5813185793372866, 0.12802270800103563, 0.13019088037206802, 0.12903732533297249, 0.12701220178763503, 0.13762459478060074, 0.11330687076099967, 0.14101648875764278, 0.11942299697340379], [0.1387403059613555, 0.13106364751639865, 0.13632501574336003, 0.12379138510845432, 0.61926590003239568, 0.16428657353985615, 0.13991738447839955, 0.16609694432877189, 0.20699450775141942, 0.16919325980843589], [0.16427951693167864, 0.16454439829106829, 0.1729759940540847, 0.1707542969565238, 0.16375367939206509, 0.16821419210682889, 3.8655243570453224, 0.1908761025196809, 0.30093771735170122, 0.17368654978791884], [17803.980093974977, 0.42279717955060941, 0.18016483693108748, 36.926406658175715, 6613.6242925097949, 71.554266973651224, 0.2121538691987257, 0.39635810781959019, 44043.575903622899, 1.5356187165243818], [0.19587277833386305, 0.2205364057619365, 17861.18133818459, 0.19278917354648037, 0.21808301990621867, 0.19836973200429694, 0.21690720568461544, 832967.16516099439, 0.20994931554260854, 315767435.38522333]], 'Rp': [[0.64608224534363212, 0.60355688562079934, 0.68519884734141923, 0.66576346839022094, 0.6312749415851151, 0.68083770124973175, 0.6713498960498645, 0.57605995479855399, 0.58464051564635611, 0.6707184320407753], [0.60635065040574099, 0.62031574478691953, 0.63290503465039105, 0.65061230827285821, 0.64825810383137694, 0.64950007002063914, 0.66142715886619818, 0.64272121887865985, 0.67474982143399143, 0.6690822949797689], [0.64777485238255372, 0.64094315193799234, 0.61361754438092031, 0.63621693868791174, 0.65080847618686266, 0.65838610364805372, 0.62610118994766317, 0.63443556031417303, 0.61846975605895604, 0.65777001953308611], [0.63672056645388919, 0.58943115845919725, 0.65297570102199354, 0.61886099072949108, 0.62461921237197615, 0.62867149300430381, 0.62141790740317315, 0.64540157321232294, 0.62556038259837166, 0.60830564734227965], [0.64179776348192397, 0.62698838417287606, 0.62203320814699792, 0.59886558877184171, 0.61020625063837175, 0.63778891117066538, 0.62364165816137307, 0.6408420531249408, 0.61826609052739212, 0.61416322981108418], [0.62181586076263984, 0.60770343383644898, 0.62326995427478393, 0.61909785357370384, 0.63869515516917652, 0.61806571665247012, 0.6319263767917821, 0.6304438631352578, 0.62727206574651939, 0.62958094532219477], [0.61967194796830505, 0.63102476473946156, 0.60360882067116306, 0.62773406983859281, 0.62665628197613155, 0.6116175214329157, 0.60396287393701187, 0.63049717797594051, 0.61692076045651367, 0.62204997703142917], [0.60241528438517122, 0.6131825874947473, 0.60354694503052098, 0.58969720478345666, 0.62817515156940107, 0.60382473028791073, 0.61510615660233137, 0.60684989558403624, 0.5838566745308158, 0.59730361427919343], [0.58356795038601161, 0.58473304376596746, 0.60992031117255807, 0.61043442282943572, 0.6123095030587935, 0.60354399816711635, 0.61974577458779012, 0.59609824713979243, 0.59064302829742998, 0.13347131640168688], [0.56526589815907335, 0.56915854137453525, 0.56190659288384615, 0.57537328013518974, 0.57646319839515558, 0.58733336366667999, 0.5972760197820518, 0.58485588074776684, 0.46243963112666608, 0.57940382029425908], [0.55830037054055071, 0.5840098178566977, 0.57847363672295926, 0.58062234992696982, 0.57621060605514918, 0.5399144751235484, 0.57163565291063956, 0.57998553017398724, 0.49703368770337769, 0.56887584946674818], [0.55582759288270067, 0.12834294639791219, 0.53144529688278042, 0.52839106048478923, 0.52298499218409034, 0.53455454508848554, 0.51709809990783118, 0.57483700253629011, 0.49642513296395013, 0.55367812072330913], [0.50080079089924545, 0.52687198517931699, 0.50936739824174748, 0.53993797785231401, 0.2372911739525172, 0.46354905689743781, 0.50376095818990485, 0.11522559283118851, 0.40644107347621744, 0.1068094927286298], [0.45133520878339428, 0.46958503658157136, 0.46584399004528187, 0.098923311569375214, 0.46009888940171001, 0.11708356172645859, 0.10398919443245709, 0.41927167679254351, 0.35566018169566543, 0.09001691289146195], [0.0059640943244579575, 0.29295700254299367, 0.082217252062042251, 0.035421659682794399, 0.027849054708801935, 0.039703968141947182, 0.059980216616062135, 0.30584099438789447, -0.014305471611951471, 0.17160769417376182], [0.082571247249587157, 0.065148389668763587, 0.017580194658985734, 0.076373247153259605, 0.061428444393879393, 0.077598777556341286, 0.054988874641809224, 0.034903108311462427, 0.054196944729325625, 0.024764304190341771]]} 
np_nmtf_avr = {'R^2': [0.40318842682033684, 0.41204722810494615, 0.39993359025214403, 0.3817232465181557, 0.37842050596932963, 0.3793645493942951, 0.36936663164563105, 0.34610291126860737, 0.3058173756666574, 0.2646806387150415, 0.25895829558618905, -0.7232770744328442, -0.25138690554827103, -2.47860608748828, -43135.7013105382, -199561868.4727086], 'MSE': [0.096148288215316902, 0.094047981735886868, 0.095458604419896967, 0.098247582697774366, 0.0985684269426709, 0.099025914558136002, 0.10060440284253036, 0.10401369875134621, 0.11050000354058395, 0.11677029153257475, 0.11772252408693287, 0.27277019047278245, 0.19956749242688471, 0.55355468044368727, 6857.2408056449522, 31661826.518423013], 'Rp': [0.64154828880664683, 0.64559224061265452, 0.6384523593078173, 0.62519646325969991, 0.62345931380074671, 0.6247871225264976, 0.61937441960274653, 0.60439582445475837, 0.55444675958065825, 0.56594762265652232, 0.56350619764806287, 0.4943584790052139, 0.39100555002485199, 0.30318079639199197, 0.10072364650288043, 0.05495535325537558]}

bnmtf_all = {'R^2': [[0.4132616525416556, 0.3216617924459404, 0.4933000309890492, 0.45101045317931576, 0.44607795207607026, 0.44983599341873715, 0.4370501212356672, 0.33822371840499355, 0.4011141183566842, 0.46956462385517395], [0.3791466677237436, 0.39093112614218817, 0.3973621919002466, 0.4328470542750549, 0.4282952586666984, 0.44919765308100223, 0.44307559404567487, 0.42369544583766117, 0.4374277159155505, 0.4664704883077748], [0.43979074135439267, 0.4061555276954669, 0.3691695039533892, 0.41581019595470337, 0.4421362622691529, 0.4263277210615384, 0.3855833166841016, 0.39998349881046924, 0.3915433017670217, 0.44735649998654115], [0.4004723576209265, 0.3662106195593351, 0.44422273243047183, 0.38620079172244526, 0.39138062886854863, 0.3962060985556527, 0.4102308649417432, 0.44035769253310064, 0.41112185317946326, 0.37642894475047906], [0.42416587692308816, 0.4008225813931805, 0.3954926927432133, 0.378052044827324, 0.40269991871379685, 0.4282144966085867, 0.40271459835758416, 0.418768395127293, 0.3985681556132066, 0.40572570750558534], [0.40850659653778987, 0.3830004864504323, 0.41612209459001404, 0.3839598104995495, 0.409167709178585, 0.4001765777196048, 0.41270852121278534, 0.41509184446787184, 0.4176835861974648, 0.4078717611494238], [0.38380385119984317, 0.4155310628260017, 0.3890746604215358, 0.41067043967706496, 0.41561909959815113, 0.38112672474668174, 0.4019493969746514, 0.39859216751235005, 0.4019557364560251, 0.4014067402215493], [0.378871734926, 0.3795108667412723, 0.4171727349724911, 0.3873919731630019, 0.4075990596797836, 0.3952306680951354, 0.396568808067701, 0.38521911582243484, 0.3651873820594246, 0.3939730231717953], [0.3746858186484938, 0.3639015476271028, 0.40120550343651384, 0.3707606262629374, 0.38514779197311066, 0.38166623662949273, 0.4002437690097622, 0.36650341372182527, 0.3763040654081199, 0.37710303990942184], [0.36744587995075007, 0.35466018215088047, 0.3584185620628435, 0.3634129391137002, 0.366164342765678, 0.3702843435913663, 0.3648972298368933, 0.3620136409000724, 0.36645581167876473, 0.35028496411183874], [0.3390861685135994, 0.3571367822060898, 0.3439655689222877, 0.37514828815427037, 0.3577207995463437, 0.3416424778812861, 0.3409276845930572, 0.371453992812004, 0.33843745201125364, 0.3676847441222748], [0.3617616030435429, 0.35189094956256617, 0.3388516267660745, 0.34547134973194216, 0.3245763151753883, 0.35246847255794855, 0.36780260824969857, 0.3824871844458817, 0.30761516541233236, 0.32455930101569397], [0.29934167670489065, 0.3223871116810929, 0.33493376217352844, 0.3125144466795968, 0.30543722787241856, 0.3104879800926533, 0.32664035445394657, 0.31753613644669654, 0.31458966109640163, 0.30492399577974594], [0.30983678057250763, 0.29060189483530185, 0.31349809753138225, 0.30544218050574223, 0.26933494498749844, 0.29605698445584716, 0.2907334287091077, 0.27240990233983065, 0.30823001393673555, 0.26728880493910323], [0.25227331070046743, 0.2852793445327588, 0.27721976121133407, 0.20644548770436266, 0.2745194800521803, 0.2257732718732004, 0.25116929498764173, 0.2848511033672638, 0.22332082837684109, 0.19991750320818413], [0.1896083947071433, 0.1402458419660293, 0.20004087920449876, 0.19596398688550998, 0.17088517975386353, 0.2674178988442717, 0.20837775350845256, 0.17384828628899207, 0.19853651866594446, 0.24459664814167326]], 'MSE': [[0.097327467589591224, 0.097145284901661258, 0.079375147907430749, 0.090199133066115447, 0.095436799099386904, 0.090750815331727547, 0.088781991448673436, 0.11251442420145846, 0.096089774300989486, 0.082192587686272661], [0.096343689268789431, 0.096984810909262073, 0.095891662475473621, 0.093046331427389911, 0.092547248198513135, 0.088430973895677986, 0.084561009825728381, 0.093524244298124504, 0.092922043178507746, 0.085917934923151251], [0.090605559482045961, 0.096103896017280782, 0.10015183176667475, 0.091670431805426694, 0.087825107920041945, 0.090346088519864406, 0.099635629706699147, 0.093053259987948958, 0.096189867708630541, 0.089158467042283418], [0.096401639812239953, 0.10108454800207112, 0.087774709516491176, 0.096814854871753772, 0.096263379487223175, 0.095975923254470047, 0.095354626761176911, 0.088960545184587403, 0.091411454034669257, 0.099762035095916593], [0.091109165400093992, 0.095332388083804231, 0.096591936453685773, 0.09782667880496583, 0.094713483571603335, 0.090958336338034906, 0.096690002986772189, 0.0918208507345879, 0.093935174675147406, 0.093777786023144238], [0.093522617516059711, 0.096999693140413623, 0.093510449821793504, 0.097040418649666699, 0.094004179260966894, 0.096854556445124695, 0.093335390403068638, 0.093530283727573535, 0.09507233650299797, 0.094746416434261349], [0.099097557606289799, 0.093366141918195422, 0.097334513690536945, 0.094118461165258002, 0.094030371604020391, 0.097633523797412067, 0.093781083361182738, 0.096994822042228299, 0.095153272300514277, 0.095824953499104831], [0.099225700798841493, 0.09922451631593554, 0.093561474729543431, 0.096701436410453812, 0.094330061786492697, 0.095920432462878277, 0.095950727679990383, 0.097456479297579626, 0.10032282272477841, 0.096557428089564995], [0.099565329905278721, 0.10115540022920938, 0.096116014633824631, 0.10081331123285303, 0.096674467069155515, 0.098523009185588414, 0.095145049403074389, 0.10235645921686649, 0.097976577786177396, 0.099071074189670885], [0.10103856668463888, 0.10217615603315594, 0.10041756393713705, 0.1015292621380038, 0.10028906169567091, 0.10125441244986784, 0.1003010685100585, 0.1007708609377841, 0.10107103750898504, 0.10349293171938985], [0.10500698246224346, 0.10098896665098507, 0.10586230686623656, 0.09917331319708618, 0.10139045547819495, 0.10383119777402294, 0.1053444621818002, 0.099392672125951487, 0.10596965320594756, 0.10033016616858208], [0.10214901140578347, 0.10219838520251766, 0.10599974997969606, 0.1039918036679333, 0.10692991751936767, 0.102460150793572, 0.10067086624877801, 0.098234091001109941, 0.10971666360732829, 0.10784203999204274], [0.11159185321205708, 0.10713815832802474, 0.10586086522027455, 0.1090373716620217, 0.11125441888195241, 0.11028664918393181, 0.10664869509855626, 0.10842380352543213, 0.10931850822923271, 0.11126772016713384], [0.11014953921049504, 0.11331191653906318, 0.1087415993849242, 0.11008332304853237, 0.11602987168031474, 0.11188878400336712, 0.11291496190018112, 0.1153717217670631, 0.11000758426186381, 0.11669523343515072], [0.11865081855180405, 0.11434651721488792, 0.11445951379883142, 0.12625340098524976, 0.11592190675352111, 0.1225560271345333, 0.11845204081494319, 0.11412105456780397, 0.12345966943302621, 0.12713920033208786], [0.12887139730293604, 0.13716967200212207, 0.12698542451107131, 0.12794758527395667, 0.13160024582721622, 0.11640153641942153, 0.12620158922017427, 0.13152009908351558, 0.12741208396007059, 0.11984872397270487]], 'Rp': [[0.64608640909334047, 0.57645475054651063, 0.70428584619486567, 0.67170460522298625, 0.67406814078948851, 0.6721299519031011, 0.66222490554225977, 0.59352143663064438, 0.63412402393588752, 0.68701946248330903], [0.6180930449508375, 0.62653769385334712, 0.63112213059404476, 0.65801320732077828, 0.65523848712997179, 0.67050372431533367, 0.66904374385219989, 0.65106879683386598, 0.66203679341354227, 0.68363577153056154], [0.66352471567057725, 0.6384209624807996, 0.61267188237543124, 0.64515866994761639, 0.665042317460806, 0.65351491052640687, 0.62556655042045961, 0.63421116057589932, 0.62883849937536718, 0.66904396382067222], [0.6343194441436194, 0.60838158807668252, 0.66662946742369689, 0.62383170886824735, 0.62731131220781267, 0.63132796732603336, 0.64149544292562832, 0.66366545622722994, 0.64258061281553447, 0.61749566796179856], [0.65252648775746036, 0.63418326252084278, 0.62996084390864382, 0.61893290560972092, 0.63656647474338846, 0.65454356499619126, 0.63605807498786826, 0.64751617356590485, 0.63323354488125727, 0.63761152589525727], [0.64002554423724811, 0.62099271270732692, 0.64552324231249569, 0.62389248557382104, 0.64165624959795453, 0.63412252504516275, 0.6442597110920889, 0.64498255867372623, 0.64672098074049078, 0.63961326219142867], [0.62213372535652289, 0.64549079834212564, 0.62658536373642759, 0.64175418083950353, 0.64565129156466106, 0.62126762919143619, 0.63559839097043802, 0.63283746116270245, 0.63553119366135213, 0.63505545648660078], [0.61882612356968192, 0.62126439089669827, 0.64595998590327308, 0.62520679888898245, 0.63908439740948852, 0.63009957418223062, 0.63061837652320563, 0.62373299480734556, 0.60805235076821107, 0.62937238139223417], [0.61554623611977732, 0.60634952944560905, 0.63504293179061277, 0.61298209433446893, 0.62255481415893799, 0.6196143477638838, 0.63374332420887081, 0.60981582689054015, 0.61785997984621543, 0.61786451995844283], [0.61187740885523478, 0.60497072446495959, 0.60485988493740495, 0.60732629970514485, 0.60929949557155128, 0.61348640083184292, 0.60914449096783962, 0.60730838404152843, 0.6087585509093083, 0.59753216006382892], [0.59185345169443082, 0.60707111873423503, 0.59388767041924073, 0.61547573912919551, 0.60205325816582145, 0.59412787960050562, 0.59342915091909065, 0.6140829054027932, 0.59098859174072138, 0.61129658342547288], [0.60596489970995637, 0.59973966918402033, 0.59158390508406389, 0.59582979708283534, 0.57990025084729335, 0.59813870718843454, 0.61065668562521824, 0.62028853437618903, 0.57189109356541534, 0.57784104242918222], [0.56353624267517854, 0.58289294868417696, 0.58862744553586788, 0.5723605058186686, 0.56545173570969132, 0.57295212614019964, 0.58345431063639575, 0.57961186552141075, 0.57496775681207579, 0.56633939677360801], [0.57370339562503325, 0.557676534883361, 0.57707914501096569, 0.56978396872855674, 0.55032332450744581, 0.56293425355617754, 0.56243283846962533, 0.55276116482113069, 0.57080015360484593, 0.54000790071994631], [0.5424154174111715, 0.5517444379029055, 0.54883367958592211, 0.52039083477004755, 0.54643869479917184, 0.52734087825506637, 0.53331681504854844, 0.55709807393985766, 0.52552219737836781, 0.51884063466209018], [0.50544418515911538, 0.48607948884633723, 0.51241763955151576, 0.50675612131521064, 0.50749678184212632, 0.5430767594299275, 0.50753807149238661, 0.4961805346824219, 0.51339614517775134, 0.53284934158416131]]} 
bnmtf_avr = {'R^2': [0.4221100456503287, 0.4248449195895595, 0.4123856569536777, 0.4022832584162166, 0.40552244678128585, 0.40542889880035216, 0.3999729879633855, 0.390672536669904, 0.3797521812626781, 0.3624037896162788, 0.35332039587624664, 0.34574845759610695, 0.31487923529809714, 0.2923433032813057, 0.24807693860142344, 0.1989521387966379], 'MSE': [0.092981342553330723, 0.092016994840061803, 0.093474013995689664, 0.094980371602059938, 0.094275580307183984, 0.094861634190192667, 0.095733470098474285, 0.096925108029605869, 0.09873966928516989, 0.1012340921614692, 0.10272901761110505, 0.1040192679418129, 0.10908280435086173, 0.11251945352309553, 0.11953601495866888, 0.12739583575731889], 'Rp': [0.65216195323423942, 0.65252933937944824, 0.64359936326540357, 0.63570386679762847, 0.63811328588665361, 0.6381789272171744, 0.63419054913117701, 0.62722173743413512, 0.61913736045173584, 0.60745638003486435, 0.60142663492315074, 0.5951834585092608, 0.57501943343072726, 0.56175026799270866, 0.53719416637531481, 0.51112350690809538]}

hmf_mf_all = {'R^2': [[0.4613831479115331, 0.37514804479062, 0.47277655260949125, 0.45332797028919014, 0.4372671612907343, 0.4193870381172182, 0.44609155895509667, 0.3823508072973548, 0.444203681457947, 0.5486045088199711], [0.4245091834740865, 0.3958501774227826, 0.4183254570133078, 0.43113486873257234, 0.4393636867565629, 0.46031885618844737, 0.45869270089765457, 0.4346289623243622, 0.4582830956901225, 0.49090242865332867], [0.4413941377812871, 0.41828905478831524, 0.38969740002215913, 0.4144907369374128, 0.4539304672119835, 0.45640437092190766, 0.4225378726240694, 0.4106577908377478, 0.42084249312929456, 0.4462900130516938], [0.4243613145322912, 0.3914676019577493, 0.4087788070646874, 0.4341639675170741, 0.405573919550281, 0.39886694637094344, 0.40070092656415535, 0.43512763652693387, 0.4265537152440565, 0.39262304305033113], [0.4071111319573322, 0.41637619819634963, 0.39476010977496934, 0.43017492211498054, 0.41466345021553197, 0.4137339953667746, 0.4197459288845281, 0.40470476910398734, 0.4332210685981984, 0.4068941385093142], [0.3807434383525008, 0.4143876342623045, 0.39194997008356613, 0.40101540333271757, 0.4305280719146497, 0.41892282810608583, 0.41411545999146027, 0.41302336995985456, 0.4197985363195973, 0.41642672452046514], [0.3866643006062891, 0.37655747297531506, 0.4212267948006233, 0.3820242772963367, 0.40531371628843627, 0.3883744643470829, 0.37424214838445624, 0.4217386117160654, 0.3876680431181707, 0.38798945620299086], [0.3973360484247642, 0.4104608821054071, 0.3824818760064337, 0.3706209054901214, 0.3858755190451535, 0.3990325961921939, 0.404102637009063, 0.39618507621000265, 0.3819755135348385, 0.3744605063854298], [0.3926620581853516, 0.3749291385495406, 0.38280351398412105, 0.3746396772936912, 0.4021498609523, 0.3763769657427194, 0.3795295048627879, 0.3844479656550318, 0.40153134031508575, 0.39494051176462586], [0.38133866702560326, 0.386799761947326, 0.3590280858803543, 0.3734739708301321, 0.37522174084996385, 0.3659652701694135, 0.3767548212249957, 0.3938572219985459, 0.3827498770893596, 0.3860578930652726], [0.37385924125177117, 0.3469614086680223, 0.36637358907190964, 0.3786417106844915, 0.3766024997484301, 0.36467814065427673, 0.35862725978300125, 0.35431156929204866, 0.3583970053539983, 0.38693003579668217], [0.3466214734399369, 0.3572829454275762, 0.35204686926472795, 0.36026944075322165, 0.3478913362381395, 0.3588760774710782, 0.36540755943839287, 0.3519141134033076, 0.35491400709011445, 0.3561067340993419], [0.33596825466074, 0.34005906691558363, 0.34059593079913275, 0.35359651706243767, 0.31440182998954636, 0.3395194747955691, 0.33206074693898013, 0.3449462199097827, 0.3258955516299282, 0.32286970886322863], [0.3032673968803209, 0.30481956460541104, 0.3243692755718748, 0.3301917321468404, 0.3085800517841273, 0.3261291749173827, 0.3168399845888411, 0.31674927451749446, 0.2973547423332914, 0.31800678323872145], [0.3006880657960189, 0.29007628965669274, 0.3030881154538856, 0.2663305810076495, 0.31249392775488594, 0.3211984065670308, 0.31161917424420327, 0.30424307299898634, 0.30051656524610504, 0.30360887463119746], [0.2839954633582106, 0.28771207052544645, 0.26773995330221567, 0.29690751126023207, 0.3016038178128073, 0.29211541009878117, 0.2708779432838655, 0.2987209557558451, 0.29601147698052266, 0.3140807514099534]], 'MSE': [[0.089345130486071789, 0.089485481628775496, 0.082590175007456398, 0.089818364369539813, 0.096954835207966425, 0.095773440379089719, 0.087356079699563466, 0.1050119885045426, 0.089176159336870897, 0.069945115198864066], [0.089304358246954887, 0.096201527969059175, 0.09255599001087314, 0.0933272302301765, 0.090755497164209775, 0.086645471660286008, 0.082189775396350528, 0.091749924002450148, 0.089477286736105319, 0.081983491158273761], [0.090346233831696099, 0.094140285542759147, 0.096892784516284164, 0.091877479886421989, 0.085968333134592553, 0.085609398652795932, 0.093642969429736822, 0.091397842729869436, 0.091558009189706399, 0.089330524327367378], [0.09309976098828654, 0.094416568579833979, 0.097237354276792823, 0.089248588853071145, 0.095480135027383006, 0.096230346271494585, 0.09613233395180415, 0.091739744007507423, 0.092052950369098455, 0.097417958976761324], [0.092527586043420776, 0.091920803502911819, 0.095248451450179475, 0.090542677720429718, 0.094882620131292117, 0.092341274977450663, 0.091175985792617875, 0.094194355763436419, 0.091838530493747725, 0.092511211089207401], [0.098138824781584047, 0.093477477907411954, 0.096211493918092514, 0.095605226563563808, 0.090024549217481251, 0.091828360914744986, 0.094891544312022555, 0.092517927001351169, 0.093183278660585053, 0.092876304160790193], [0.097580514289489412, 0.098427272948462249, 0.091786244229805303, 0.098134926074477491, 0.095010575534995104, 0.096804574168926169, 0.1003042372618395, 0.092087416388007451, 0.095502983718695061, 0.097886353595234843], [0.096438446165120664, 0.093309244687748621, 0.098604911323037336, 0.098380083413842176, 0.097160862711316812, 0.095682156923924178, 0.094898602983694638, 0.095582697969766109, 0.097756498760307203, 0.099174320686700332], [0.096288124816306206, 0.098097001157533864, 0.098870033249358932, 0.099543451843196365, 0.094671551553243194, 0.099349527271032467, 0.099136841478860038, 0.09735776883450338, 0.096777590890502821, 0.096220096745032013], [0.098836004250587639, 0.098089493237958431, 0.10113185225826411, 0.099738083305848338, 0.10025678313116029, 0.10009360689807073, 0.098420738079116554, 0.096948218809805781, 0.09817583761577002, 0.097922757386939827], [0.099943873093766733, 0.10423371962706442, 0.1005773627096177, 0.098774485437605156, 0.09897754887416059, 0.10123301985295695, 0.10135091355721165, 0.10350342263399662, 0.10218614831052948, 0.09829047364334513], [0.10361240428015739, 0.10118071336491585, 0.10325668986877204, 0.1009039001007818, 0.10456182421513739, 0.10124373546825055, 0.10107218768974088, 0.10393032762060637, 0.10270676254431772, 0.10177808376866464], [0.10608829508305469, 0.10447000167445573, 0.10435009255700128, 0.10280451208624515, 0.10847453624182533, 0.10415001644775423, 0.1075863494881077, 0.10355627926598014, 0.10700357854141333, 0.10736565140993402], [0.1114765805150407, 0.11079109927694332, 0.10785997276820886, 0.10665024645728501, 0.11058373558644768, 0.10756336119235893, 0.1085284234848183, 0.10918234112698268, 0.11144312155429413, 0.10884971773300146], [0.11061028756648089, 0.11238034529259668, 0.11031047828256967, 0.11718303385964744, 0.10931152490312908, 0.10779387854094394, 0.10940022778162427, 0.11040414911375244, 0.11190874924599291, 0.11028053251306479], [0.11386162505832415, 0.1136421391441932, 0.11623888079424216, 0.11188427469815365, 0.11085208829500731, 0.11247729604933127, 0.11623771653825132, 0.11164086190644601, 0.1119160721491408, 0.10882470469531512]], 'Rp': [[0.68180100525841902, 0.61957682771001132, 0.68885275785191158, 0.67466472975794578, 0.66871772655147987, 0.65607522033871501, 0.66918015256433994, 0.62881200039059526, 0.66893961443696304, 0.74090320488767736], [0.65414958613128282, 0.63366481130888896, 0.64955646869247596, 0.65835892738810053, 0.66477961778215977, 0.67981294324894048, 0.67987432528827385, 0.66094798697651169, 0.67741154648893032, 0.70108234027379068], [0.66550780965800904, 0.64931723102600847, 0.62965126459685195, 0.64641986963096332, 0.67467233074675925, 0.67690295237945719, 0.65423525495886437, 0.64562055787016415, 0.65247116706442265, 0.6699915166142143], [0.65340790856227449, 0.63224146592953745, 0.64478710776874737, 0.66157573660739488, 0.64196642336366483, 0.63934993436946042, 0.63758037593883443, 0.66250823802606984, 0.65511748192666119, 0.63295703695107441], [0.64416772320135929, 0.64989973641915899, 0.63274733709737829, 0.65802394720973834, 0.6461092582494794, 0.64890090307148296, 0.64999552215545686, 0.64017978048333779, 0.66012120917523054, 0.64254171684253203], [0.62401793442444176, 0.64665305587331046, 0.63212046907233355, 0.6380268342893064, 0.65822851411605787, 0.64862865595033647, 0.64719299498295801, 0.64617216074010608, 0.65047287957602584, 0.64899684370906452], [0.63013295680648773, 0.62195351588708969, 0.65150218438751695, 0.62394017425792714, 0.64014924648072169, 0.62907990373545619, 0.61904847049185907, 0.65173263440728557, 0.6274793281829244, 0.62781067156902071], [0.63535496603138286, 0.64350204830780444, 0.62362527802739942, 0.61927224485532328, 0.62807198638555639, 0.63644314538787716, 0.6379188312289179, 0.63330997452408555, 0.62485968591540908, 0.61992738125985281], [0.63193234726591851, 0.61974047260947562, 0.62329153222290712, 0.62128624485701078, 0.63740177121983166, 0.61943463310715041, 0.62311646402969401, 0.62673929643465776, 0.63586041617147859, 0.63183129313434094], [0.62323262618518649, 0.62536349343497533, 0.60906355741926754, 0.61671817167107501, 0.61986240400722747, 0.61237751391236117, 0.61990786805523612, 0.63106616969917351, 0.62320240966267493, 0.62595151572485574], [0.61697244416472052, 0.59835564118612727, 0.61294981976814411, 0.61926102920544057, 0.61869250243094509, 0.60933565651117116, 0.60782085369991845, 0.60198456956749613, 0.60789955744132185, 0.62620240514618941], [0.59790095480070049, 0.60461758283736533, 0.60180281694910376, 0.60755368335887672, 0.59881815764278457, 0.61018393215404676, 0.61134997680982539, 0.60203633258128741, 0.60500246856706241, 0.60348818475894839], [0.59107818312016946, 0.5946658154277934, 0.59575422798748046, 0.59997700301336976, 0.57808888030936778, 0.59602272432343106, 0.58870111125896196, 0.5998421428734938, 0.58804782387308696, 0.58704305719629613], [0.57158503263975702, 0.57150166435997385, 0.5824398023164763, 0.5844724716862727, 0.57588476769885333, 0.58785893298246372, 0.57793472598276807, 0.5770517930018253, 0.56879387005067605, 0.57745518341241731], [0.57118411666069069, 0.56283519494777812, 0.56895679519630604, 0.55021731830698228, 0.57444942795192622, 0.57923633534821828, 0.57217247111641656, 0.56871436092724492, 0.56389640440964039, 0.57064221684680672], [0.56040920699808772, 0.56074449702300599, 0.55032425831865406, 0.56376145812756118, 0.5694679464989354, 0.5614129368043328, 0.54706436805627912, 0.56348631731749099, 0.56706120585820974, 0.56907985696246155]]} 
hmf_mf_avr = {'R^2': [0.44405404715391567, 0.44120094171532276, 0.42745343373058703, 0.4118217878378503, 0.41413857127219666, 0.41009114368432015, 0.39317992857357664, 0.3902531560403408, 0.38640105373052547, 0.3781247310080967, 0.36653824603046314, 0.3551330556625837, 0.33499133015649285, 0.3146307980584305, 0.30138630733566557, 0.290976535378788], 'MSE': [0.089545676981874073, 0.089419055257473928, 0.091076386124122985, 0.094305574130203323, 0.092718349696469388, 0.093875498743762747, 0.096352509820993235, 0.096698782562545813, 0.097631198783956943, 0.098961337497352156, 0.10090709677402546, 0.10242466289213448, 0.10558493127957716, 0.10929285996953812, 0.1109583207099802, 0.11275756593284048], 'Rp': [0.66975232397480577, 0.66596385535793545, 0.65647899545457145, 0.64614917094437196, 0.64726871339051539, 0.64405103427339405, 0.63228290862062908, 0.6302285541923609, 0.62706344710524653, 0.6206745729772033, 0.61194744791214739, 0.60427540904600019, 0.59192209693834508, 0.57749782441314834, 0.56823046417120104, 0.56128120519650182]}

hmf_mtf_all = {}
hmf_mtf_avr = {}

# Assemble the average performances and method names
methods = ['NP-NMF', 'BNMF', 'NP-NMTF', 'BNMTF', 'HMF D-MF']#, 'HMF D-MTF']
avr_performances = [
    np_nmf_avr,
    bnmf_avr,
    np_nmtf_avr,
    bnmtf_avr
]
colours = ['#0000ff','#00ff00','#ff0000','#00ffff','#ff00ff']#,'#ffff00']

# Also compute the median values
def compute_medians(all_performances):
    medians = {}
    for metric in ['MSE','R^2','Rp']:
        medians[metric] = []
        for performances in all_performances[metric]:
            medians[metric].append(numpy.median(performances))
    return medians
    
median_performances = [
    compute_medians(np_nmf_all),
    compute_medians(bnmf_all),
    compute_medians(np_nmtf_all),
    compute_medians(bnmtf_all),
    compute_medians(hmf_mf_all)
]

# What to plot - averages or medians
values_to_plot = median_performances # avr_performances # 

# Plot 
for metric in metrics:
    fig = plt.figure(figsize=(3.8,3.0))
    fig.subplots_adjust(left=0.12, right=0.965, bottom=0.14, top=0.97)
    plt.xlabel("Fraction missing", fontsize=10, labelpad=1) #fontsize=8
    plt.ylabel(metric, fontsize=10, labelpad=0) #fontsize=8, labelpad=-1
    plt.yticks(fontsize=8) #fontsize=6
    plt.xticks(fontsize=8) #fontsize=6
    
    x = fractions_unknown
    for method,performance,colour in zip(methods,values_to_plot,colours):
        y = performance[metric]
        #plt.plot(x,y,label=method)
        plt.plot(x,y,linestyle='-', linewidth=1.2, marker='o', label=method, c=colour, markersize=5) #linewidth=0.5, markersize=2)
     
    plt.xlim(fraction_min,fraction_max)
    plt.ylim(MSE_min,MSE_max)
    
    plt.legend(loc='upper left',fontsize=6,ncol=2)
        
    plt.savefig("./mse_missing_values_ctrp_median.png", dpi=600)