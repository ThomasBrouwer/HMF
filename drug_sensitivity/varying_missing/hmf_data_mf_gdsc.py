"""
Test the performance of HMF for recovering the GDSC dataset, where we vary the 
fraction of entries that are missing.
We repeat this 10 times per fraction and average that.
"""

project_location = "/home/tab43/Documents/Projects/libraries/"
import sys
sys.path.append(project_location)

from HMF.code.models.hmf_Gibbs import HMF_Gibbs
from HMF.code.generate_mask.mask import try_generate_M_from_M
from HMF.drug_sensitivity.load_dataset import load_data_without_empty,load_data_filter

import numpy, random


''' Settings '''
metrics = ['MSE', 'R^2', 'Rp']

fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9]
repeats = 20

iterations, burn_in, thinning = 500, 450, 2
settings = {
    'priorF'  : 'exponential',
    'orderG'  : 'normal',
    'priorSn' : 'normal',
    'priorSm' : 'normal',
    'orderF'  : 'columns',
    'orderG'  : 'rows',
    'orderSn' : 'rows',
    'orderSm' : 'rows',
    'ARD'     : True
}
hyperparameters = {
    'alphatau' : 1.,
    'betatau'  : 1.,
    'alpha0'   : 0.001,
    'beta0'    : 0.001,
    'lambdaF'  : 0.1,
    'lambdaG'  : 0.1,
    'lambdaSn' : 0.1,
    'lambdaSm' : 0.1,
}
init = {
    'F'       : 'kmeans',
    'Sn'      : 'least',
    'Sm'      : 'least',
    'G'       : 'least',
    'lambdat' : 'exp',
    'tau'     : 'exp'
}

K = {'Cell_lines':10, 'Drugs':10}
alpha_l = [1., 1., 1., 1.] # GDSC, CTRP, CCLE IC, CCLE EC


''' Load data '''
location = project_location+"HMF/drug_sensitivity/data/overlap/"
location_data = location+"data_row_01/"

R_gdsc,     M_gdsc,   cell_lines, drugs   = load_data_without_empty(location_data+"gdsc_ic50_row_01.txt")
R_ccle_ec,  M_ccle_ec                     = load_data_filter(location_data+"ccle_ec50_row_01.txt",cell_lines,drugs)
R_ctrp,     M_ctrp                        = load_data_filter(location_data+"ctrp_ec50_row_01.txt",cell_lines,drugs)
R_ccle_ic,  M_ccle_ic                     = load_data_filter(location_data+"ccle_ic50_row_01.txt",cell_lines,drugs)


#''' Seed all of the methods the same '''
#numpy.random.seed(0)
#random.seed(0)

''' Generate matrices M - one list of (M_train,M_test)'s for each fraction '''
M_attempts = 1000
all_Ms_train_test = [ 
    [try_generate_M_from_M(M=M_gdsc,fraction=fraction,attempts=M_attempts) for r in range(0,repeats)]
    for fraction in fractions_unknown
]

''' Make sure each M has no empty rows or columns '''
def check_empty_rows_columns(M,fraction):
    sums_columns = M.sum(axis=0)
    sums_rows = M.sum(axis=1)
    for i,c in enumerate(sums_rows):
        assert c != 0, "Fully unobserved row in M, row %s. Fraction %s." % (i,fraction)
    for j,c in enumerate(sums_columns):
        assert c != 0, "Fully unobserved column in M, column %s. Fraction %s." % (j,fraction)
        
for Ms_train_test,fraction in zip(all_Ms_train_test,fractions_unknown):
    for (M_train,M_test) in Ms_train_test:
        check_empty_rows_columns(M_train,fraction)

''' Run the method on each of the M's for each fraction '''
all_performances = {metric:[] for metric in metrics} 
average_performances = {metric:[] for metric in metrics} # averaged over repeats
for (fraction,Ms_train_test) in zip(fractions_unknown,all_Ms_train_test):
    print "Trying fraction %s." % fraction
    
    # Run the algorithm <repeats> times and store all the performances
    for metric in metrics:
        all_performances[metric].append([])
    for repeat,(M_train,M_test) in zip(range(0,repeats),Ms_train_test):
        print "Repeat %s of fraction %s." % (repeat+1, fraction)
     
        D = [(R_gdsc,    M_train,   'Cell_lines', alpha_l[0]), 
             (R_ctrp,    M_ctrp,    'Cell_lines', alpha_l[1]), 
             (R_ccle_ic, M_ccle_ic, 'Cell_lines', alpha_l[2]),
             (R_ccle_ec, M_ccle_ec, 'Cell_lines', alpha_l[3])]
        R, C = [], []

        HMF = HMF_Gibbs(R,C,D,K,settings,hyperparameters)
        HMF.initialise(init)
        HMF.run(iterations)
        
        # Measure the performances
        performances = HMF.predict_Dl(l=0,M_pred=M_test,burn_in=burn_in,thinning=thinning)
        for metric in metrics:
            # Add this metric's performance to the list of <repeat> performances for this fraction
            all_performances[metric][-1].append(performances[metric])
            
    # Compute the average across attempts
    for metric in metrics:
        average_performances[metric].append(sum(all_performances[metric][-1])/repeats)
    
 
print "repeats=%s \nfractions_unknown = %s \nall_performances = %s \naverage_performances = %s" % \
    (repeats,fractions_unknown,all_performances,average_performances)

'''
200 iterations
repeats=10 
fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.6155217345820396, 0.6029498611141813, 0.618376221687865, 0.6248497907423864, 0.5723037817812888, 0.6561889466111129, 0.6121430520802655, 0.5860120900347748, 0.5921202651013384, 0.6211203078561853], [0.6037588304444947, 0.5719666737156777, 0.6121558910568417, 0.6018774314230521, 0.608902418697885, 0.598099809223715, 0.6165600567810603, 0.632352203962586, 0.6089776144458043, 0.6396062614167726], [0.6160457623611293, 0.6053642313098477, 0.6005668600236748, 0.6094387401334875, 0.5951711910028724, 0.594674200204578, 0.6059703317981122, 0.6011711899950352, 0.605015629057321, 0.5761822607438258], [0.5866234676222457, 0.5980630488909577, 0.5788456614145225, 0.6020120493090307, 0.6082277619732639, 0.5916523141352645, 0.5758781101705368, 0.6020158104074156, 0.6084957898815206, 0.5876036580537315], [0.5964374223004856, 0.5718533822294047, 0.5771113287104903, 0.5895080421885486, 0.5851621842669961, 0.5819714835374896, 0.588438371693885, 0.5869877633650976, 0.6112218536383482, 0.5998453381198467], [0.5913507608528265, 0.5869400303437347, 0.5775652433641448, 0.5915992068771347, 0.577090229897032, 0.5854005498509167, 0.5737564837890272, 0.5751283975367986, 0.5864050356399952, 0.5823069714868042], [0.563330131334747, 0.5747108861380663, 0.564952342395863, 0.5436806071742466, 0.56193628130273, 0.567754089020831, 0.5799288778400382, 0.5671705518448158, 0.556133928557055, 0.572482708909241], [0.5606984081989055, 0.5558255073934613, 0.5586348535994112, 0.5607562339613129, 0.5485030621854614, 0.5561267502400722, 0.5398987241910195, 0.5558481063139156, 0.561441730250055, 0.5645380335672416], [0.5210152769060946, 0.5317151329964115, 0.5254015981926959, 0.5411023085309937, 0.535083338878233, 0.5511963004729511, 0.5357051768557527, 0.5487390802391244, 0.5445585444190105, 0.5580809621028884], [0.5388934604599305, 0.541128375976007, 0.5304830159050804, 0.5218071336578574, 0.5222141046577278, 0.5123925901486185, 0.5230141434323636, 0.5294010786299599, 0.5374351691136248, 0.5184244078789321], [0.5196546073668701, 0.5013219412175736, 0.5124512657229601, 0.4783349443416156, 0.5043822145903394, 0.5013235677127079, 0.5123671499516211, 0.47453652630968346, 0.5049548458253623, 0.4863046817988018], [0.49606425452006697, 0.4713196696125672, 0.47069340058821174, 0.4795833128078606, 0.49193459522081284, 0.49131747870100806, 0.4762822736087925, 0.4805614132390952, 0.497187263195388, 0.4912775789035556], [0.4755655445656879, 0.436477149883567, 0.4610393068900206, 0.46477368854216206, 0.453840202790172, 0.47603777947434744, 0.4627557593770587, 0.46480185079769076, 0.48625555585136804, 0.45620813847531816]], 'MSE': [[0.075314562302779789, 0.076845030640578432, 0.075913723646596903, 0.074376553684184721, 0.084573756129141822, 0.070548956743948274, 0.077372222789237319, 0.082849774114785599, 0.081343860089588771, 0.073791456579014314], [0.07858732859956355, 0.086069783409123274, 0.077544867877733084, 0.080036195234676671, 0.078334791350349611, 0.079792640337666573, 0.076422928230938866, 0.07306150850142773, 0.078266441598077885, 0.07158541506790575], [0.076270302754471733, 0.08018997996709322, 0.079415902039502301, 0.077529425948152833, 0.080791639941676263, 0.082147519297973759, 0.078724845989254166, 0.079610718499713212, 0.078843501870276222, 0.083747931634192904], [0.082918222992899207, 0.080000479662838977, 0.083237463839217443, 0.07968946735832487, 0.077572168498062949, 0.081102142190022777, 0.084162616163967002, 0.079476024624563921, 0.077701426991610312, 0.081762992826958342], [0.080833839636721722, 0.085694680608066537, 0.084433297081688785, 0.082164982644785167, 0.082645044604159182, 0.082898371018953212, 0.081838165793331419, 0.082561669811136232, 0.077221263523917033, 0.079903710009580714], [0.081381030683698383, 0.082326046851520035, 0.084382663750313544, 0.081874461592684369, 0.0842673532533042, 0.083176985708591417, 0.084388979373738723, 0.084881584220670853, 0.082560929469122996, 0.082842360771906487], [0.087213115162368654, 0.0845089030732563, 0.086535158626907638, 0.090741127285226889, 0.087188874745846814, 0.0865686170398344, 0.083815953721807904, 0.086087219830944847, 0.088887709334561554, 0.084972342584169802], [0.087625890794818931, 0.088900572811992457, 0.087927407329640786, 0.087997002808919714, 0.089919726052383048, 0.088546062404848816, 0.091608025819593222, 0.088981013660543659, 0.087771962891052782, 0.087010881184696867], [0.095323738938981689, 0.094082201388250394, 0.094690204801802166, 0.091882312125842969, 0.092784387667439502, 0.089476437532299932, 0.092165197797198561, 0.090194535295309131, 0.091218657827703151, 0.087864627304747409], [0.092325852521330312, 0.091650354525886671, 0.093428109574125229, 0.095384586748230249, 0.095084623887859127, 0.096517898485224005, 0.095072698195782318, 0.093958519294545753, 0.092394347263558302, 0.095876799483330027], [0.095708440342661655, 0.099374107028968636, 0.097186610350783686, 0.10410957304229462, 0.098747890157817889, 0.099219047703940771, 0.097486268556083361, 0.10471062393814677, 0.098744914473309242, 0.10273997852804653], [0.10066089287822184, 0.10564251607800666, 0.10524779837578341, 0.10365532255000698, 0.10113529038307834, 0.10139961077335791, 0.10453356633953635, 0.10371271803984355, 0.10033927295850288, 0.10157222715095521], [0.10457444692376411, 0.11222508615049022, 0.10733173852027818, 0.10661108321002775, 0.10896116618825197, 0.1045689620204797, 0.10724222853612259, 0.10677281814950493, 0.10248947921734772, 0.1083323442335371]], 'Rp': [[0.7849220985010229, 0.77853142066266967, 0.78822580233215944, 0.79126554936309967, 0.76210890292398881, 0.81057833855206818, 0.78364111845221573, 0.76904071955320608, 0.77170656368793467, 0.78898784521011733], [0.77799507224551134, 0.75926962990463776, 0.78303264111505533, 0.77684133202197181, 0.78158378554022701, 0.77501765752164087, 0.78615478269248795, 0.79638631735474952, 0.78130181906623053, 0.80030363807638527], [0.78591409679749202, 0.77886071793182698, 0.77681994060558346, 0.78181486696269298, 0.77305761438453779, 0.77239104697967187, 0.77948948338699997, 0.776439015088631, 0.7788685771636138, 0.7614514362817586], [0.76726081425838955, 0.77399142696479606, 0.76327532611214355, 0.77658043794511056, 0.78102489115495433, 0.77117356732756148, 0.76135156263834469, 0.77672770376783007, 0.78101607818247054, 0.76904671239065048], [0.77366261253665125, 0.75875551010516473, 0.76202032277264187, 0.76901392476684749, 0.76741944600978251, 0.76444290757690581, 0.76868673044158342, 0.7684389120653643, 0.78248240364572708, 0.77577813933250483], [0.76994534723604291, 0.7678941915812203, 0.76161925800378183, 0.77071405976126506, 0.76122346286957632, 0.76602704371126229, 0.76022933124834857, 0.76099409215864366, 0.76787110752195631, 0.76482451919132233], [0.7519966990860697, 0.75931870497967091, 0.75402590214472398, 0.74034290553726068, 0.75359173637202526, 0.75552937076497384, 0.76387983964488038, 0.75493557489735863, 0.74851707630830766, 0.75855247898634648], [0.75125543941149031, 0.74814390389002317, 0.75048726547181221, 0.75092360825865201, 0.74373216206077819, 0.7479414448841365, 0.73859707455018153, 0.74831505913324825, 0.75137302318888599, 0.75320188663134435], [0.72833352658570205, 0.73345615062426306, 0.72871495142602971, 0.73748003364584891, 0.73594163358480025, 0.74425470010093409, 0.73577616244276356, 0.74196088949582517, 0.74145179856332288, 0.74976378372977903], [0.73590400234434294, 0.73814652414206394, 0.73100462342487027, 0.72792606795560921, 0.72690420485828422, 0.72168010867067123, 0.72727283382105956, 0.73031564903032242, 0.73632171740777475, 0.72405747332212078], [0.72376724352152599, 0.7150087941786557, 0.72085334075787155, 0.70115083842789117, 0.71358217301890892, 0.71287755069255376, 0.7193472873216552, 0.69850345681720938, 0.71408861492766995, 0.70305476273493839], [0.71069597261543571, 0.69385134721928299, 0.6948476280915743, 0.70115025187649316, 0.7070910787608955, 0.70662445641610949, 0.69898258612974906, 0.7006878993524196, 0.7090161492807836, 0.70654401764679076], [0.6940666764619764, 0.67303802749098529, 0.68509075301866984, 0.68938950679273392, 0.68595591807156786, 0.69514911915389588, 0.68943109988550799, 0.68935020689128623, 0.70077231801165063, 0.68366515604834988]]} 
average_performances = {'R^2': [0.6101586051591438, 0.6094257191167889, 0.6009600396629884, 0.5939417671858489, 0.5888537170050592, 0.5827542909638413, 0.5652080404517635, 0.5562271409900857, 0.5392597719594155, 0.5275193479860102, 0.49956317448375354, 0.48462212403973587, 0.46377549766473936], 'MSE': [0.077292989671985585, 0.077970190020746288, 0.079727176794230664, 0.080762300514846591, 0.082019502473234002, 0.083208239567555103, 0.086651902140492482, 0.088628854575849042, 0.091968230067957485, 0.094169378997987205, 0.09980274541220531, 0.1027899215527293, 0.10691093531498042], 'Rp': [0.78290083592384818, 0.78178866755388976, 0.77651067955828068, 0.77214485207422512, 0.76907009092531731, 0.76513424132834196, 0.75406902887216165, 0.74839708674805516, 0.73771336301992674, 0.729953320497712, 0.712223406239888, 0.70294913873895348, 0.6885908781826624]}

500 iterations
repeats=10 
fractions_unknown = [0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9] 
all_performances = {'R^2': [[0.6285846054495241, 0.6112818463550085, 0.6222427310329056, 0.60729815678096, 0.5725625945688264, 0.6543183337071596, 0.6077203908536533, 0.5965433374628939, 0.6051239456433379, 0.6218970862293878], [0.6028639978371785, 0.5764992791289012, 0.6126866624861947, 0.6073562373492517, 0.616103972784738, 0.6051178414139089, 0.6300842812791435, 0.6352995491894695, 0.6143622277442228, 0.6420690094615809], [0.6180325532998423, 0.6176768741823591, 0.6065646194573717, 0.6137008146216845, 0.6009445426167763, 0.5970288921165874, 0.6111593119775178, 0.5985755320595374, 0.6066311959193693, 0.5829181120635247], [0.5840812993676432, 0.6108135437711109, 0.5845141327051526, 0.6011780867765097, 0.6110172544078218, 0.6004437610359549, 0.5828320095756427, 0.6139890489069917, 0.6122909477650199, 0.6009221072963415], [0.5994065668143101, 0.5830976638789435, 0.5828501384586364, 0.5968508391316719, 0.5883398007518144, 0.5867389464041785, 0.5900100937821617, 0.5910092946450529, 0.618180912336137, 0.5997908970490191], [0.5905380525015538, 0.5873001889428373, 0.5844177736345011, 0.5951985771734194, 0.5935734143644638, 0.5827382272813539, 0.5726197916179825, 0.5786056867427315, 0.5914082301951218, 0.5837826765574516], [0.5744479416607986, 0.5764950134485586, 0.5781331348097767, 0.5579845168453363, 0.5669054957007363, 0.5655265377781176, 0.5823192496881391, 0.5743879598213257, 0.5729044835295647, 0.5771778642135977], [0.5612553601817363, 0.5692898366583445, 0.5789735257577181, 0.5582906558027227, 0.5590741937797035, 0.5682304122268985, 0.5543297478559837, 0.563030911322931, 0.5696916843911581, 0.567107540930207], [0.5423549145908022, 0.5335291060365621, 0.5431699963440146, 0.559785380334464, 0.5458934026630606, 0.5457148486189938, 0.5331114108925985, 0.5540637462554497, 0.5532762263110644, 0.554383784749012], [0.5427954191358515, 0.5489626530710738, 0.5341981093763186, 0.5320022335680819, 0.5300083403887528, 0.5352019274280833, 0.5362711649982042, 0.5393967663518726, 0.5406922950846337, 0.5308116950516226], [0.5353263655038982, 0.5096654766218539, 0.5226810403567106, 0.4875485673901714, 0.5173703155324931, 0.5174475407228739, 0.5265290466850104, 0.487670341681796, 0.5183149809311729, 0.5085434116820367], [0.5055303309528302, 0.48907552292676715, 0.4786363167074492, 0.48900553870538666, 0.49092855831115056, 0.497925806526461, 0.47269064541000794, 0.5012747742609978, 0.494663992602818, 0.4941013560152063], [0.4753032030546416, 0.4686851254220574, 0.492651344183476, 0.48068995855697705, 0.46585008431992014, 0.4973158238573725, 0.4783777584281319, 0.48043628743323463, 0.4965112699325369, 0.470472081631803]], 'MSE': [[0.072755706600669226, 0.075232459334282187, 0.075144586243276287, 0.077856306629439653, 0.084522577819294994, 0.070932800682486238, 0.078254483972341304, 0.080742196937858182, 0.078750523181294149, 0.073640169485020571], [0.078764802596603414, 0.085158358194685563, 0.077438746373207412, 0.078934768650573181, 0.076892357891892318, 0.078399291114943703, 0.073727432217874922, 0.072475791707606194, 0.077188665650157154, 0.071096236644084293], [0.075875638152415673, 0.077688051192198321, 0.078223418422165972, 0.076683371251045615, 0.0796394528085453, 0.0816702930780287, 0.077688117797366604, 0.080128841032591144, 0.07852101582201701, 0.082416902836742634], [0.083428150523153818, 0.07746265450509654, 0.082117140169604558, 0.079856452388645541, 0.077019839986355518, 0.079356068436510663, 0.082782686524612376, 0.077085011557431221, 0.076948206015730866, 0.07912243528769769], [0.080239118112102423, 0.08344410782614943, 0.083287495216429586, 0.080695232088373453, 0.082011991767212064, 0.081952945312385922, 0.081525632155609137, 0.081757760608890673, 0.075839016834874831, 0.079914580915134065], [0.081542878637728203, 0.082254264456996587, 0.083013849398371475, 0.081152875077566258, 0.080982978130170344, 0.083711101145166542, 0.084614025124649606, 0.084186885363694189, 0.081562202626727115, 0.082549679583784508], [0.084992630210468698, 0.084154380380249652, 0.083913372387101615, 0.087896731652371607, 0.086199840061528574, 0.087014742788092472, 0.083339007591428454, 0.084651720029044461, 0.085529272383231422, 0.084039144434476756], [0.087514797608415018, 0.08620571616420715, 0.083875599600843911, 0.088490950600379009, 0.087814388945072708, 0.086131563197716199, 0.088734750612566735, 0.087542016597345382, 0.086120837559090252, 0.086497460686246253], [0.091076893572870243, 0.093717759594586794, 0.091145116462816464, 0.088141513540823432, 0.09062700069296302, 0.090569255583741515, 0.092680075286925553, 0.089130282319005147, 0.089472626078029402, 0.088599719216206407], [0.091544576112592438, 0.090085615641140648, 0.092688851631032826, 0.093350981773667727, 0.093533485647482831, 0.09200297673552045, 0.092430312068500123, 0.09196280707542849, 0.091743757318209676, 0.093410616670435515], [0.092585854903671175, 0.097711448394479386, 0.095147435492129021, 0.10227079478533976, 0.096160114652275169, 0.096010944926885833, 0.09465505964946902, 0.10209341061855295, 0.096080015347946371, 0.098292192944375537], [0.09877004922539076, 0.10209448731391499, 0.1036684218194316, 0.10177862664731295, 0.10133555167628529, 0.10008232181353179, 0.10525045195494541, 0.099577024184833732, 0.10084280661666958, 0.10100842787985158], [0.1046267589298471, 0.10581089579637566, 0.10103633522974161, 0.10344074058931306, 0.10656514454046792, 0.10032242872514702, 0.10412383681454039, 0.10365372503932704, 0.10044351491125603, 0.10549073053997544]], 'Rp': [[0.79291488570093926, 0.78335655222240053, 0.79046467654108188, 0.78020102493973242, 0.76209717586077075, 0.80916521044262102, 0.7812221648401747, 0.77553598362287346, 0.77939456870583312, 0.78930249892332593], [0.77719762999472541, 0.76187569860517235, 0.78325518995318144, 0.77983538708381772, 0.7855510634282804, 0.77917407051076781, 0.79457966722037843, 0.79821432686857774, 0.78432904987076391, 0.8015509112545175], [0.78705007575113228, 0.78631587108203604, 0.77999809652302399, 0.78434383489478932, 0.77613975923733647, 0.7736361111740907, 0.78232507144739205, 0.77442805631721001, 0.77951353888888242, 0.76521290955239751], [0.76514905730445293, 0.78195288652830164, 0.76674079238425363, 0.77591775887947068, 0.78266626116619697, 0.77609385189254654, 0.76484792203055996, 0.78409170909760828, 0.78357879052134605, 0.77624950792384184], [0.77520730822840522, 0.76530122816507973, 0.76535135480531957, 0.77334408830049206, 0.7687605947873104, 0.76715335809383189, 0.76940083315163132, 0.77038655084434349, 0.78651210252264891, 0.77553744631942623], [0.7692102657850618, 0.76779139081712988, 0.76579368071547815, 0.77255147915186606, 0.77142280277642483, 0.76421396821148324, 0.75877164127914665, 0.762648354670319, 0.77020309786323848, 0.76569517460174796], [0.75888734545770276, 0.76036438549534746, 0.76143549616372741, 0.74906580864325878, 0.7559075925506461, 0.75392986603014978, 0.76532344178543843, 0.759502014692362, 0.75848108160574168, 0.76098120645082268], [0.75110920417901006, 0.75572164214580206, 0.76252987802807226, 0.74868505573760813, 0.74982719876191573, 0.75539813343196804, 0.74698680395554884, 0.75170413345689335, 0.75622093254238176, 0.75459333949081542], [0.73975648997696997, 0.73337353084418222, 0.73930910666470029, 0.74930579152533938, 0.74200602253789183, 0.74037208496959184, 0.73411322812521462, 0.74530017694045858, 0.74594666818035849, 0.74690259734263764], [0.73835628015585353, 0.74280575952095729, 0.73286840095233097, 0.73414122936384163, 0.73190199483987806, 0.73476303173027013, 0.73446139996963478, 0.73579131252636654, 0.73732510506829474, 0.7312572833227986], [0.73293289277509455, 0.7188894947194987, 0.72666597215141115, 0.70662646459942291, 0.72163100172937, 0.72269477688479977, 0.72737544269760956, 0.70652090611803431, 0.72181654692895891, 0.71617715384217262], [0.71480101040678057, 0.70369907361041051, 0.6990921115246902, 0.7059561080286364, 0.70470689754936022, 0.70967121155712976, 0.69710981711398878, 0.71083056490102769, 0.70720313551788994, 0.70754051962179021], [0.69266574127541769, 0.68926791342408678, 0.70444326781612765, 0.69821720183379798, 0.69233077328691539, 0.70731374689607229, 0.69740294983381124, 0.69988506283964924, 0.70629991856314411, 0.69233176072952962]]} 
average_performances = {'R^2': [0.6127573028083656, 0.6142443058674589, 0.6053232448314569, 0.6002082191608189, 0.5936275153251925, 0.5860182619011416, 0.5726282197495951, 0.5649273868907404, 0.5465282816796022, 0.5370340604454495, 0.5131097087108017, 0.4913832842419075, 0.4806292936820151], 'MSE': [0.076783181088596289, 0.077007645104162817, 0.078853510239311683, 0.079517864539483868, 0.081066788083716174, 0.082557073954485485, 0.085173084191799364, 0.086892808157188278, 0.090516024234796807, 0.092275398067401065, 0.097100727171512427, 0.10144081691321678, 0.10355141111159913], 'Rp': [0.78436547417997526, 0.78455629947901828, 0.77889633248682921, 0.77572885377285794, 0.77169548652184905, 0.76683018558718963, 0.75838782388751969, 0.75327763217300159, 0.7416385697107345, 0.73536717974502264, 0.72013306524463716, 0.70606104498317035, 0.6980158336498552]}


'''